(function(A,l){function w(f,d){for(var c,a=[],b=0;b<f.length;++b){if(!(c=u[f[b]]))a:{c=A;for(var h=f[b].split(/[.\/]/),e=0;e<h.length;++e){if(!c[h[e]]){c=void 0;break a}c=c[h[e]]}}if(!c)throw"module definition dependecy not found: "+f[b];a.push(c)}d.apply(null,a)}function n(f,d,c){if("string"!==typeof f)throw"invalid module definition, module id must be defined and be a string";if(void 0===d)throw"invalid module definition, dependencies must be specified";if(void 0===c)throw"invalid module definition, definition function must be specified";
    w(d,function(){u[f]=c.apply(null,arguments)})}var u={};n("moxie/core/utils/Basic",[],function(){var f=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},d=function(b){c(arguments,function(h,e){0<e&&c(h,function(e,c){void 0!==e&&(f(b[c])===f(e)&&~a(f(e),["array","object"])?d(b[c],e):b[c]=e)})});return b},c=function(a,c){var e,d;if(a){try{e=a.length}catch(k){e=void 0}if(void 0===e)for(d in a){if(a.hasOwnProperty(d)&&
    !1===c(a[d],d))break}else for(d=0;d<e&&!1!==c(a[d],d);d++);}},a=function(a,c){if(c){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(c,a);for(var e=0,d=c.length;e<d;e++)if(c[e]===a)return e}return-1};return{guid:function(){var a=0;return function(c){var e=(new Date).getTime().toString(32),d;for(d=0;5>d;d++)e+=Math.floor(65535*Math.random()).toString(32);return(c||"o_")+e+(a++).toString(32)}}(),typeOf:f,extend:d,each:c,isEmptyObj:function(a){var c;if(!a||"object"!==f(a))return!0;for(c in a)return!1;
    return!0},inSeries:function(a,c){function e(k){if("function"===f(a[k]))a[k](function(a){++k<d&&!a?e(k):c(a)})}var d=a.length;"function"!==f(c)&&(c=function(){});a&&a.length||c();e(0)},inParallel:function(a,d){var e=0,g=a.length,k=Array(g);c(a,function(a,b){a(function(a){if(a)return d(a);var c=[].slice.call(arguments);c.shift();k[b]=c;e++;e===g&&(k.unshift(null),d.apply(this,k))})})},inArray:a,arrayDiff:function(b,c){var e=[];"array"!==f(b)&&(b=[b]);"array"!==f(c)&&(c=[c]);for(var d in b)-1===a(b[d],
    c)&&e.push(b[d]);return e.length?e:!1},arrayIntersect:function(b,d){var e=[];c(b,function(b){-1!==a(b,d)&&e.push(b)});return e.length?e:null},toArray:function(a){var c,e=[];for(c=0;c<a.length;c++)e[c]=a[c];return e},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!==typeof a)return a;var c={t:1099511627776,g:1073741824,m:1048576,k:1024},e;a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,
    ""));e=a[2];a=+a[1];c.hasOwnProperty(e)&&(a*=c[e]);return a}}});n("moxie/core/I18n",["moxie/core/utils/Basic"],function(f){var d={};return{addI18n:function(c){return f.extend(d,c)},translate:function(c){return d[c]||c},_:function(c){return this.translate(c)},sprintf:function(c){var a=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){var b=a.shift();return"undefined"!==f.typeOf(b)?b:""})}}});n("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(f,d){var c={mimes:{},
    extensions:{},addMimeType:function(a){a=a.split(/,/);var b,c,e;for(b=0;b<a.length;b+=2){e=a[b+1].split(/ /);for(c=0;c<e.length;c++)this.mimes[e[c]]=a[b];this.extensions[a[b]]=e}},extList2mimes:function(a,b){var c,e,d,k,r=[];for(e=0;e<a.length;e++)for(c=a[e].extensions.split(/\s*,\s*/),d=0;d<c.length;d++){if("*"===c[d])return[];if(k=this.mimes[c[d]])-1===f.inArray(k,r)&&r.push(k);else if(b&&/^\w+$/.test(c[d]))r.push("."+c[d]);else return[]}return r},mimes2exts:function(a){var b=this,c=[];f.each(a,
        function(a){if("*"===a)return c=[],!1;var d=a.match(/^(\w+)\/(\*|\w+)$/);d&&("*"===d[2]?f.each(b.extensions,function(a,e){(new RegExp("^"+d[1]+"/")).test(e)&&[].push.apply(c,b.extensions[e])}):b.extensions[a]&&[].push.apply(c,b.extensions[a]))});return c},mimes2extList:function(a){var b=[],c=[];"string"===f.typeOf(a)&&(a=f.trim(a).split(/\s*,\s*/));c=this.mimes2exts(a);b.push({title:d.translate("Files"),extensions:c.length?c.join(","):"*"});b.mimes=a;return b},getFileExtension:function(a){return(a=
        a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};c.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
    return c});n("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(f){var d=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},c=function(){for(var b,c=0,e,d,k,h,g,p=arguments;c<p.length;c+=2){g=p[c];var f=p[c+1];if("undefined"===typeof b)for(k in b={},f)e=f[k],"object"===typeof e?b[e[0]]=a:b[e]=a;for(e=d=0;e<g.length;e++)if(h=g[e].exec(this.getUA())){for(k=0;k<f.length;k++)g=h[++d],e=f[k],"object"===typeof e&&
    0<e.length?2==e.length?b[e[0]]="function"==typeof e[1]?e[1].call(this,g):e[1]:3==e.length?b[e[0]]="function"!==typeof e[1]||e[1].exec&&e[1].test?g?g.replace(e[1],e[2]):a:g?e[1].call(this,g,e[2]):a:4==e.length&&(b[e[0]]=g?e[3].call(this,g.replace(e[1],e[2])):a):b[e]=g?g:a;break}if(h)break}return b},e=function(c,e){for(var d in e)if("object"===typeof e[d]&&0<e[d].length)for(var k=0;k<e[d].length;k++){if(b.has(e[d][k],c))return"?"===d?a:d}else if(b.has(e[d],c))return"?"===d?a:d;return c},d={ME:"4.90",
    "NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},k=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,
    /(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version",
    "major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
    ["name",["major",e,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",e,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,
        /(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],f=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],
    ["version","name"]],p=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",e,d]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",e,d]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name",
    "Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
    ["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,
    k)};this.getEngine=function(){return c.apply(this,f)};this.getOS=function(){return c.apply(this,p)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){b=a;return this};this.setUA(b)}).getResult()}(),c={can:function(){var a={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==
    f.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;c.open("get","/");if("responseType"in c)return c.responseType=a,c.responseType!==a?!1:!0}}catch(e){}return!1},use_data_uri:function(){var b=new Image;b.onload=function(){a.use_data_uri=1===b.width&&1===b.height};setTimeout(function(){b.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return!1}(),use_data_uri_over32kb:function(){return a.use_data_uri&&("IE"!==
    c.browser||9<=c.version)},use_data_uri_of:function(b){return a.use_data_uri&&33E3>b||a.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");a.setAttribute("type","file");return!a.disabled}};return function(b){var c=[].slice.call(arguments);c.shift();return"function"===f.typeOf(a[b])?a[b].apply(this,c):!!a[b]}}(),browser:d.browser.name,version:parseFloat(d.browser.major),os:d.os.name,osVersion:d.os.version,verComp:function(a,b,c){var e=0,d=0,k=0,f={dev:-6,alpha:-5,
    a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},e=function(a){a=(""+a).replace(/[_\-+]/g,".");a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return a.length?a.split("."):[-8]},p=function(a){return a?isNaN(a)?f[a]||-7:parseInt(a,10):0};a=e(a);b=e(b);d=Math.max(a.length,b.length);for(e=0;e<d;e++)if(a[e]!=b[e])if(a[e]=p(a[e]),b[e]=p(b[e]),a[e]<b[e]){k=-1;break}else if(a[e]>b[e]){k=1;break}if(!c)return k;switch(c){case ">":case "gt":return 0<k;case ">=":case "ge":return 0<=k;case "<=":case "le":return 0>=
    k;case "==":case "=":case "eq":return 0===k;case "<>":case "!=":case "ne":return 0!==k;case "":case "<":case "lt":return 0>k;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};c.OS=c.os;return c});n("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(f){var d=function(c,a){return c.className?(new RegExp("(^|\\s+)"+a+"(\\s+|$)")).test(c.className):!1};return{get:function(c){return"string"!==
    typeof c?c:document.getElementById(c)},hasClass:d,addClass:function(c,a){d(c,a)||(c.className=c.className?c.className.replace(/\s+$/,"")+" "+a:a)},removeClass:function(c,a){c.className&&(c.className=c.className.replace(new RegExp("(^|\\s+)"+a+"(\\s+|$)"),function(a,c,e){return" "===c&&" "===e?" ":""}))},getStyle:function(c,a){if(c.currentStyle)return c.currentStyle[a];if(window.getComputedStyle)return window.getComputedStyle(c,null)[a]},getPos:function(c,a){function b(a){var b,c=0;b=0;a&&(b=a.getBoundingClientRect(),
    a="CSS1Compat"===k.compatMode?k.documentElement:k.body,c=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:c,y:b}}var d=0,e=0,g,k=document;a=a||k.body;if(c&&c.getBoundingClientRect&&"IE"===f.browser&&(!k.documentMode||8>k.documentMode))return d=b(c),e=b(a),{x:d.x-e.x,y:d.y-e.y};for(g=c;g&&g!=a&&g.nodeType;)d+=g.offsetLeft||0,e+=g.offsetTop||0,g=g.offsetParent;for(g=c.parentNode;g&&g!=a&&g.nodeType;)d-=g.scrollLeft||0,e-=g.scrollTop||0,g=g.parentNode;return{x:d,y:e}},getSize:function(c){return{w:c.offsetWidth||
    c.clientWidth,h:c.offsetHeight||c.clientHeight}}}});n("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(f){function d(c,a){for(var b in c)if(c[b]===a)return b;return null}return{RuntimeError:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": RuntimeError "+this.code}var a={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};f.extend(c,a);c.prototype=Error.prototype;return c}(),OperationNotAllowedException:function(){function c(a){this.code=a;this.name="OperationNotAllowedException"}
    f.extend(c,{NOT_ALLOWED_ERR:1});c.prototype=Error.prototype;return c}(),ImageError:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": ImageError "+this.code}var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};f.extend(c,a);c.prototype=Error.prototype;return c}(),FileException:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": FileException "+this.code}var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,
    INVALID_STATE_ERR:7,SYNTAX_ERR:8};f.extend(c,a);c.prototype=Error.prototype;return c}(),DOMException:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": DOMException "+this.code}var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,
    INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};f.extend(c,a);c.prototype=Error.prototype;return c}(),EventException:function(){function c(a){this.code=a;this.name="EventException"}f.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0});c.prototype=Error.prototype;return c}()}});n("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],
    function(f,d){function c(){var a={};d.extend(this,{uid:null,init:function(){this.uid||(this.uid=d.guid("uid_"))},addEventListener:function(b,c,e,g){var k=this,f;b=d.trim(b);/\s/.test(b)?d.each(b.split(/\s+/),function(a){k.addEventListener(a,c,e,g)}):(b=b.toLowerCase(),e=parseInt(e,10)||0,f=a[this.uid]&&a[this.uid][b]||[],f.push({fn:c,priority:e,scope:g||this}),a[this.uid]||(a[this.uid]={}),a[this.uid][b]=f)},hasEventListener:function(b){return b?!(!a[this.uid]||!a[this.uid][b]):!!a[this.uid]},removeEventListener:function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   c){b=b.toLowerCase();var e=a[this.uid]&&a[this.uid][b],g;if(e){if(c)for(g=e.length-1;0<=g;g--){if(e[g].fn===c){e.splice(g,1);break}}else e=[];e.length||(delete a[this.uid][b],d.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var c,e,g,k={},r=!0;if("string"!==d.typeOf(b))if(e=b,"string"===d.typeOf(e.type))b=e.type,void 0!==e.total&&void 0!==e.loaded&&(k.total=e.total,k.loaded=e.loaded),k.async=e.async||!1;
    else throw new f.EventException(f.EventException.UNSPECIFIED_EVENT_TYPE_ERR);-1!==b.indexOf("::")?function(a){c=a[0];b=a[1]}(b.split("::")):c=this.uid;b=b.toLowerCase();if(e=a[c]&&a[c][b]){e.sort(function(a,b){return b.priority-a.priority});g=[].slice.call(arguments);g.shift();k.type=b;g.unshift(k);var p=[];d.each(e,function(a){g[0].target=a.scope;k.async?p.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,g))},1)}):p.push(function(b){b(!1===a.fn.apply(a.scope,g))})});p.length&&d.inSeries(p,
        function(a){r=!a})}return r},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var c;"array"!==d.typeOf(a)&&(a=[a]);for(var e=0;e<a.length;e++)c="on"+a[e],"function"===d.typeOf(this[c])?this.addEventListener(a[e],this[c]):"undefined"===d.typeOf(this[c])&&
        (this[c]=null)}})}c.instance=new c;return c});n("moxie/core/utils/Encode",[],function(){var f=function(c){return unescape(encodeURIComponent(c))},d=function(c){return decodeURIComponent(escape(c))};return{utf8_encode:f,utf8_decode:d,atob:function(c,a){if("function"===typeof window.atob)return a?d(window.atob(c)):window.atob(c);var b,h,e,g,k,f=0,p=0;g="";var q=[];if(!c)return c;c+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(f++)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(f++)),
    g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(f++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(f++)),e=b<<18|h<<12|g<<6|k,b=e>>16&255,h=e>>8&255,e&=255,64==g?q[p++]=String.fromCharCode(b):64==k?q[p++]=String.fromCharCode(b,h):q[p++]=String.fromCharCode(b,h,e);while(f<c.length);g=q.join("");return a?d(g):g},btoa:function(c,a){a&&f(c);if("function"===typeof window.btoa)return window.btoa(c);var b,d,e,g,k=0,r=0,p="",
    p=[];if(!c)return c;do b=c.charCodeAt(k++),d=c.charCodeAt(k++),e=c.charCodeAt(k++),g=b<<16|d<<8|e,b=g>>18&63,d=g>>12&63,e=g>>6&63,g&=63,p[r++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);while(k<c.length);p=p.join("");k=c.length%3;return(k?
    p.slice(0,k-3):p)+"===".slice(k||3)}}});n("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(f,d,c){function a(b,c,k,r,p){var q=this,y,m=f.guid(c+"_");p=p||"browser";b=b||{};h[m]=this;k=f.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,
    select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},k);b.preferred_caps&&(p=a.getMode(r,b.preferred_caps,p));y=function(){var a={};return{exec:function(b,c,e,d){if(y[c]&&(a[b]||(a[b]={context:this,instance:new y[c]}),a[b].instance[e]))return a[b].instance[e].apply(this,d)},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var b=this;f.each(a,
    function(a,c){"function"===f.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(c)})}}}();f.extend(this,{initialized:!1,uid:m,type:c,mode:a.getMode(r,b.required_caps,p),shimid:m+"_container",clients:0,options:b,can:function(b,c,e){e=e||k;"string"===f.typeOf(b)&&"undefined"===f.typeOf(c)&&(b=a.parseCaps(b));if("object"===f.typeOf(b)){for(var d in b)if(!this.can(d,b[d],e))return!1;return!0}return"function"===f.typeOf(e[b])?e[b].call(this,c):c===e[b]},getShimContainer:function(){var a,
    b=d.get(this.shimid);b||(a=this.options.container?d.get(this.options.container):document.body,b=document.createElement("div"),b.id=this.shimid,b.className="moxie-shim moxie-shim-"+this.type,f.extend(b.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(b));return b},getShim:function(){return y},shimExec:function(a,b){var c=[].slice.call(arguments,2);return q.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,
    2);return q[a]&&q[a][b]?q[a][b].apply(this,c):q.shimExec.apply(this,arguments)},destroy:function(){if(q){var a=d.get(this.shimid);a&&a.parentNode.removeChild(a);y&&y.removeAllInstances();this.unbindAll();delete h[this.uid];m=q=y=this.uid=null}}});this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var b={},h={};a.order="html5,flash,silverlight,html4";a.getRuntime=function(a){return h[a]?h[a]:!1};a.addConstructor=function(a,d){d.prototype=c.instance;b[a]=d};a.getConstructor=function(a){return b[a]||
    null};a.getInfo=function(b){var c=a.getRuntime(b);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null};a.parseCaps=function(a){var b={};if("string"!==f.typeOf(a))return a||{};f.each(a.split(","),function(a){b[a]=!0});return b};a.can=function(b,c){var d;d=a.getConstructor(b);var h;return d?(d=new d({required_caps:c}),h=d.mode,d.destroy(),!!h):!1};a.thatCan=function(b,c){var d=(c||a.order).split(/\s*,\s*/),h;for(h in d)if(a.can(d[h],b))return d[h];return null};
    a.getMode=function(a,b,c){var d=null;"undefined"===f.typeOf(c)&&(c="browser");if(b&&!f.isEmptyObj(a)){f.each(b,function(b,c){if(a.hasOwnProperty(c)){var k=a[c](b);"string"===typeof k&&(k=[k]);if(!d)d=k;else if(!(d=f.arrayIntersect(d,k)))return d=!1}});if(d)return-1!==f.inArray(c,d)?c:d[0];if(!1===d)return!1}return c};a.capTrue=function(){return!0};a.capFalse=function(){return!1};a.capTest=function(a){return function(){return!!a}};return a});n("moxie/runtime/RuntimeClient",["moxie/core/Exceptions",
    "moxie/core/utils/Basic","moxie/runtime/Runtime"],function(f,d,c){return function(){var a;d.extend(this,{connectRuntime:function(b){function h(d){var g;d.length?(g=d.shift(),(g=c.getConstructor(g))?(a=new g(b),a.bind("Init",function(){a.initialized=!0;setTimeout(function(){a.clients++;e.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy();h(d)}),a.mode?a.init():a.trigger("Error")):h(d)):(e.trigger("RuntimeError",new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR)),a=null)}var e=this,g;
    "string"===d.typeOf(b)?g=b:"string"===d.typeOf(b.ruid)&&(g=b.ruid);if(g){if(a=c.getRuntime(g))return a.clients++,a;throw new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR);}h((b.runtime_order||c.order).split(/\s*,\s*/))},getRuntime:function(){return a&&a.uid?a:a=null},disconnectRuntime:function(){a&&0>=--a.clients&&(a.destroy(),a=null)}})}});n("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(f,d,c){function a(h,e){function g(c,e,d){var g=b[this.uid];
    if("string"!==f.typeOf(g)||!g.length)return null;e=new a(null,{type:d,size:e-c});e.detach(g.substr(c,e.size));return e}c.call(this);h&&this.connectRuntime(h);e?"string"===f.typeOf(e)&&(e={data:e}):e={};f.extend(this,{uid:e.uid||f.guid("uid_"),ruid:h,size:e.size||0,type:e.type||"",slice:function(a,b,c){return this.isDetached()?g.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return b[this.uid]?b[this.uid]:null},detach:function(a){this.ruid&&
(this.getRuntime().exec.call(this,"Blob","destroy",b[this.uid]),this.disconnectRuntime(),this.ruid=null);a=a||"";var c=a.match(/^data:([^;]*);base64,/);c&&(this.type=c[1],a=d.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;b[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===f.typeOf(b[this.uid])},destroy:function(){this.detach();delete b[this.uid]}});e.data?this.detach(e.data):b[this.uid]=e}var b={};return a});n("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime",
    "moxie/file/Blob"],function(f,d,c){function a(a,h){var e,g;h||(h={});g=h.type&&""!==h.type?h.type:d.getFileMime(h.name);h.name?(e=h.name.replace(/\\/g,"/"),e=e.substr(e.lastIndexOf("/")+1)):(e=g.split("/")[0],e=f.guid((""!==e?e:"file")+"_"),d.extensions[g]&&(e+="."+d.extensions[g][0]));c.apply(this,arguments);f.extend(this,{type:g||"",name:e||f.guid("file_"),lastModifiedDate:h.lastModifiedDate||(new Date).toLocaleString()})}a.prototype=c.prototype;return a});n("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),
    function(f,d,c,a,b,h,e,g,k){function r(b){var r=this,m;-1!==f.inArray(f.typeOf(b),["string","node"])&&(b={browse_button:b});m=c.get(b.browse_button);if(!m)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);m={accept:[{title:h.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:m.parentNode||document.body};b=f.extend({},m,b);"string"===typeof b.required_caps&&(b.required_caps=g.parseCaps(b.required_caps));"string"===typeof b.accept&&(b.accept=d.mimes2extList(b.accept));
        m=c.get(b.container);m||(m=document.body);"static"===c.getStyle(m,"position")&&(m.style.position="relative");m=m=null;k.call(r);f.extend(r,{uid:f.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){r.convertEventPropsToHandlers(p);r.bind("RuntimeInit",function(a,d){r.ruid=d.uid;r.shimid=d.shimid;r.bind("Ready",function(){r.trigger("Refresh")},999);r.bind("Change",function(){var a=d.exec.call(r,"FileInput","getFiles");r.files=[];f.each(a,function(a){if(0===a.size)return!0;r.files.push(new e(r.ruid,
            a))})},999);r.bind("Refresh",function(){var a,e,k;e=c.get(b.browse_button);k=c.get(d.shimid);e&&(a=c.getPos(e,c.get(b.container)),e=c.getSize(e),k&&f.extend(k.style,{top:a.y+"px",left:a.x+"px",width:e.w+"px",height:e.h+"px"}))});d.exec.call(r,"FileInput","init",b)});r.connectRuntime(f.extend({},b,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===f.typeOf(a)?!0:a)},refresh:function(){r.trigger("Refresh")},destroy:function(){var a=
            this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===f.typeOf(this.files)&&f.each(this.files,function(a){a.destroy()});this.files=null}})}var p="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");r.prototype=b.instance;return r});n("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),
    function(f,d,c,a,b,h,e,g){function k(c){var e=this,k;"string"===typeof c&&(c={drop_zone:c});k={accept:[{title:f.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};c="object"===typeof c?a.extend({},k,c):k;c.container=d.get(c.drop_zone)||document.body;"static"===d.getStyle(c.container,"position")&&(c.container.style.position="relative");"string"===typeof c.accept&&(c.accept=g.mimes2extList(c.accept));h.call(e);a.extend(e,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){e.convertEventPropsToHandlers(r);
        e.bind("RuntimeInit",function(d,k){e.ruid=k.uid;e.bind("Drop",function(){var c=k.exec.call(e,"FileDrop","getFiles");e.files=[];a.each(c,function(a){e.files.push(new b(e.ruid,a))})},999);k.exec.call(e,"FileDrop","init",c);e.dispatchEvent("ready")});e.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var r=["ready","dragenter","dragleave","drop","error"];k.prototype=e.instance;return k});n("moxie/runtime/RuntimeTarget",
    ["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,d,c){function a(){this.uid=f.guid("uid_");d.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}a.prototype=c.instance;return a});n("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(f,d,c,a,b,h,e){function g(){function a(f,r){function K(a){h.readyState=
    g.DONE;h.error=a;h.trigger("error");t()}function t(){q.destroy();q=null;h.trigger("loadend")}function v(a){q.bind("Error",function(a,b){K(b)});q.bind("Progress",function(b){h.result=a.exec.call(q,"FileReader","getResult");h.trigger(b)});q.bind("Load",function(b){h.readyState=g.DONE;h.result=a.exec.call(q,"FileReader","getResult");h.trigger(b);t()});a.exec.call(q,"FileReader","read",f,r)}q=new e;this.convertEventPropsToHandlers(k);if(this.readyState===g.LOADING)return K(new c.DOMException(c.DOMException.INVALID_STATE_ERR));
    this.readyState=g.LOADING;this.trigger("loadstart");if(r instanceof b)if(r.isDetached()){var x=r.getSource();switch(f){case "readAsText":case "readAsBinaryString":this.result=x;break;case "readAsDataURL":this.result="data:"+r.type+";base64,"+d.btoa(x)}this.readyState=g.DONE;this.trigger("load");t()}else v(q.connectRuntime(r.ruid));else K(new c.DOMException(c.DOMException.NOT_FOUND_ERR))}var h=this,q;f.extend(this,{uid:f.guid("uid_"),readyState:g.EMPTY,result:null,error:null,readAsBinaryString:function(b){a.call(this,
    "readAsBinaryString",b)},readAsDataURL:function(b){a.call(this,"readAsDataURL",b)},readAsText:function(b){a.call(this,"readAsText",b)},abort:function(){this.result=null;-1===f.inArray(this.readyState,[g.EMPTY,g.DONE])&&(this.readyState===g.LOADING&&(this.readyState=g.DONE),q&&q.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();q&&(q.getRuntime().exec.call(this,"FileReader","destroy"),q.disconnectRuntime());h=q=null}})}
    var k="loadstart progress load abort error loadend".split(" ");g.EMPTY=0;g.LOADING=1;g.DONE=2;g.prototype=a.instance;return g});n("moxie/core/utils/Url",[],function(){var f=function(d,c){for(var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),b=a.length,h={http:80,https:443},e={},g=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(d||
    "");b--;)g[b]&&(e[a[b]]=g[b]);e.scheme||(c&&"string"!==typeof c||(c=f(c||document.location.href)),e.scheme=c.scheme,e.host=c.host,e.port=c.port,a="",/^[^\/]/.test(e.path)&&(a=c.path,a=/(\/|\/[^\.]+)$/.test(a)?a+"/":a.replace(/\/[^\/]+$/,"/")),e.path=a+(e.path||""));e.port||(e.port=h[e.scheme]||80);e.port=parseInt(e.port,10);e.path||(e.path="/");delete e.source;return e};return{parseUrl:f,resolveUrl:function(d){d=f(d);return d.scheme+"://"+d.host+(d.port!=={http:80,https:443}[d.scheme]?":"+d.port:
    "")+d.path+(d.query?d.query:"")},hasSameOrigin:function(d){function c(a){return[a.scheme,a.host,a.port].join("/")}"string"===typeof d&&(d=f(d));return c(f())===c(d)}}});n("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(f,d,c){return function(){function a(a,d){if(d.isDetached()){var e=d.getSource();switch(a){case "readAsBinaryString":return e;case "readAsDataURL":return"data:"+d.type+";base64,"+c.btoa(e);case "readAsText":for(var g=
    "",k=0,f=e.length;k<f;k++)g+=String.fromCharCode(e[k]);return g}}else return e=this.connectRuntime(d.ruid).exec.call(this,"FileReaderSync","read",a,d),this.disconnectRuntime(),e}d.call(this);f.extend(this,{uid:f.guid("uid_"),readAsBinaryString:function(b){return a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){return a.call(this,"readAsDataURL",b)},readAsText:function(b){return a.call(this,"readAsText",b)}})}});n("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic",
    "moxie/file/Blob"],function(f,d,c){return function(){var a,b=[];d.extend(this,{append:function(h,e){var g=this,k=d.typeOf(e);e instanceof c?a={name:h,value:e}:"array"===k?(h+="[]",d.each(e,function(a){g.append(h,a)})):"object"===k?d.each(e,function(a,b){g.append(h+"["+b+"]",a)}):"null"===k||"undefined"===k||"number"===k&&isNaN(e)?g.append(h,"false"):b.push({name:h,value:e.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&
    a.name||null},each:function(c){d.each(b,function(a){c(a.value,a.name)});a&&c(a.value,a.name)},destroy:function(){a=null;b=[]}})}});n("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),function(f,d,c,a,b,h,e,g,k,r,p,q){function y(){this.uid=f.guid("uid_")}
    function m(){function c(a,b){if(C.hasOwnProperty(a)){if(1===arguments.length)return p.can("define_property")?C[a]:l[a];p.can("define_property")?C[a]=b:l[a]=b}}function k(a){function b(){F.destroy();F=null;g.dispatchEvent("loadend");g=null}function d(e){F.bind("LoadStart",function(a){c("readyState",m.LOADING);g.dispatchEvent("readystatechange");g.dispatchEvent(a);L&&g.upload.dispatchEvent(a)});F.bind("Progress",function(a){c("readyState")!==m.LOADING&&(c("readyState",m.LOADING),g.dispatchEvent("readystatechange"));
        g.dispatchEvent(a)});F.bind("UploadProgress",function(a){L&&g.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});F.bind("Load",function(a){c("readyState",m.DONE);c("status",Number(e.exec.call(F,"XMLHttpRequest","getStatus")||0));c("statusText",K[c("status")]||"");c("response",e.exec.call(F,"XMLHttpRequest","getResponse",c("responseType")));~f.inArray(c("responseType"),["text",""])?c("responseText",c("response")):"document"===c("responseType")&&c("responseXML",
        c("response"));P=e.exec.call(F,"XMLHttpRequest","getAllResponseHeaders");g.dispatchEvent("readystatechange");0<c("status")?(L&&g.upload.dispatchEvent(a),g.dispatchEvent(a)):(Q=!0,g.dispatchEvent("error"));b()});F.bind("Abort",function(a){g.dispatchEvent(a);b()});F.bind("Error",function(a){Q=!0;c("readyState",m.DONE);g.dispatchEvent("readystatechange");R=!0;g.dispatchEvent(a);b()});e.exec.call(F,"XMLHttpRequest","send",{url:z,method:D,async:n,user:J,password:u,headers:I,mimeType:E,encoding:w,responseType:g.responseType,
        withCredentials:g.withCredentials,options:G},a)}var g=this;(new Date).getTime();F=new e;"string"===typeof G.required_caps&&(G.required_caps=h.parseCaps(G.required_caps));G.required_caps=f.extend({},G.required_caps,{return_response_type:g.responseType});a instanceof r&&(G.required_caps.send_multipart=!0);S||(G.required_caps.do_cors=!0);G.ruid?d(F.connectRuntime(G)):(F.bind("RuntimeInit",function(a,b){d(b)}),F.bind("RuntimeError",function(a,b){g.dispatchEvent("RuntimeError",b)}),F.connectRuntime(G))}
        var l=this,C={timeout:0,readyState:m.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},n=!0,z,D,I={},J,u,w=null,E=null,A=!1,B=!1,L=!1,R=!1,Q=!1,S=!1,G={},F,P="",O;f.extend(this,C,{uid:f.guid("uid_"),upload:new y,open:function(e,k,g,h,p){if(!e||!k)throw new d.DOMException(d.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(e)||a.utf8_encode(e)!==e)throw new d.DOMException(d.DOMException.SYNTAX_ERR);~f.inArray(e.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&
        (D=e.toUpperCase());if(~f.inArray(D,["CONNECT","TRACE","TRACK"]))throw new d.DOMException(d.DOMException.SECURITY_ERR);k=a.utf8_encode(k);e=b.parseUrl(k);S=b.hasSameOrigin(e);z=b.resolveUrl(k);if((h||p)&&!S)throw new d.DOMException(d.DOMException.INVALID_ACCESS_ERR);J=h||e.user;u=p||e.pass;n=g||!0;if(!1===n&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new d.DOMException(d.DOMException.INVALID_ACCESS_ERR);A=!n;B=!1;I={};c("responseText","");c("responseXML",null);c("response",
            null);c("status",0);c("statusText","");c("readyState",m.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(b,e){if(c("readyState")!==m.OPENED||B)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(b)||a.utf8_encode(b)!==b)throw new d.DOMException(d.DOMException.SYNTAX_ERR);b=f.trim(b).toLowerCase();if(~f.inArray(b,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||
            /^(proxy\-|sec\-)/.test(b))return!1;I[b]=I[b]?I[b]+(", "+e):e;return!0},getAllResponseHeaders:function(){return P||""},getResponseHeader:function(a){a=a.toLowerCase();return Q||~f.inArray(a,["set-cookie","set-cookie2"])?null:P&&""!==P&&(O||(O={},f.each(P.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=f.trim(a[0]),O[a[0].toLowerCase()]={header:a[0],value:f.trim(a[1])})})),O.hasOwnProperty(a))?O[a].header+": "+O[a].value:null},overrideMimeType:function(a){var b;if(~f.inArray(c("readyState"),
            [m.LOADING,m.DONE]))throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);a=f.trim(a.toLowerCase());/;/.test(a)&&(b=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=b[1]);if(!q.mimes[a])throw new d.DOMException(d.DOMException.SYNTAX_ERR);},send:function(b,c){G="string"===f.typeOf(c)?{ruid:c}:c?c:{};this.convertEventPropsToHandlers(t);this.upload.convertEventPropsToHandlers(t);if(this.readyState!==m.OPENED||B)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(b instanceof g)G.ruid=b.ruid,
            E=b.type||"application/octet-stream";else if(b instanceof r){if(b.hasBlob()){var e=b.getBlob();G.ruid=e.ruid;E=e.type||"application/octet-stream"}}else"string"===typeof b&&(w="UTF-8",E="text/plain;charset=UTF-8",b=a.utf8_encode(b));this.withCredentials||(this.withCredentials=G.required_caps&&G.required_caps.send_browser_cookies&&!S);L=!A&&this.upload.hasEventListener();Q=!1;R=!b;A||(B=!0);k.call(this,b)},abort:function(){Q=!0;A=!1;if(~f.inArray(c("readyState"),[m.UNSENT,m.OPENED,m.DONE]))c("readyState",
            m.UNSENT);else{c("readyState",m.DONE);B=!1;if(F)F.getRuntime().exec.call(F,"XMLHttpRequest","abort",R);else throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);R=!0}},destroy:function(){F&&("function"===f.typeOf(F.destroy)&&F.destroy(),F=null);this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var K={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",
        206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",
        414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};y.prototype=c.instance;var t="loadstart progress abort error load timeout loadend".split(" ");
    m.UNSENT=0;m.OPENED=1;m.HEADERS_RECEIVED=2;m.LOADING=3;m.DONE=4;m.prototype=c.instance;return m});n("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,d,c,a){function b(){function a(c,d){var g=this;k=d;g.bind("TransportingProgress",function(a){q=a.loaded;q<p&&-1===f.inArray(g.state,[b.IDLE,b.DONE])&&e.call(g)},999);g.bind("TransportingComplete",function(){q=p;g.state=b.DONE;r=null;g.result=k.exec.call(g,
    "Transporter","getAsBlob",c||"")},999);g.state=b.BUSY;g.trigger("TransportingStarted");e.call(g)}function e(){var a;a=p-q;y>a&&(y=a);a=d.btoa(r.substr(q,y));k.exec.call(this,"Transporter","receive",a,p)}var g,k,r,p,q,y;c.call(this);f.extend(this,{uid:f.guid("uid_"),state:b.IDLE,result:null,transport:function(b,c,e){var d=this;e=f.extend({chunk_size:204798},e);if(g=e.chunk_size%3)e.chunk_size+=3-g;y=e.chunk_size;p=q=0;r=this.result=null;r=b;p=b.length;if("string"===f.typeOf(e)||e.ruid)a.call(d,c,this.connectRuntime(e));
else{var k=function(b,e){d.unbind("RuntimeInit",k);a.call(d,c,e)};this.bind("RuntimeInit",k);this.connectRuntime(e)}},abort:function(){this.state=b.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));p=q=0;r=this.result=null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();p=q=0;r=this.result=null}})}b.IDLE=0;b.BUSY=1;b.DONE=2;b.prototype=a.instance;return b});n("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
    function(f,d,c,a,b,h,e,g,k,r,p,q,y){function m(){function a(b){var e=f.typeOf(b);try{if(b instanceof m){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);r.apply(this,arguments)}else if(b instanceof p){if(!~f.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);x.apply(this,arguments)}else if(-1!==f.inArray(e,["blob","file"]))a.call(this,new q(null,b),arguments[1]);else if("string"===e)/^data:[^;]*;base64,/.test(b)?a.call(this,new p(null,
        {data:b}),arguments[1]):l.apply(this,arguments);else if("node"===e&&"img"===b.nodeName.toLowerCase())a.call(this,b.src,arguments[1]);else throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);}catch(d){this.trigger("error",d)}}function r(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===f.typeOf(b)?!0:b)}function x(a,b){function c(b){e.ruid=b.uid;b.exec.call(e,"Image","loadFromBlob",a)}var e=this;e.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
        function(a,b){c(b)}),b&&"string"===typeof b.required_caps&&(b.required_caps=h.parseCaps(b.required_caps)),this.connectRuntime(f.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function l(a,c){var e=this,d;d=new b;d.open("get",a);d.responseType="blob";d.onprogress=function(a){e.trigger(a)};d.onload=function(){x.call(e,d.response,!0)};d.onerror=function(a){e.trigger(a)};d.onloadend=function(){d.destroy()};d.bind("RuntimeError",function(a,b){e.trigger("RuntimeError",
        b)});d.send(null,c)}e.call(this);f.extend(this,{uid:f.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a=void 0,a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(K);a.apply(this,arguments)},downsize:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                b,e,d){try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(!a&&!b||"undefined"===f.typeOf(e))e=!1;a=a||this.width;b=b||this.height;d="undefined"===f.typeOf(d)?!0:!!d;this.getRuntime().exec.call(this,"Image","downsize",a,b,e,d)}catch(k){this.trigger("error",k)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!k.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
        return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);a||(a="image/jpeg");"image/jpeg"!==a||b||(b=90);return this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,
        b);return y.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,b){function e(){if(k.can("create_canvas")){var b=p.getAsCanvas();if(b){a.appendChild(b);b=null;p.destroy();h.trigger("embedded");return}}b=p.getAsDataURL(q,r);if(!b)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(k.can("use_data_uri_of",b.length))a.innerHTML='<img src="'+b+'" width="'+p.width+'" height="'+p.height+'" />',p.destroy(),h.trigger("embedded");else{var d=new g;d.bind("TransportingComplete",function(){L=h.connectRuntime(this.result.ruid);
        h.bind("Embedded",function(){f.extend(L.getShimContainer().style,{top:"0px",left:"0px",width:p.width+"px",height:p.height+"px"});L=null},999);L.exec.call(h,"ImageView","display",this.result.uid,K,x);p.destroy()});d.transport(y.atob(b.substring(b.indexOf("base64,")+7)),q,f.extend({},t,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a}))}}var h=this,p,q,r,v,t=b||{},K=this.width,x=this.height,L;try{if(!(a=d.get(a)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);
        if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);q=t.type||this.type||"image/jpeg";r=t.quality||90;v="undefined"!==f.typeOf(t.crop)?t.crop:!1;if(t.width)K=t.width,x=t.height||K;else{var l=d.getSize(a);l.w&&l.h&&(K=l.w,x=l.h)}p=new m;p.bind("Resize",function(){e.call(h)});p.bind("Load",function(){p.downsize(K,x,v,!1)});p.clone(this,!1);return p}catch(n){this.trigger("error",
        n)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var K=["progress","load","error","resize","embedded"];m.MAX_RESIZE_WIDTH=6500;m.MAX_RESIZE_HEIGHT=6500;m.prototype=r.instance;return m});n("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,d,c,a){var b={};c.addConstructor("html5",function(d,e,g){var k=this,r=c.capTest,p=c.capTrue;
    g=f.extend({access_binary:r(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!b.Image},display_media:r(a.can("create_canvas")||a.can("use_data_uri_over32kb")),do_cors:r(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:r(function(){var b=document.createElement("div");return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==a.browser||9<a.version)}()),filter_by_extension:r("Chrome"===a.browser&&
        28<=a.version||"IE"===a.browser&&10<=a.version),return_response_headers:p,return_response_type:function(b){return"json"===b&&window.JSON?!0:a.can("return_response_type",b)},return_status_code:p,report_upload_progress:r(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&a.can("create_canvas")},select_file:function(){return a.can("use_fileinput")&&window.File},select_folder:function(){return k.can("select_file")&&"Chrome"===a.browser&&21<=a.version},
        select_multiple:function(){return k.can("select_file")&&!("Safari"===a.browser&&"Windows"===a.os)&&!("iOS"===a.os&&a.verComp(a.osVersion,"7.0.4","<"))},send_binary_string:r(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:r(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||k.can("send_binary_string")},slice_blob:r(window.File&&(File.prototype.mozSlice||
            File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:r("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||"IE"===a.browser&&10<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:p},g);c.call(this,d,e||"html5",g);f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(k);a=k=null}}(this.destroy)});f.extend(this.getShim(),
        b)});return b});n("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(f,d){return f.Blob=function(){function c(a,b,c){var e;if(window.File.prototype.slice)try{return a.slice(),a.slice(b,c)}catch(d){return a.slice(b,c-b)}else return(e=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?e.call(a,b,c):null}this.slice=function(){return new d(this.getRuntime().uid,c.apply(this,arguments))}}});n("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(f){function d(){this.returnValue=
    !1}function c(){this.cancelBubble=!0}var a={},b="moxie_"+f.guid(),h=function(c,d,k){var h;d=d.toLowerCase();if(c[b]&&a[c[b]]&&a[c[b]][d]){h=a[c[b]][d];for(var p=h.length-1;0<=p;p--)if(h[p].orig===k||h[p].key===k)if(c.removeEventListener?c.removeEventListener(d,h[p].func,!1):c.detachEvent&&c.detachEvent("on"+d,h[p].func),h[p].orig=null,h[p].func=null,h.splice(p,1),void 0!==k)break;h.length||delete a[c[b]][d];if(f.isEmptyObj(a[c[b]])){delete a[c[b]];try{delete c[b]}catch(q){c[b]=void 0}}}};return{addEvent:function(e,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          g,k,h){var p;g=g.toLowerCase();e.addEventListener?(p=k,e.addEventListener(g,p,!1)):e.attachEvent&&(p=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=d;a.stopPropagation=c;k(a)},e.attachEvent("on"+g,p));e[b]||(e[b]=f.guid());a.hasOwnProperty(e[b])||(a[e[b]]={});e=a[e[b]];e.hasOwnProperty(g)||(e[g]=[]);e[g].push({func:p,orig:k,key:h})},removeEvent:h,removeAllEvents:function(c,d){c&&c[b]&&f.each(a[c[b]],function(a,b){h(c,b,d)})}}});n("moxie/runtime/html5/file/FileInput",
    "moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h){return f.FileInput=function(){var e=[],g;d.extend(this,{init:function(k){var f=this,p=f.getRuntime(),q,y,m;g=k;e=[];k=g.accept.mimes||b.extList2mimes(g.accept,p.can("filter_by_extension"));q=p.getShimContainer();q.innerHTML='<input id="'+p.uid+'" type="file" style="font-size:999px;opacity:0;"'+(g.multiple&&p.can("select_multiple")?
        "multiple":"")+(g.directory&&p.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />";k=c.get(p.uid);d.extend(k.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});y=c.get(g.browse_button);p.can("summon_file_dialog")&&("static"===c.getStyle(y,"position")&&(y.style.position="relative"),m=parseInt(c.getStyle(y,"z-index"),10)||1,y.style.zIndex=m,q.style.zIndex=m-1,a.addEvent(y,"click",function(a){var b=c.get(p.uid);b&&!b.disabled&&b.click();a.preventDefault()},
        f.uid));q=p.can("summon_file_dialog")?y:q;a.addEvent(q,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(q,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(q,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(c.get(g.container),"mouseup",function(){f.trigger("mouseup")},f.uid);k.onchange=function t(){e=[];g.directory?d.each(this.files,function(a){"."!==a.name&&e.push(a)}):e=[].slice.call(this.files);if("IE"!==h.browser)this.value="";else{var a=this.cloneNode(!0);
        this.parentNode.replaceChild(a,this);a.onchange=t}f.trigger("change")};f.trigger({type:"ready",async:!0});q=null},getFiles:function(){return e},disable:function(a){var b=this.getRuntime();if(b=c.get(b.uid))b.disabled=!!a},destroy:function(){var b=this.getRuntime(),d=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(g&&c.get(g.container),this.uid);a.removeAllEvents(g&&c.get(g.browse_button),this.uid);b&&(b.innerHTML="");d.removeInstance(this.uid);e=g=null}})}});n("moxie/runtime/html5/file/FileDrop",
    ["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(f,d,c,a,b){return f.FileDrop=function(){function h(a){for(var b=[],c=0;c<a.length;c++)[].push.apply(b,a[c].extensions.split(/\s*,\s*/));return-1===d.inArray("*",b)?b:[]}function e(a){a=b.getFileExtension(a.name);return!a||!y.length||-1!==d.inArray(a,y)}function g(a,b){var c=[];d.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?(a=a.getAsFile(),e(a)&&
        q.push(a)):c.push(b))});c.length?k(c,b):b()}function k(a,b){var c=[];d.each(a,function(a){c.push(function(b){f(a,b)})});d.inSeries(c,function(){b()})}function f(a,b){a.isFile?a.file(function(a){e(a)&&q.push(a);b()},function(){b()}):a.isDirectory?p(a,b):b()}function p(a,b){function c(a){d.readEntries(function(b){b.length?([].push.apply(e,b),c(a)):a()},a)}var e=[],d=a.createReader();c(function(){k(e,b)})}var q=[],y=[],m;d.extend(this,{init:function(b){var c=this;m=b;y=h(m.accept);b=m.container;a.addEvent(b,
        "dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},c.uid);a.addEvent(b,"drop",function(a){a.preventDefault();a.stopPropagation();q=[];a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?g(a.dataTransfer.items,function(){c.trigger("drop")}):(d.each(a.dataTransfer.files,function(a){e(a)&&q.push(a)}),c.trigger("drop"))},c.uid);a.addEvent(b,"dragenter",function(a){a.preventDefault();a.stopPropagation();c.trigger("dragenter")},c.uid);a.addEvent(b,
        "dragleave",function(a){a.preventDefault();a.stopPropagation();c.trigger("dragleave")},c.uid)},getFiles:function(){return q},destroy:function(){a.removeAllEvents(m&&c.get(m.container),this.uid);q=y=m=null}})}});n("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(f,d,c){return f.FileReader=function(){var a,b=!1;c.extend(this,{read:function(d,e){var g=this;a=new window.FileReader;a.addEventListener("progress",function(a){g.trigger(a)});
    a.addEventListener("load",function(a){g.trigger(a)});a.addEventListener("error",function(b){g.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===c.typeOf(a[d])?(b=!1,a[d](e.getSource())):"readAsBinaryString"===d&&(b=!0,a.readAsDataURL(e.getSource()))},getResult:function(){var c;a&&a.result?b?(c=a.result,c=d.atob(c.substring(c.indexOf("base64,")+7))):c=a.result:c=null;return c},abort:function(){a&&a.abort()},destroy:function(){a=null}})}});n("moxie/runtime/html5/xhr/XMLHttpRequest",
    "moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h,e,g,k){return f.XMLHttpRequest=function(){function f(a,b){var c=this,e,d;e=b.getBlob().getSource();d=new window.FileReader;d.onload=function(){b.append(b.getBlobName(),new h(null,{type:e.type,data:d.result}));y.send.call(c,a,b)};d.readAsBinaryString(e)}function p(){if(!window.XMLHttpRequest||
        "IE"===k.browser&&8>k.version){var a;a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(e){}a=void 0}return a}return new window.XMLHttpRequest}function q(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new g.RuntimeError(g.RuntimeError.NOT_SUPPORTED_ERR);m.setRequestHeader("Content-Type","multipart/form-data; boundary="+b);a.each(function(a,e){c=a instanceof h?c+("--"+b+
        '\r\nContent-Disposition: form-data; name="'+e+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n"):c+("--"+b+'\r\nContent-Disposition: form-data; name="'+e+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n")});return c+="--"+b+"--\r\n"}var y=this,m,l;d.extend(this,{send:function(b,c){var g=this,y="Mozilla"===k.browser&&4<=k.version&&7>k.version,n="Android Browser"===k.browser,H=!1;l=b.url.replace(/^.+?\/([\w\-\.]+)$/,
        "$1").toLowerCase();m=p();m.open(b.method,b.url,b.async,b.user,b.password);if(c instanceof h)c.isDetached()&&(H=!0),c=c.getSource();else if(c instanceof e){if(c.hasBlob())if(c.getBlob().isDetached())c=q.call(g,c),H=!0;else if((y||n)&&"blob"===d.typeOf(c.getBlob().getSource())&&window.FileReader){f.call(g,b,c);return}if(c instanceof e){var z=new window.FormData;c.each(function(a,b){a instanceof h?z.append(b,a.getSource()):z.append(b,a)});c=z}}m.upload?(b.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",
        function(a){g.trigger(a)}),m.addEventListener("error",function(a){g.trigger(a)}),m.addEventListener("progress",function(a){g.trigger(a)}),m.upload.addEventListener("progress",function(a){g.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 3:var c,e;try{a.hasSameOrigin(b.url)&&(c=m.getResponseHeader("Content-Length")||0),m.responseText&&(e=m.responseText.length)}catch(d){c=e=0}g.trigger({type:"progress",lengthComputable:!!c,
        total:parseInt(c,10),loaded:e});break;case 4:m.onreadystatechange=function(){},0===m.status?g.trigger("error"):g.trigger("load")}};d.isEmptyObj(b.headers)||d.each(b.headers,function(a,b){m.setRequestHeader(b,a)});""!==b.responseType&&"responseType"in m&&("json"!==b.responseType||k.can("return_response_type","json")?m.responseType=b.responseType:m.responseType="text");H?m.sendAsBinary?m.sendAsBinary(c):function(){for(var a=new Uint8Array(c.length),b=0;b<c.length;b++)a[b]=c.charCodeAt(b)&255;m.send(a.buffer)}():
        m.send(c);g.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var e=this.getRuntime();try{switch(a){case "blob":var d=new b(e.uid,m.response),g=m.getResponseHeader("Content-Disposition");if(g){var h=g.match(/filename=([\'\"'])([^\1]+)\1/);h&&(l=h[2])}d.name=l;d.type||(d.type=c.getFileMime(l));return d;case "json":return k.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):null;case "document":var p;
        var f=m.responseXML,q=m.responseText;"IE"===k.browser&&q&&f&&!f.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(m.getResponseHeader("Content-Type"))&&(f=new window.ActiveXObject("Microsoft.XMLDOM"),f.async=!1,f.validateOnParse=!1,f.loadXML(q));p=f&&("IE"===k.browser&&0!==f.parseError||!f.documentElement||"parsererror"===f.documentElement.tagName)?null:f;return p;default:return""!==m.responseText?m.responseText:null}}catch(r){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return""},
        abort:function(){m&&m.abort()},destroy:function(){y=l=null}})}});n("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function f(b,d){var e=c?0:-8*(d-1),g=0,k;for(k=0;k<d;k++)g|=a.charCodeAt(b+k)<<Math.abs(e+8*k);return g}function d(b,c,e){e=3===arguments.length?e:a.length-c-1;a=a.substr(0,c)+b+a.substr(e+c)}var c=!1,a;return{II:function(a){if(void 0===a)return c;c=a},init:function(b){c=!1;a=b},SEGMENT:function(b,c,e){switch(arguments.length){case 1:return a.substr(b,a.length-
    b-1);case 2:return a.substr(b,c);case 3:d(e,b,c);break;default:return a}},BYTE:function(a){return f(a,1)},SHORT:function(a){return f(a,2)},LONG:function(a,h){if(void 0===h)return f(a,4);var e="",g=c?0:-24,k;for(k=0;4>k;k++)e+=String.fromCharCode(h>>Math.abs(g+8*k)&255);d(e,a,4)},SLONG:function(a){a=f(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,c){var e="";for(c+=a;a<c;a++)e+=String.fromCharCode(f(a,1));return e}}}});n("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],
    function(f){return function c(a){var b=[],h,e,g,k=0;h=new f;h.init(a);if(65496===h.SHORT(0)){for(e=2;e<=a.length;)if(g=h.SHORT(e),65488<=g&&65495>=g)e+=2;else{if(65498===g||65497===g)break;k=h.SHORT(e+2)+2;65505<=g&&65519>=g&&b.push({hex:g,name:"APP"+(g&15),start:e,length:k,segment:h.SEGMENT(e,k)});e+=k}h.init(null);return{headers:b,restore:function(a){var c;h.init(a);e=65504==h.SHORT(2)?4+h.SHORT(4):2;c=0;for(a=b.length;c<a;c++)h.SEGMENT(e,0,b[c].segment),e+=b[c].length;a=h.SEGMENT();h.init(null);
        return a},strip:function(a){var b,e;e=new c(a);b=e.headers;e.purge();h.init(a);for(a=b.length;a--;)h.SEGMENT(b[a].start,b[a].length,"");a=h.SEGMENT();h.init(null);return a},get:function(a){for(var c=[],e=0,k=b.length;e<k;e++)b[e].name===a.toUpperCase()&&c.push(b[e].segment);return c},set:function(a,c){var e=[],k,g,f;"string"===typeof c?e.push(c):e=c;k=g=0;for(f=b.length;k<f&&!(b[k].name===a.toUpperCase()&&(b[k].segment=e[g],b[k].length=e[g].length,g++),g>=e.length);k++);},purge:function(){b=[];h.init(null);
        h=null}}}}});n("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,d){return function(){function c(b,c){var d=a.SHORT(b),f,h,m,l,t,v=[],x={};for(f=0;f<d;f++)if(t=b+12*f+2,m=c[a.SHORT(t)],void 0!==m){h=a.SHORT(t+=2);l=a.LONG(t+=2);t+=4;v=[];switch(h){case 1:case 7:4<l&&(t=a.LONG(t)+e.tiffHeader);for(h=0;h<l;h++)v[h]=a.BYTE(t+h);break;case 2:4<l&&(t=a.LONG(t)+e.tiffHeader);x[m]=a.STRING(t,l-1);continue;case 3:2<l&&(t=a.LONG(t)+e.tiffHeader);
    for(h=0;h<l;h++)v[h]=a.SHORT(t+2*h);break;case 4:1<l&&(t=a.LONG(t)+e.tiffHeader);for(h=0;h<l;h++)v[h]=a.LONG(t+4*h);break;case 5:t=a.LONG(t)+e.tiffHeader;for(h=0;h<l;h++)v[h]=a.LONG(t+4*h)/a.LONG(t+4*h+4);break;case 9:t=a.LONG(t)+e.tiffHeader;for(h=0;h<l;h++)v[h]=a.SLONG(t+4*h);break;case 10:t=a.LONG(t)+e.tiffHeader;for(h=0;h<l;h++)v[h]=a.SLONG(t+4*h)/a.SLONG(t+4*h+4);break;default:continue}l=1==l?v[0]:v;g.hasOwnProperty(m)&&"object"!=typeof l?x[m]=g[m][l]:x[m]=l}return x}var a,b,h,e={},g;a=new d;
    b={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",
        41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};g={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",
        14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",
        16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
        79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},
        Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(d){e={tiffHeader:10};if(void 0===d||!d.length)return!1;a.init(d);return 65505===a.SHORT(0)&&"EXIF\x00"===a.STRING(4,5).toUpperCase()?(d=e.tiffHeader,a.II(18761==a.SHORT(d)),42!==a.SHORT(d+=2)?d=!1:(e.IFD0=e.tiffHeader+a.LONG(d+
        2),h=c(e.IFD0,b.tiff),"ExifIFDPointer"in h&&(e.exifIFD=e.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(e.gpsIFD=e.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),d=!0),d):!1},TIFF:function(){return h},EXIF:function(){var a;a=c(e.exifIFD,b.exif);if(a.ExifVersion&&"array"===f.typeOf(a.ExifVersion)){for(var d=0,g="";d<a.ExifVersion.length;d++)g+=String.fromCharCode(a.ExifVersion[d]);a.ExifVersion=g}return a},GPS:function(){var a;a=c(e.gpsIFD,b.gps);a.GPSVersionID&&
        "array"===f.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(c,d){if("PixelXDimension"!==c&&"PixelYDimension"!==c)return!1;var g;g=c;var h,f,m,l=0;if("string"===typeof g)for(f in h=b.exif,h)if(h[f]===g){g=f;break}h=e.exifIFD;f=a.SHORT(h);for(var t=0;t<f;t++)if(m=h+12*t+2,a.SHORT(m)==g){l=m+8;break}l?(a.LONG(l,d),g=!0):g=!1;return g},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null);a=h=null;e={}}}}});n("moxie/runtime/html5/image/JPEG",
    ["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(f,d,c,a,b){return function(h){var e,g,k,r,p,q;e=h;g=new a;g.init(e);if(65496!==g.SHORT(0))throw new d.ImageError(d.ImageError.WRONG_FORMAT);k=new c(h);r=new b;q=!!r.init(k.get("app1")[0]);p=function(){for(var a=0,b;a<=e.length;){b=g.SHORT(a+=2);if(65472<=b&&65475>=b)return a+=5,{height:g.SHORT(a),width:g.SHORT(a+2)};b=g.SHORT(a+=
        2);a+=b-2}return null}.call(this);f.extend(this,{type:"image/jpeg",size:e.length,width:p&&p.width||0,height:p&&p.height||0,setExif:function(a,b){if(!q)return!1;"object"===f.typeOf(a)?f.each(a,function(a,b){r.setExif(b,a)}):r.setExif(a,b);k.set("app1",r.getBinary())},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):e=k.restore(e)},stripHeaders:function(a){return k.strip(a)},purge:function(){r&&k&&g&&(r.purge(),k.purge(),g.init(null),e=p=k=r=g=null)}});q&&(this.meta={tiff:r.TIFF(),
        exif:r.EXIF(),gps:r.GPS()})}});n("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,d,c){return function(a){function b(){e&&(e.init(null),h=g=e=null)}var h,e,g;h=a;e=new c;e.init(h);(function(){for(var a=0,b=0,c=[35152,20039,3338,6666],b=0;b<c.length;b++,a+=2)if(c[b]!=e.SHORT(a))throw new f.ImageError(f.ImageError.WRONG_FORMAT);})();g=function(){var a=8,b,c,d;b=e.LONG(a);c=e.STRING(a+=4,4);d=a+=4;e.LONG(a+b);return"IHDR"==
    c?{width:e.LONG(d),height:e.LONG(d+4)}:null}.call(this);d.extend(this,{type:"image/png",size:h.length,width:g.width,height:g.height,purge:function(){b.call(this)}});b.call(this)}});n("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(f,d,c,a){return function(b){var h=[c,a],e;e=function(){for(var a=0;a<h.length;a++)try{return new h[a](b)}catch(c){}throw new d.ImageError(d.ImageError.WRONG_FORMAT);
}();f.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}});f.extend(this,e);this.purge=function(){e.purge();e=null}}});n("moxie/runtime/html5/image/MegaPixel",[],function(){function f(d){var c=d.naturalWidth;if(1048576<c*d.naturalHeight){var a=document.createElement("canvas");a.width=a.height=1;a=a.getContext("2d");a.drawImage(d,-c+1,0);return 0===a.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:f,
    renderTo:function(d,c,a){var b=d.naturalWidth,h=d.naturalHeight,e=a.width,g=a.height,k=a.x||0;a=a.y||0;c=c.getContext("2d");f(d)&&(b/=2,h/=2);var r=document.createElement("canvas");r.width=r.height=1024;var p=r.getContext("2d"),q;q=h;var y=document.createElement("canvas");y.width=1;y.height=q;y=y.getContext("2d");y.drawImage(d,0,0);for(var y=y.getImageData(0,0,1,q).data,m=0,l=q,t=q;t>m;)0===y[4*(t-1)+3]?l=t:m=t,t=l+m>>1;q=t/q;q=0===q?1:q;for(y=0;y<h;){m=y+1024>h?h-y:1024;for(l=0;l<b;){t=l+1024>b?
        b-l:1024;p.clearRect(0,0,1024,1024);p.drawImage(d,-l,-y);var v=l*e/b+k<<0,x=Math.ceil(t*e/b),n=y*g/h/q+a<<0,C=Math.ceil(m*g/h/q);c.drawImage(r,0,0,t,m,v,n,x,C);l+=1024}y+=1024}}}});n("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h,e,g,k){return f.Image=
    function(){function f(){if(!n&&!v)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return n||v}function p(b){return a.atob(b.substring(b.indexOf("base64,")+7))}function q(b){var e=this;v=new Image;v.onerror=function(){l.call(this);e.trigger("error",new c.ImageError(c.ImageError.WRONG_FORMAT))};v.onload=function(){e.trigger("load")};v.src=/^data:[^;]*;base64,/.test(b)?b:"data:"+(H.type||"")+";base64,"+a.btoa(b)}function y(a,b){var e=this,d;if(window.FileReader)d=new FileReader,d.onload=function(){b(this.result)},
        d.onerror=function(){e.trigger("error",new c.FileException(c.FileException.NOT_READABLE_ERR))},d.readAsDataURL(a);else return b(a.getAsDataURL())}function m(a,b,c,g){var h,p=0,q=0,m,y;D=g;y=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;-1!==d.inArray(y,[5,6,7,8])&&(m=a,a=b,b=m);m=f();h=(c?Math.max:Math.min)(a/m.width,b/m.height);if(!(1<h)||c&&!g){n||(n=document.createElement("canvas"));g=Math.round(m.width*h);h=Math.round(m.height*h);c?(n.width=a,n.height=b,g>a&&(p=Math.round((g-a)/2)),
        h>b&&(q=Math.round((h-b)/2))):(n.width=g,n.height=h);if(!D){a=n.width;b=n.height;switch(y){case 5:case 6:case 7:case 8:n.width=b;n.height=a;break;default:n.width=a,n.height=b}c=n.getContext("2d");switch(y){case 2:c.translate(a,0);c.scale(-1,1);break;case 3:c.translate(a,b);c.rotate(Math.PI);break;case 4:c.translate(0,b);c.scale(1,-1);break;case 5:c.rotate(.5*Math.PI);c.scale(1,-1);break;case 6:c.rotate(.5*Math.PI);c.translate(0,-b);break;case 7:c.rotate(.5*Math.PI);c.translate(a,-b);c.scale(-1,1);
        break;case 8:c.rotate(-.5*Math.PI),c.translate(-a,0)}}y=n;p=-p;q=-q;"iOS"===k.OS?e.renderTo(m,y,{width:g,height:h,x:p,y:q}):y.getContext("2d").drawImage(m,p,q,g,h);this.width=n.width;this.height=n.height;z=!0}this.trigger("Resize")}function l(){x&&(x.purge(),x=null);C=v=n=H=null;z=!1}var t=this,v,x,n,C,H,z=!1,D=!0;d.extend(this,{loadFromBlob:function(a){var b=this,e=b.getRuntime(),d=1<arguments.length?arguments[1]:!0;if(!e.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
        H=a;a.isDetached()?(C=a.getSource(),q.call(this,C)):y.call(this,a.getSource(),function(a){d&&(C=p(a));q.call(b,a)})},loadFromImage:function(a,c){this.meta=a.meta;H=new b(null,{name:a.name,size:a.size,type:a.type});q.call(this,c?C=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime();!x&&C&&a.can("access_image_binary")&&(x=new h(C));return{width:f().width||0,height:f().height||0,type:H.type||g.getFileMime(H.name),size:C&&C.length||H.size||0,name:H.name||"",meta:x&&x.meta||
        this.meta||{}}},downsize:function(){m.apply(this,arguments)},getAsCanvas:function(){n&&(n.id=this.uid+"_canvas");return n},getAsBlob:function(a,c){a!==this.type&&m.call(this,this.width,this.height,!1);return new b(null,{name:H.name||"",type:a,data:t.getAsBinaryString.call(this,a,c)})},getAsDataURL:function(a,b){var c=b||90;if(!z)return v.src;if("image/jpeg"!==a)return n.toDataURL("image/png");try{return n.toDataURL("image/jpeg",c/100)}catch(e){return n.toDataURL("image/jpeg")}},getAsBinaryString:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      b){if(!z)return C||(C=p(t.getAsDataURL(a,b))),C;if("image/jpeg"!==a)C=p(t.getAsDataURL(a,b));else{var c;b||(b=90);try{c=n.toDataURL("image/jpeg",b/100)}catch(e){c=n.toDataURL("image/jpeg")}C=p(c);x&&(C=x.stripHeaders(C),D&&(x.meta&&x.meta.exif&&x.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),C=x.writeHeaders(C)),x.purge(),x=null)}z=!1;return C},destroy:function(){t=null;l.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});n("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic",
    "moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,d,c,a,b){function h(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}var e={};b.addConstructor("flash",function(g){var k=this,r;g=f.extend({swf_url:d.swf_url},g);b.call(this,g,"flash",{access_binary:function(a){return a&&
    "browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:b.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!f.arrayDiff(a,["","text","document"])||"browser"===k.mode},return_status_code:function(a){return"browser"===k.mode||!f.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,
    send_binary_string:function(a){return a&&"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=f.parseSizeStr(a)||"client"===k.mode},use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?"browser":
    "client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return f.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return f.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
    "browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=f.parseSizeStr(a)?"client":"browser"}},"client");10>h()&&(this.mode=!1);f.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var b,c,e;e=this.getShimContainer();f.extend(e.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});
    b='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+g.swf_url+'" ';"IE"===d.browser&&(b+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');b+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+d.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===d.browser?(c=document.createElement("div"),
        e.appendChild(c),c.outerHTML=b,c=e=null):e.innerHTML=b;r=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(r);g=r=a=k=null}}(this.destroy)},e)});return e});n("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,d){return f.Blob={slice:function(c,a,b,h){var e=this.getRuntime();0>a?a=Math.max(c.size+a,0):0<a&&(a=Math.min(a,c.size));0>b?
    b=Math.max(c.size+b,0):0<b&&(b=Math.min(b,c.size));(c=e.shimExec.call(this,"Blob","slice",a,b,h||""))&&(c=new d(e.uid,c));return c}}});n("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(f){return f.FileInput={init:function(d){this.getRuntime().shimExec.call(this,"FileInput","init",{name:d.name,accept:d.accept,multiple:d.multiple});this.trigger("ready")}}});n("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(f,d){function c(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   c){switch(c){case "readAsText":return d.atob(a,"utf8");case "readAsBinaryString":return d.atob(a);case "readAsDataURL":return a}return null}var a="";return f.FileReader={read:function(b,d){var e=this.getRuntime();"readAsDataURL"===b&&(a="data:"+(d.type||"")+";base64,");this.bind("Progress",function(e,d){d&&(a+=c(d,b))});return e.shimExec.call(this,"FileReader","readAsBase64",d.uid)},getResult:function(){return a},destroy:function(){a=null}}});n("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime",
    "moxie/core/utils/Encode"],function(f,d){function c(a,b){switch(b){case "readAsText":return d.atob(a,"utf8");case "readAsBinaryString":return d.atob(a);case "readAsDataURL":return a}return null}return f.FileReaderSync={read:function(a,b){var d;d=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid);if(!d)return null;"readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d);return c(d,a,b.type)}}});n("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
    function(f,d,c,a,b,h,e){return f.XMLHttpRequest={send:function(a,b){function f(){a.transport=m.mode;m.shimExec.call(y,"XMLHttpRequest","send",a,b)}function p(a,c){m.shimExec.call(y,"XMLHttpRequest","appendBlob",a,c.uid);b=null;f()}function q(a,b){var c=new e;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:m.uid})}var y=this,m=y.getRuntime();d.isEmptyObj(a.headers)||d.each(a.headers,function(a,b){m.shimExec.call(y,"XMLHttpRequest","setRequestHeader",
        b,a.toString())});if(b instanceof h){var l;b.each(function(a,b){a instanceof c?l=b:m.shimExec.call(y,"XMLHttpRequest","append",b,a)});if(b.hasBlob()){var t=b.getBlob();t.isDetached()?q(t,function(a){t.destroy();p(l,a)}):p(l,t)}else b=null,f()}else b instanceof c?b.isDetached()?q(b,function(a){b.destroy();b=a.uid;f()}):(b=b.uid,f()):f()},getResponse:function(c){var e,h,f=this.getRuntime();if(h=f.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){h=new a(f.uid,h);if("blob"===c)return h;try{e=
        new b;if(~d.inArray(c,["","text"]))return e.readAsText(h);if("json"===c&&window.JSON)return JSON.parse(e.readAsText(h))}finally{h.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});n("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,d){return f.Transporter={getAsBlob:function(c){var a=this.getRuntime();return(c=a.shimExec.call(this,
    "Transporter","getAsBlob",c))?new d(a.uid,c):null}}});n("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(f,d,c,a,b){return f.Image={loadFromBlob:function(a){function b(a){f.shimExec.call(d,"Image","loadFromBlob",a.uid);d=f=null}var d=this,f=d.getRuntime();if(a.isDetached()){var r=new c;r.bind("TransportingComplete",function(){b(r.result.getSource())});r.transport(a.getSource(),
    a.type,{ruid:f.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(b,c){var d=this.getRuntime(),f=d.shimExec.call(this,"Image","getAsBlob",b,c);return f?new a(d.uid,f):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments);return a?(new b).readAsDataURL(a):null}}});n("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom",
    "moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,d,c,a,b){function h(a){var b=!1,c=null,e,d,h,f,l,t=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(v){var n=navigator.plugins["Silverlight Plug-In"];if(n){e=n.description;"1.0.30226.2"===e&&(e="2.0.30226.2");for(d=e.split(".");3<d.length;)d.pop();for(;4>d.length;)d.push(0);for(h=a.split(".");4<h.length;)h.pop();do f=parseInt(h[t],10),l=parseInt(d[t],10),t++;while(t<h.length&&f===l);f<=l&&!isNaN(f)&&
(b=!0)}}}catch(M){b=!1}return b}var e={};b.addConstructor("silverlight",function(g){var k=this,r;g=f.extend({xap_url:d.xap_url},g);b.call(this,g,"silverlight",{access_binary:b.capTrue,access_image_binary:b.capTrue,display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:b.capTrue,resize_image:b.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===
    k.mode||!f.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,send_binary_string:b.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:b.capTrue,use_http_method:function(a){return"client"===k.mode||!f.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return f.arrayDiff(a,
    [200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return f.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});h("2.0.31005.0")&&"Opera"!==d.browser||(this.mode=!1);f.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML=
    '<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+d.global_event_dispatcher+'"/></object>';r=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},
        "Windows"!==d.OS?1E4:5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(r);g=r=a=k=null}}(this.destroy)},e)});return e});n("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(f,d,c){return f.Blob=d.extend({},c)});n("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(f){return f.FileInput={init:function(d){this.getRuntime().shimExec.call(this,"FileInput","init",
    function(c){for(var a="",b=0;b<c.length;b++)a+=(""!==a?"|":"")+c[b].title+" | *."+c[b].extensions.replace(/,/g,";*.");return a}(d.accept),d.name,d.multiple);this.trigger("ready")}}});n("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(f,d,c){return f.FileDrop={init:function(){var a=this.getRuntime(),b;b=a.getShimContainer();c.addEvent(b,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect=
    "copy"},this.uid);c.addEvent(b,"dragenter",function(b){b.preventDefault();d.get(a.uid).dragEnter(b)&&b.stopPropagation()},this.uid);c.addEvent(b,"drop",function(b){b.preventDefault();d.get(a.uid).dragDrop(b)&&b.stopPropagation()},this.uid);return a.shimExec.call(this,"FileDrop","init")}}});n("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(f,d,c){return f.FileReader=d.extend({},c)});n("moxie/runtime/silverlight/file/FileReaderSync",
    ["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(f,d,c){return f.FileReaderSync=d.extend({},c)});n("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(f,d,c){return f.XMLHttpRequest=d.extend({},c)});n("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],
    function(f,d,c){return f.Transporter=d.extend({},c)});n("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(f,d,c){return f.Image=d.extend({},c,{getInfo:function(){var a=["tiff","exif","gps"],b={meta:{}},c=this.getRuntime().shimExec.call(this,"Image","getInfo");c.meta&&d.each(a,function(a){var d=c.meta[a],f,r,p,q;if(d&&d.keys)for(b.meta[a]={},r=0,p=d.keys.length;r<p;r++)if(f=d.keys[r],q=d[f])/^(\d|[1-9]\d+)$/.test(q)?
    q=parseInt(q,10):/^\d*\.\d+$/.test(q)&&(q=parseFloat(q)),b.meta[a][f]=q});b.width=parseInt(c.width,10);b.height=parseInt(c.height,10);b.size=parseInt(c.size,10);b.type=c.type;b.name=c.name;return b}})});n("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,d,c,a){var b={};c.addConstructor("html4",function(d){var e=this,g=c.capTest,k=c.capTrue;c.call(this,d,"html4",{access_binary:g(window.FileReader||window.File&&
    File.getAsDataURL),access_image_binary:!1,display_media:g(b.Image&&(a.can("create_canvas")||a.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:g("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),resize_image:function(){return b.Image&&e.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~f.inArray(a,["text","document",""])},return_status_code:function(a){return!f.arrayDiff(a,
    [200,404])},select_file:function(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can("select_file")},summon_file_dialog:g("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:k,use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}});f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e);
    a=e=null}}(this.destroy)});f.extend(this.getShim(),b)});return b});n("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h){return f.FileInput=function(){function e(){var b=this,y=b.getRuntime(),m,l,t,v,n;n=d.guid("uid_");m=y.getShimContainer();g&&(l=c.get(g+"_form"))&&d.extend(l.style,{top:"100%"});t=document.createElement("form");t.setAttribute("id",
        n+"_form");t.setAttribute("method","post");t.setAttribute("enctype","multipart/form-data");t.setAttribute("encoding","multipart/form-data");d.extend(t.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});v=document.createElement("input");v.setAttribute("id",n);v.setAttribute("type","file");v.setAttribute("name",p.name||"Filedata");v.setAttribute("accept",r.join(","));d.extend(v.style,{fontSize:"999px",opacity:0});t.appendChild(v);m.appendChild(t);d.extend(v.style,
    {position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===h.browser&&10>h.version&&d.extend(v.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});v.onchange=function(){var a;this.value&&(a=this.files?this.files[0]:{name:this.value},f=[a],this.onchange=function(){},e.call(b),b.bind("change",function H(){var a=c.get(n),e=c.get(n+"_form"),d;b.unbind("change",H);b.files.length&&a&&e&&(d=b.files[0],a.setAttribute("id",d.uid),e.setAttribute("id",d.uid+"_form"),e.setAttribute("target",
        d.uid+"_iframe"))},998),v=t=null,b.trigger("change"))};y.can("summon_file_dialog")&&(y=c.get(p.browse_button),a.removeEvent(y,"click",b.uid),a.addEvent(y,"click",function(a){v&&!v.disabled&&v.click();a.preventDefault()},b.uid));g=n;m=l=y=null}var g,f=[],r=[],p;d.extend(this,{init:function(d){var f=this,g=f.getRuntime(),h;p=d;r=d.accept.mimes||b.extList2mimes(d.accept,g.can("filter_by_extension"));h=g.getShimContainer();(function(){var b,e;b=c.get(d.browse_button);g.can("summon_file_dialog")&&("static"===
    c.getStyle(b,"position")&&(b.style.position="relative"),e=parseInt(c.getStyle(b,"z-index"),10)||1,b.style.zIndex=e,h.style.zIndex=e-1);b=g.can("summon_file_dialog")?b:h;a.addEvent(b,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(b,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(b,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(c.get(d.container),"mouseup",function(){f.trigger("mouseup")},f.uid);b=null})();e.call(this);h=null;f.trigger({type:"ready",
    async:!0})},getFiles:function(){return f},disable:function(a){var b;if(b=c.get(g))b.disabled=!!a},destroy:function(){var b=this.getRuntime(),e=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(p&&c.get(p.container),this.uid);a.removeAllEvents(p&&c.get(p.browse_button),this.uid);b&&(b.innerHTML="");e.removeInstance(this.uid);g=f=r=p=null}})}});n("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(f,d){return f.FileReader=
    d});n("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(f,d,c,a,b,h,e,g){return f.XMLHttpRequest=function(){function f(a){var b=this,e,d,g,k=!1;if(q){e=q.id.replace(/_iframe$/,"");if(e=c.get(e+"_form")){d=e.getElementsByTagName("input");for(g=d.length;g--;)switch(d[g].getAttribute("type")){case "hidden":d[g].parentNode.removeChild(d[g]);
    break;case "file":k=!0}d=[];k||e.parentNode.removeChild(e);e=null}setTimeout(function(){h.removeEvent(q,"load",b.uid);q.parentNode&&q.parentNode.removeChild(q);var c=b.getRuntime().getShimContainer();c.children.length||c.parentNode.removeChild(c);q=null;a()},1)}}var r,p,q;d.extend(this,{send:function(y,m){var l=this,t=l.getRuntime(),v,n,M,C;r=p=null;if(m instanceof g&&m.hasBlob()){if(C=m.getBlob(),v=C.uid,M=c.get(v),n=c.get(v+"_form"),!n)throw new b.DOMException(b.DOMException.NOT_FOUND_ERR);}else v=
    d.guid("uid_"),n=document.createElement("form"),n.setAttribute("id",v+"_form"),n.setAttribute("method",y.method),n.setAttribute("enctype","multipart/form-data"),n.setAttribute("encoding","multipart/form-data"),n.setAttribute("target",v+"_iframe"),t.getShimContainer().appendChild(n);m instanceof g&&m.each(function(a,b){if(a instanceof e)M&&M.setAttribute("name",b);else{var c=document.createElement("input");d.extend(c,{type:"hidden",name:b,value:a});M?n.insertBefore(c,M):n.appendChild(c)}});n.setAttribute("action",
    y.url);(function(){var b=t.getShimContainer()||document.body,c=document.createElement("div");c.innerHTML='<iframe id="'+v+'_iframe" name="'+v+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';q=c.firstChild;b.appendChild(q);h.addEvent(q,"load",function(){var b;try{b=q.contentWindow.document||q.contentDocument||window.frames[q.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(b.title)?r=b.title.replace(/^(\d+).*$/,"$1"):(r=200,p=d.trim(b.body.innerHTML),l.trigger({type:"progress",
    loaded:p.length,total:p.length}),C&&l.trigger({type:"uploadprogress",loaded:C.size||1025,total:C.size||1025}))}catch(c){if(a.hasSameOrigin(y.url))r=404;else{f.call(l,function(){l.trigger("error")});return}}f.call(l,function(){l.trigger("load")})},l.uid)})();n.submit();l.trigger("loadstart")},getStatus:function(){return r},getResponse:function(a){if("json"===a&&"string"===d.typeOf(p)&&window.JSON)try{return JSON.parse(p.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return p},
    abort:function(){var a=this;q&&q.contentWindow&&(q.contentWindow.stop?q.contentWindow.stop():q.contentWindow.document.execCommand?q.contentWindow.document.execCommand("Stop"):q.src="about:blank");f.call(this,function(){a.dispatchEvent("abort")})}})}});n("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(f,d){return f.Image=d});(function(f){for(var d=0;d<f.length;d++){for(var c=A,a=f[d],b=a.split(/[.\/]/),h=0;h<b.length-1;++h)void 0===c[b[h]]&&
(c[b[h]]={}),c=c[b[h]];c[b[b.length-1]]=u[a]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))})(this);
(function(){var A={},l=moxie.core.utils.Basic.inArray;(function n(u){var f,d;for(f in u)d=typeof u[f],"object"!==d||~l(f,["Exceptions","Env","Mime"])?"function"===d&&(A[f]=u[f]):n(u[f])})(window.moxie);A.Env=window.moxie.core.utils.Env;A.Mime=window.moxie.core.utils.Mime;A.Exceptions=window.moxie.core.Exceptions;window.mOxie=A;window.o||(window.o=A);return A})();
(function(A,l,w){function n(c){function a(a,b,c){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};d[a]?f[d[a]]=b:c||(f[a]=b)}var b=c.required_features,f={};"string"===typeof b?d.each(b.split(/\s*,\s*/),function(b){a(b,!0)}):"object"===typeof b?d.each(b,
    function(b,c){a(c,b)}):!0===b&&(c.multipart||(f.send_binary_string=!0),0<c.chunk_size&&(f.slice_blob=!0),c.resize.enabled&&(f.send_binary_string=!0),d.each(c,function(b,c){a(c,!!b,!0)}));return f}var u=A.setTimeout,f={},d={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,
    IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:l.mimes,ua:l.ua,typeOf:l.typeOf,extend:l.extend,guid:l.guid,get:function(c){var a=[],b;"array"!==l.typeOf(c)&&(c=[c]);for(var d=c.length;d--;)(b=l.get(c[d]))&&a.push(b);return a.length?a:null},each:l.each,getPos:l.getPos,getSize:l.getSize,xmlEncode:function(c){var a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},b=/[<>&\"\']/g;return c?(""+c).replace(b,function(b){return a[b]?"&"+a[b]+";":b}):c},toArray:l.toArray,inArray:l.inArray,addI18n:l.addI18n,translate:l.translate,
    isEmptyObj:l.isEmptyObj,hasClass:l.hasClass,addClass:l.addClass,removeClass:l.removeClass,getStyle:l.getStyle,addEvent:l.addEvent,removeEvent:l.removeEvent,removeAllEvents:l.removeAllEvents,cleanName:function(c){var a,b;b=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(a=0;a<b.length;a+=2)c=c.replace(b[a],
        b[a+1]);c=c.replace(/\s+/g,"_");return c=c.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(c,a){var b="";d.each(a,function(a,c){b+=(b?"&":"")+encodeURIComponent(c)+"="+encodeURIComponent(a)});b&&(c+=(0<c.indexOf("?")?"&":"?")+b);return c},formatSize:function(c){function a(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(c===w||/\D/.test(c))return d.translate("N/A");var b=Math.pow(1024,4);return c>b?a(c/b,1)+" "+d.translate("tb"):c>(b/=1024)?a(c/b,1)+" "+d.translate("gb"):c>(b/=1024)?
        a(c/b,1)+" "+d.translate("mb"):1024<c?Math.round(c/1024)+" "+d.translate("kb"):c+" "+d.translate("b")},parseSize:l.parseSizeStr,predictRuntime:function(c,a){var b,f;b=new d.Uploader(c);f=l.Runtime.thatCan(b.getOption().required_features,a||c.runtimes);b.destroy();return f},addFileFilter:function(c,a){f[c]=a}};d.addFileFilter("mime_types",function(c,a,b){c.length&&!c.regexp.test(a.name)?(this.trigger("Error",{code:d.FILE_EXTENSION_ERROR,message:d.translate("File extension error."),file:a}),b(!1)):
    b(!0)});d.addFileFilter("max_file_size",function(c,a,b){c=d.parseSize(c);void 0!==a.size&&c&&a.size>c?(this.trigger("Error",{code:d.FILE_SIZE_ERROR,message:d.translate("File size error."),file:a}),b(!1)):b(!0)});d.addFileFilter("prevent_duplicates",function(c,a,b){if(c)for(c=this.files.length;c--;)if(a.name===this.files[c].name&&a.size===this.files[c].size){this.trigger("Error",{code:d.FILE_DUPLICATE_ERROR,message:d.translate("Duplicate file error."),file:a});b(!1);return}b(!0)});d.Uploader=function(c){function a(){var a,
    b=0,c;if(this.state==d.STARTED){for(c=0;c<D.length;c++)a||D[c].status!=d.QUEUED?b++:(a=D[c],this.trigger("BeforeUpload",a)&&(a.status=d.UPLOADING,this.trigger("UploadFile",a)));b==D.length&&(this.state!==d.STOPPED&&(this.state=d.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",D))}}function b(a){a.percent=0<a.size?Math.ceil(a.loaded/a.size*100):100;h()}function h(){var a,b;E.reset();for(a=0;a<D.length;a++)b=D[a],b.size!==w?(E.size+=b.origSize,E.loaded+=b.loaded*b.origSize/b.size):
    E.size=w,b.status==d.DONE?E.uploaded++:b.status==d.FAILED?E.failed++:E.queued++;E.size===w?E.percent=0<D.length?Math.ceil(E.uploaded/D.length*100):0:(E.bytesPerSec=Math.ceil(E.loaded/((+new Date-T||1)/1E3)),E.percent=0<E.size?Math.ceil(E.loaded/E.size*100):0)}function e(){var a=J[0]||A[0];return a?a.getRuntime().uid:!1}function g(a,b){if(a.ruid){var c=l.Runtime.getInfo(a.ruid);if(c)return c.can(b)}return!1}function k(a,b){var c=this,e=0,f=[],g={accept:a.filters.mime_types,runtime_order:a.runtimes,
    required_caps:a.required_features,preferred_caps:I,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};d.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(g[b]=a[b])});a.browse_button&&d.each(a.browse_button,function(b){f.push(function(f){var h=new l.FileInput(d.extend({},g,{name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:b}));h.onready=function(){var a=l.Runtime.getInfo(this.ruid);l.extend(c.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),
    multi_selection:a.can("select_multiple")});e++;J.push(this);f()};h.onchange=function(){c.addFile(this.files)};h.bind("mouseenter mouseleave mousedown mouseup",function(c){N||(a.browse_button_hover&&("mouseenter"===c.type?l.addClass(b,a.browse_button_hover):"mouseleave"===c.type&&l.removeClass(b,a.browse_button_hover)),a.browse_button_active&&("mousedown"===c.type?l.addClass(b,a.browse_button_active):"mouseup"===c.type&&l.removeClass(b,a.browse_button_active)))});h.bind("error runtimeerror",function(){h=
    null;f()});h.init()})});a.drop_element&&d.each(a.drop_element,function(a){f.push(function(b){var f=new l.FileDrop(d.extend({},g,{drop_zone:a}));f.onready=function(){var a=l.Runtime.getInfo(this.ruid);c.features.dragdrop=a.can("drag_and_drop");e++;A.push(this);b()};f.ondrop=function(){c.addFile(this.files)};f.bind("error runtimeerror",function(){f=null;b()});f.init()})});l.inSeries(f,function(){"function"===typeof b&&b(e)})}function r(a,b,c){var e=new l.Image;try{e.onload=function(){e.downsize(b.width,
    b.height,b.crop,b.preserve_headers)},e.onresize=function(){c(this.getAsBlob(a.type,b.quality));this.destroy()},e.onerror=function(){c(a)},e.load(a)}catch(d){c(a)}}function p(a,b,c){function f(a,b,c){var e=z[a];switch(a){case "max_file_size":"max_file_size"===a&&(z.max_file_size=z.filters.max_file_size=b);break;case "chunk_size":if(b=d.parseSize(b))z[a]=b;break;case "filters":"array"===d.typeOf(b)&&(b={mime_types:b});c?d.extend(z.filters,b):z.filters=b;b.mime_types&&(z.filters.mime_types.regexp=function(a){var b=
    [];d.each(a,function(a){d.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})});return new RegExp("("+b.join("|")+")$","i")}(z.filters.mime_types));break;case "resize":c?d.extend(z.resize,b,{enabled:!0}):z.resize=b;break;case "prevent_duplicates":z.prevent_duplicates=z.filters.prevent_duplicates=!!b;break;case "browse_button":case "drop_element":b=d.get(b);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":z[a]=
    b;c||(h=!0);break;default:z[a]=b}c||g.trigger("OptionChanged",a,b,e)}var g=this,h=!1;"object"===typeof a?d.each(a,function(a,b){f(b,a,c)}):f(a,b,c);c?(z.required_features=n(d.extend({},z)),I=n(d.extend({},z,{required_features:!0}))):h&&(g.trigger("Destroy"),k.call(g,z,function(a){a?(g.runtime=l.Runtime.getInfo(e()).type,g.trigger("Init",{runtime:g.runtime}),g.trigger("PostInit")):g.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})}))}function q(a,b){[].push.apply(D,b);a.trigger("QueueChanged");
    a.refresh()}function y(a,b){if(z.unique_names){var c=b.name.match(/\.([^.]+)$/),e="part";c&&(e=c[1]);b.target_name=b.id+"."+e}}function m(a,b){function c(){0<k--?u(e,1E3):(b.loaded=q,a.trigger("Error",{code:d.HTTP_ERROR,message:d.translate("HTTP Error."),file:b,response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()}))}function e(){var g,r,y,t;b.status!=d.DONE&&b.status!=d.FAILED&&a.state!=d.STOPPED&&(y={name:b.target_name||b.name},h&&p.chunks&&m.size>h?(t=Math.min(h,m.size-
    q),g=m.slice(q,q+t)):(t=m.size,g=m),h&&p.chunks&&(a.settings.send_chunk_number?(y.chunk=Math.ceil(q/h),y.chunks=Math.ceil(m.size/h)):(y.offset=q,y.total=m.size)),B=new l.XMLHttpRequest,B.upload&&(B.upload.onprogress=function(c){b.loaded=Math.min(b.size,q+c.loaded);a.trigger("UploadProgress",b)}),B.onload=function(){400<=B.status?c():(k=a.settings.max_retries,t<m.size?(g.destroy(),q+=t,b.loaded=Math.min(q,m.size),a.trigger("ChunkUploaded",b,{offset:b.loaded,total:m.size,response:B.responseText,status:B.status,
    responseHeaders:B.getAllResponseHeaders()}),"Android Browser"===l.Env.browser&&a.trigger("UploadProgress",b)):b.loaded=b.size,g=r=null,!q||q>=m.size?(b.size!=b.origSize&&(m.destroy(),m=null),a.trigger("UploadProgress",b),b.status=d.DONE,a.trigger("FileUploaded",b,{response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()})):u(e,1))},B.onerror=function(){c()},B.onloadend=function(){this.destroy();B=null},a.settings.multipart&&p.multipart?(y.name=b.target_name||b.name,B.open("post",
    f,!0),d.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),r=new l.FormData,d.each(d.extend(y,a.settings.multipart_params),function(a,b){r.append(b,a)}),r.append(a.settings.file_data_name,g),B.send(r,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:I,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(f=d.buildUrl(a.settings.url,d.extend(y,a.settings.multipart_params)),B.open("post",f,!0),B.setRequestHeader("Content-Type",
    "application/octet-stream"),d.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),B.send(g,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:I,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var f=a.settings.url,h=a.settings.chunk_size,k=a.settings.max_retries,p=a.features,q=0,m;b.loaded&&(q=b.loaded=h*Math.floor(b.loaded/h));m=b.getSource();a.settings.resize.enabled&&g(m,"send_binary_string")&&~l.inArray(m.type,["image/jpeg",
    "image/png"])?r.call(this,m,a.settings.resize,function(a){m=a;b.size=a.size;e()}):e()}function K(a,c){b(c)}function t(a){if(a.state==d.STARTED)T=+new Date;else if(a.state==d.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==d.UPLOADING&&(a.files[b].status=d.QUEUED,h())}function v(){B&&B.abort()}function x(b){h();u(function(){a.call(b)},1)}function M(c,e){e.file&&(e.file.status=d.FAILED,b(e.file),c.state==d.STARTED&&(c.trigger("CancelUpload"),u(function(){a.call(c)},1)))}function C(a){a.stop();
    d.each(D,function(a){a.destroy()});D=[];J.length&&(d.each(J,function(a){a.destroy()}),J=[]);A.length&&(d.each(A,function(a){a.destroy()}),A=[]);I={};N=!1;T=B=null;E.reset()}var H=d.guid(),z,D=[],I={},J=[],A=[],T,E,N=!1,B;z={runtimes:l.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},
    send_chunk_number:!0};p.call(this,c,null,!0);E=new d.QueueProgress;d.extend(this,{id:H,uid:H,state:d.STOPPED,features:{},runtime:null,files:D,settings:z,total:E,init:function(){var a=this;"function"==typeof z.preinit?z.preinit(a):d.each(z.preinit,function(b,c){a.bind(c,b)});z.browse_button&&z.url?(this.bind("FilesAdded",q),this.bind("CancelUpload",v),this.bind("BeforeUpload",y),this.bind("UploadFile",m),this.bind("UploadProgress",K),this.bind("StateChanged",t),this.bind("QueueChanged",h),this.bind("Error",
    M),this.bind("FileUploaded",x),this.bind("Destroy",C),k.call(this,z,function(b){"function"==typeof z.init?z.init(a):d.each(z.init,function(b,c){a.bind(c,b)});b?(a.runtime=l.Runtime.getInfo(e()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})})):this.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})},setOption:function(a,b){p.call(this,a,b,!this.runtime)},getOption:function(a){return a?
    z[a]:z},refresh:function(){J.length&&d.each(J,function(a){a.trigger("Refresh")});this.trigger("Refresh")},start:function(){this.state!=d.STARTED&&(this.state=d.STARTED,this.trigger("StateChanged"),a.call(this))},stop:function(){this.state!=d.STOPPED&&(this.state=d.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){N=a!==w?a:!0;J.length&&d.each(J,function(a){a.disable(N)});this.trigger("DisableBrowse",N)},getFile:function(a){var b;for(b=D.length-1;0<=b;b--)if(D[b].id===
    a)return D[b]},addFile:function(a,b){function c(a,b){var e=[];l.each(h.settings.filters,function(b,c){f[c]&&e.push(function(e){f[c].call(h,b,a,function(a){e(!a)})})});l.inSeries(e,b)}function g(a){var e=l.typeOf(a);if(a instanceof l.File){if(!a.ruid&&!a.isDetached()){if(!p)return!1;a.ruid=p;a.connectRuntime(p)}g(new d.File(a))}else a instanceof l.Blob?(g(a.getSource()),a.destroy()):a instanceof d.File?(b&&(a.name=b),k.push(function(b){c(a,function(c){c||(q.push(a),h.trigger("FileFiltered",a));u(b,
    1)})})):-1!==l.inArray(e,["file","blob"])?g(new l.File(null,a)):"node"===e&&"filelist"===l.typeOf(a.files)?l.each(a.files,g):"array"===e&&(b=null,l.each(a,g))}var h=this,k=[],q=[],p;p=e();g(a);k.length&&l.inSeries(k,function(){q.length&&h.trigger("FilesAdded",q)})},removeFile:function(a){a="string"===typeof a?a:a.id;for(var b=D.length-1;0<=b;b--)if(D[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var c=D.splice(a===w?0:a,b===w?D.length:b),e=!1;this.state==d.STARTED&&(e=!0,this.stop());
    this.trigger("FilesRemoved",c);d.each(c,function(a){a.destroy()});this.trigger("QueueChanged");this.refresh();e&&this.start();return c},bind:function(a,b,c){var e=this;d.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);a.splice(0,1,e);return b.apply(this,a)},0,c)},destroy:function(){this.trigger("Destroy");z=E=null;this.unbindAll()}})};d.Uploader.prototype=l.EventTarget.instance;d.File=function(){var c={};return function(a){d.extend(this,{id:d.guid(),name:a.name||a.fileName,
    type:a.type||"",size:a.size||a.fileSize,origSize:a.size||a.fileSize,loaded:0,percent:0,status:d.QUEUED,lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==l.inArray(l.typeOf(a),["blob","file"])?a:null},getSource:function(){return c[this.id]?c[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete c[this.id])}});c[this.id]=a}}();d.QueueProgress=function(){var c=this;c.size=0;c.loaded=0;c.uploaded=
    0;c.failed=0;c.queued=0;c.percent=0;c.bytesPerSec=0;c.reset=function(){c.size=c.loaded=c.uploaded=c.failed=c.queued=c.percent=c.bytesPerSec=0}};A.plupload=d})(window,mOxie);
!function(A,l){function w(f,d){for(var c,a=[],b=0;b<f.length;++b){var h;if(!(h=u[f[b]]))a:{h=A;for(var e=f[b].split(/[.\/]/),g=0;g<e.length;++g){if(!h[e[g]]){h=void 0;break a}h=h[e[g]]}}if(c=h,!c)throw"module definition dependecy not found: "+f[b];a.push(c)}d.apply(null,a)}function n(f,d,c){if("string"!=typeof f)throw"invalid module definition, module id must be defined and be a string";if(d===l)throw"invalid module definition, dependencies must be specified";if(c===l)throw"invalid module definition, definition function must be specified";
    w(d,function(){u[f]=c.apply(null,arguments)})}var u={};n("moxie/core/utils/Basic",[],function(){var f=function(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},d=function(b){return c(arguments,function(h,e){0<e&&c(h,function(c,e){void 0!==c&&(f(b[e])===f(c)&&~a(f(c),["array","object"])?d(b[e],c):b[e]=c)})}),b},c=function(a,c){var e,d;if(a){try{e=a.length}catch(f){e=void 0}if(void 0===e)for(d in a){if(a.hasOwnProperty(d)&&
    !1===c(a[d],d))break}else for(d=0;e>d&&!1!==c(a[d],d);d++);}},a=function(a,c){if(c){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(c,a);for(var e=0,d=c.length;d>e;e++)if(c[e]===a)return e}return-1};return{guid:function(){var a=0;return function(c){var e=(new Date).getTime().toString(32),d;for(d=0;5>d;d++)e+=Math.floor(65535*Math.random()).toString(32);return(c||"o_")+e+(a++).toString(32)}}(),typeOf:f,extend:d,each:c,isEmptyObj:function(a){var c;if(!a||"object"!==f(a))return!0;for(c in a)return!1;
    return!0},inSeries:function(a,c){function e(k){"function"===f(a[k])&&a[k](function(a){++k<d&&!a?e(k):c(a)})}var d=a.length;"function"!==f(c)&&(c=function(){});a&&a.length||c();e(0)},inParallel:function(a,d){var e=0,f=a.length,k=Array(f);c(a,function(a,b){a(function(a){if(a)return d(a);var c=[].slice.call(arguments);c.shift();k[b]=c;e++;e===f&&(k.unshift(null),d.apply(this,k))})})},inArray:a,arrayDiff:function(b,c){var e=[];"array"!==f(b)&&(b=[b]);"array"!==f(c)&&(c=[c]);for(var d in b)-1===a(b[d],
    c)&&e.push(b[d]);return e.length?e:!1},arrayIntersect:function(b,d){var e=[];return c(b,function(b){-1!==a(b,d)&&e.push(b)}),e.length?e:null},toArray:function(a){var c,e=[];for(c=0;c<a.length;c++)e[c]=a[c];return e},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},parseSizeStr:function(a){if("string"!=typeof a)return a;var c={t:1099511627776,g:1073741824,m:1048576,k:1024},e;return a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,
    "")),e=a[2],a=+a[1],c.hasOwnProperty(e)&&(a*=c[e]),a}}});n("moxie/core/I18n",["moxie/core/utils/Basic"],function(f){var d={};return{addI18n:function(c){return f.extend(d,c)},translate:function(c){return d[c]||c},_:function(c){return this.translate(c)},sprintf:function(c){var a=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){var b=a.shift();return"undefined"!==f.typeOf(b)?b:""})}}});n("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(f,d){var c={mimes:{},
    extensions:{},addMimeType:function(a){a=a.split(/,/);var b,c,e;for(b=0;b<a.length;b+=2){e=a[b+1].split(/ /);for(c=0;c<e.length;c++)this.mimes[e[c]]=a[b];this.extensions[a[b]]=e}},extList2mimes:function(a,b){var c,e,d,k,r=[];for(e=0;e<a.length;e++)for(c=a[e].extensions.split(/\s*,\s*/),d=0;d<c.length;d++){if("*"===c[d])return[];if(k=this.mimes[c[d]])-1===f.inArray(k,r)&&r.push(k);else{if(!b||!/^\w+$/.test(c[d]))return[];r.push("."+c[d])}}return r},mimes2exts:function(a){var b=this,c=[];return f.each(a,
        function(a){if("*"===a)return c=[],!1;var d=a.match(/^(\w+)\/(\*|\w+)$/);d&&("*"===d[2]?f.each(b.extensions,function(a,e){(new RegExp("^"+d[1]+"/")).test(e)&&[].push.apply(c,b.extensions[e])}):b.extensions[a]&&[].push.apply(c,b.extensions[a]))}),c},mimes2extList:function(a){var b=[],c=[];return"string"===f.typeOf(a)&&(a=f.trim(a).split(/\s*,\s*/)),c=this.mimes2exts(a),b.push({title:d.translate("Files"),extensions:c.length?c.join(","):"*"}),b.mimes=a,b},getFileExtension:function(a){return(a=a&&a.match(/\.([^.]+)$/))?
        a[1].toLowerCase():""},getFileMime:function(a){return this.mimes[this.getFileExtension(a)]||""}};return c.addMimeType("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe"),
    c});n("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(f){var d=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},c=function(){for(var b,c=0,e,d,f,g,k,h=arguments;c<h.length;c+=2){k=h[c];var p=h[c+1];if("undefined"===typeof b)for(f in b={},p)e=p[f],"object"===typeof e?b[e[0]]=a:b[e]=a;for(e=d=0;e<k.length;e++)if(g=k[e].exec(this.getUA())){for(f=0;f<p.length;f++)k=g[++d],e=p[f],"object"===typeof e&&0<e.length?
        2==e.length?b[e[0]]="function"==typeof e[1]?e[1].call(this,k):e[1]:3==e.length?b[e[0]]="function"!==typeof e[1]||e[1].exec&&e[1].test?k?k.replace(e[1],e[2]):a:k?e[1].call(this,k,e[2]):a:4==e.length&&(b[e[0]]=k?e[3].call(this,k.replace(e[1],e[2])):a):b[e]=k?k:a;break}if(g)break}return b},e=function(c,e){for(var d in e)if("object"===typeof e[d]&&0<e[d].length)for(var f=0;f<e[d].length;f++){if(b.has(e[d][f],c))return"?"===d?a:d}else if(b.has(e[d],c))return"?"===d?a:d;return c},d={ME:"4.90","NT 3.11":"NT3.51",
    "NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},f=[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],["name","version","major"],[/\s(opr)\/((\d+)?[\w\.]+)/i],[["name","Opera"],"version","major"],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,
    /(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],["name","version","major"],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[["name","IE"],"version","major"],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[["name","Yandex"],"version","major"],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[["name",/_/g," "],"version","major"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],["name","version",
    "major"],[/(dolfin)\/((\d+)?[\w\.]+)/i],[["name","Dolphin"],"version","major"],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[["name","Chrome"],"version","major"],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[["name","Android Browser"],"version","major"],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],["version","major",["name","Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],["version","major","name"],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],
    ["name",["major",e,{1:["/8","/1","/3"],2:"/4","?":"/"}],["version",e,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],["name","version","major"],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[["name","Netscape"],"version","major"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,
        /(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],["name","version","major"]],r=[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv\:([\w\.]+).*(gecko)/i],
    ["version","name"]],p=[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],["name",["version",e,d]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",e,d]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name",
    "Symbian"],"version"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name","Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
    ["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],["name",["version",/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return(new function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,
    f)};this.getEngine=function(){return c.apply(this,r)};this.getOS=function(){return c.apply(this,p)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){return b=a,this};this.setUA(b)}).getResult()}(),c={can:function(){var a={define_property:!1,create_canvas:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),return_response_type:function(a){try{if(-1!==
    f.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var c=new XMLHttpRequest;if(c.open("get","/"),"responseType"in c)return c.responseType=a,c.responseType!==a?!1:!0}}catch(e){}return!1},use_data_uri:function(){var b=new Image;return b.onload=function(){a.use_data_uri=1===b.width&&1===b.height},setTimeout(function(){b.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return a.use_data_uri&&("IE"!==
    c.browser||9<=c.version)},use_data_uri_of:function(b){return a.use_data_uri&&33E3>b||a.use_data_uri_over32kb()},use_fileinput:function(){var a=document.createElement("input");return a.setAttribute("type","file"),!a.disabled}};return function(b){var c=[].slice.call(arguments);return c.shift(),"function"===f.typeOf(a[b])?a[b].apply(this,c):!!a[b]}}(),browser:d.browser.name,version:parseFloat(d.browser.major),os:d.os.name,osVersion:d.os.version,verComp:function(a,b,c){var e=0,d=0,f=0,r={dev:-6,alpha:-5,
    a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},e=function(a){return a=(""+a).replace(/[_\-+]/g,"."),a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),a.length?a.split("."):[-8]},p=function(a){return a?isNaN(a)?r[a]||-7:parseInt(a,10):0};a=e(a);b=e(b);d=Math.max(a.length,b.length);for(e=0;d>e;e++)if(a[e]!=b[e]){if(a[e]=p(a[e]),b[e]=p(b[e]),a[e]<b[e]){f=-1;break}if(a[e]>b[e]){f=1;break}}if(!c)return f;switch(c){case ">":case "gt":return 0<f;case ">=":case "ge":return 0<=f;case "<=":case "le":return 0>=
    f;case "==":case "=":case "eq":return 0===f;case "<>":case "!=":case "ne":return 0!==f;case "":case "<":case "lt":return 0>f;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return c.OS=c.os,c});n("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(f){var d=function(c,a){return c.className?(new RegExp("(^|\\s+)"+a+"(\\s+|$)")).test(c.className):!1};return{get:function(c){return"string"!=
    typeof c?c:document.getElementById(c)},hasClass:d,addClass:function(c,a){d(c,a)||(c.className=c.className?c.className.replace(/\s+$/,"")+" "+a:a)},removeClass:function(c,a){c.className&&(c.className=c.className.replace(new RegExp("(^|\\s+)"+a+"(\\s+|$)"),function(a,c,e){return" "===c&&" "===e?" ":""}))},getStyle:function(c,a){return c.currentStyle?c.currentStyle[a]:window.getComputedStyle?window.getComputedStyle(c,null)[a]:void 0},getPos:function(c,a){function b(a){var b,c,e=0,d=0;return a&&(c=a.getBoundingClientRect(),
    b="CSS1Compat"===k.compatMode?k.documentElement:k.body,e=c.left+b.scrollLeft,d=c.top+b.scrollTop),{x:e,y:d}}var d=0,e=0,g,k=document,r;if(a=a||k.body,c&&c.getBoundingClientRect&&"IE"===f.browser&&(!k.documentMode||8>k.documentMode))return g=b(c),r=b(a),{x:g.x-r.x,y:g.y-r.y};for(g=c;g&&g!=a&&g.nodeType;)d+=g.offsetLeft||0,e+=g.offsetTop||0,g=g.offsetParent;for(g=c.parentNode;g&&g!=a&&g.nodeType;)d-=g.scrollLeft||0,e-=g.scrollTop||0,g=g.parentNode;return{x:d,y:e}},getSize:function(c){return{w:c.offsetWidth||
    c.clientWidth,h:c.offsetHeight||c.clientHeight}}}});n("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(f){function d(c,a){for(var b in c)if(c[b]===a)return b;return null}return{RuntimeError:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": RuntimeError "+this.code}var a={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return f.extend(c,a),c.prototype=Error.prototype,c}(),OperationNotAllowedException:function(){function c(a){this.code=a;this.name="OperationNotAllowedException"}
    return f.extend(c,{NOT_ALLOWED_ERR:1}),c.prototype=Error.prototype,c}(),ImageError:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": ImageError "+this.code}var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return f.extend(c,a),c.prototype=Error.prototype,c}(),FileException:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": FileException "+this.code}var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,
    INVALID_STATE_ERR:7,SYNTAX_ERR:8};return f.extend(c,a),c.prototype=Error.prototype,c}(),DOMException:function(){function c(b){this.code=b;this.name=d(a,b);this.message=this.name+": DOMException "+this.code}var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,
    INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return f.extend(c,a),c.prototype=Error.prototype,c}(),EventException:function(){function c(a){this.code=a;this.name="EventException"}return f.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0}),c.prototype=Error.prototype,c}()}});n("moxie/core/EventTarget",["moxie/core/Exceptions","moxie/core/utils/Basic"],
    function(f,d){function c(){var a={};d.extend(this,{uid:null,init:function(){this.uid||(this.uid=d.guid("uid_"))},addEventListener:function(b,c,e,f){var k=this,r;return b=d.trim(b),/\s/.test(b)?(d.each(b.split(/\s+/),function(a){k.addEventListener(a,c,e,f)}),void 0):(b=b.toLowerCase(),e=parseInt(e,10)||0,r=a[this.uid]&&a[this.uid][b]||[],r.push({fn:c,priority:e,scope:f||this}),a[this.uid]||(a[this.uid]={}),a[this.uid][b]=r,void 0)},hasEventListener:function(b){return b?!(!a[this.uid]||!a[this.uid][b]):
        !!a[this.uid]},removeEventListener:function(b,c){b=b.toLowerCase();var e=a[this.uid]&&a[this.uid][b],f;if(e){if(c)for(f=e.length-1;0<=f;f--){if(e[f].fn===c){e.splice(f,1);break}}else e=[];e.length||(delete a[this.uid][b],d.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var c,e,g,k={},r=!0;if("string"!==d.typeOf(b)){if(e=b,"string"!==d.typeOf(e.type))throw new f.EventException(f.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
        b=e.type;void 0!==e.total&&void 0!==e.loaded&&(k.total=e.total,k.loaded=e.loaded);k.async=e.async||!1}if(-1!==b.indexOf("::")?function(a){c=a[0];b=a[1]}(b.split("::")):c=this.uid,b=b.toLowerCase(),e=a[c]&&a[c][b]){e.sort(function(a,b){return b.priority-a.priority});g=[].slice.call(arguments);g.shift();k.type=b;g.unshift(k);var p=[];d.each(e,function(a){g[0].target=a.scope;k.async?p.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,g))},1)}):p.push(function(b){b(!1===a.fn.apply(a.scope,
        g))})});p.length&&d.inSeries(p,function(a){r=!a})}return r},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(a){var c;"array"!==d.typeOf(a)&&(a=[a]);for(var e=0;e<a.length;e++)c="on"+a[e],"function"===d.typeOf(this[c])?this.addEventListener(a[e],
        this[c]):"undefined"===d.typeOf(this[c])&&(this[c]=null)}})}return c.instance=new c,c});n("moxie/core/utils/Encode",[],function(){var f=function(c){return unescape(encodeURIComponent(c))},d=function(c){return decodeURIComponent(escape(c))};return{utf8_encode:f,utf8_decode:d,atob:function(c,a){if("function"==typeof window.atob)return a?d(window.atob(c)):window.atob(c);var b,f,e,g,k,r=0,p=0,q="",l=[];if(!c)return c;c+="";do b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++)),
    f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++)),e=b<<18|f<<12|g<<6|k,b=255&e>>16,f=255&e>>8,e&=255,l[p++]=64==g?String.fromCharCode(b):64==k?String.fromCharCode(b,f):String.fromCharCode(b,f,e);while(r<c.length);return q=l.join(""),a?d(q):q},btoa:function(c,a){if(a&&f(c),
    "function"==typeof window.btoa)return window.btoa(c);var b,d,e,g,k=0,r=0,p="",p=[];if(!c)return c;do b=c.charCodeAt(k++),d=c.charCodeAt(k++),e=c.charCodeAt(k++),g=b<<16|d<<8|e,b=63&g>>18,d=63&g>>12,e=63&g>>6,g&=63,p[r++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);
while(k<c.length);p=p.join("");k=c.length%3;return(k?p.slice(0,k-3):p)+"===".slice(k||3)}}});n("moxie/runtime/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(f,d,c){function a(b,c,k,r,p){var q=this,l,m=f.guid(c+"_");p=p||"browser";b=b||{};h[m]=this;k=f.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,
    return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},k);b.preferred_caps&&(p=a.getMode(r,b.preferred_caps,p));l=function(){var a={};return{exec:function(b,c,e,d){return l[c]&&(a[b]||(a[b]={context:this,instance:new l[c]}),a[b].instance[e])?a[b].instance[e].apply(this,d):void 0},removeInstance:function(b){delete a[b]},
    removeAllInstances:function(){var b=this;f.each(a,function(a,c){"function"===f.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(c)})}}}();f.extend(this,{initialized:!1,uid:m,type:c,mode:a.getMode(r,b.required_caps,p),shimid:m+"_container",clients:0,options:b,can:function(b,c,e){e=e||k;if("string"===f.typeOf(b)&&"undefined"===f.typeOf(c)&&(b=a.parseCaps(b)),"object"===f.typeOf(b)){for(var d in b)if(!this.can(d,b[d],e))return!1;return!0}return"function"===f.typeOf(e[b])?
    e[b].call(this,c):c===e[b]},getShimContainer:function(){var a,b=d.get(this.shimid);return b||(a=this.options.container?d.get(this.options.container):document.body,b=document.createElement("div"),b.id=this.shimid,b.className="moxie-shim moxie-shim-"+this.type,f.extend(b.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),a.appendChild(b)),b},getShim:function(){return l},shimExec:function(a,b){var c=[].slice.call(arguments,2);return q.getShim().exec.call(this,
    this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return q[a]&&q[a][b]?q[a][b].apply(this,c):q.shimExec.apply(this,arguments)},destroy:function(){if(q){var a=d.get(this.shimid);a&&a.parentNode.removeChild(a);l&&l.removeAllInstances();this.unbindAll();delete h[this.uid];m=q=l=this.uid=null}}});this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var b={},h={};return a.order="html5,flash,silverlight,html4",a.getRuntime=function(a){return h[a]?h[a]:!1},a.addConstructor=
    function(a,d){d.prototype=c.instance;b[a]=d},a.getConstructor=function(a){return b[a]||null},a.getInfo=function(b){var c=a.getRuntime(b);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null},a.parseCaps=function(a){var b={};return"string"!==f.typeOf(a)?a||{}:(f.each(a.split(","),function(a){b[a]=!0}),b)},a.can=function(b,c){var d,f=a.getConstructor(b),h;return f?(d=new f({required_caps:c}),h=d.mode,d.destroy(),!!h):!1},a.thatCan=function(b,c){var d=(c||
    a.order).split(/\s*,\s*/),f;for(f in d)if(a.can(d[f],b))return d[f];return null},a.getMode=function(a,b,c){var d=null;if("undefined"===f.typeOf(c)&&(c="browser"),b&&!f.isEmptyObj(a)){if(f.each(b,function(b,c){if(a.hasOwnProperty(c)){var g=a[c](b);if("string"==typeof g&&(g=[g]),d){if(!(d=f.arrayIntersect(d,g)))return d=!1}else d=g}}),d)return-1!==f.inArray(c,d)?c:d[0];if(!1===d)return!1}return c},a.capTrue=function(){return!0},a.capFalse=function(){return!1},a.capTest=function(a){return function(){return!!a}},
    a});n("moxie/runtime/RuntimeClient",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(f,d,c){return function(){var a;d.extend(this,{connectRuntime:function(b){function h(d){var g,p;return d.length?(g=d.shift(),(p=c.getConstructor(g))?(a=new p(b),a.bind("Init",function(){a.initialized=!0;setTimeout(function(){a.clients++;e.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){a.destroy();h(d)}),a.mode?(a.init(),void 0):(a.trigger("Error"),void 0)):(h(d),void 0)):
    (e.trigger("RuntimeError",new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR)),a=null,void 0)}var e=this,g;if("string"===d.typeOf(b)?g=b:"string"===d.typeOf(b.ruid)&&(g=b.ruid),g){if(a=c.getRuntime(g))return a.clients++,a;throw new f.RuntimeError(f.RuntimeError.NOT_INIT_ERR);}h((b.runtime_order||c.order).split(/\s*,\s*/))},getRuntime:function(){return a&&a.uid?a:(a=null,null)},disconnectRuntime:function(){a&&0>=--a.clients&&(a.destroy(),a=null)}})}});n("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode",
    "moxie/runtime/RuntimeClient"],function(f,d,c){function a(h,e){function g(c,d,e){var g,h=b[this.uid];return"string"===f.typeOf(h)&&h.length?(g=new a(null,{type:e,size:d-c}),g.detach(h.substr(c,g.size)),g):null}c.call(this);h&&this.connectRuntime(h);e?"string"===f.typeOf(e)&&(e={data:e}):e={};f.extend(this,{uid:e.uid||f.guid("uid_"),ruid:h,size:e.size||0,type:e.type||"",slice:function(a,b,c){return this.isDetached()?g.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),
    a,b,c)},getSource:function(){return b[this.uid]?b[this.uid]:null},detach:function(a){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy",b[this.uid]),this.disconnectRuntime(),this.ruid=null);a=a||"";var c=a.match(/^data:([^;]*);base64,/);c&&(this.type=c[1],a=d.atob(a.substring(a.indexOf("base64,")+7)));this.size=a.length;b[this.uid]=a},isDetached:function(){return!this.ruid&&"string"===f.typeOf(b[this.uid])},destroy:function(){this.detach();delete b[this.uid]}});e.data?this.detach(e.data):
    b[this.uid]=e}var b={};return a});n("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(f,d,c){function a(a,h){var e,g;(h||(h={}),g=h.type&&""!==h.type?h.type:d.getFileMime(h.name),h.name)?(e=h.name.replace(/\\/g,"/"),e=e.substr(e.lastIndexOf("/")+1)):(e=g.split("/")[0],e=f.guid((""!==e?e:"file")+"_"),d.extensions[g]&&(e+="."+d.extensions[g][0]));c.apply(this,arguments);f.extend(this,{type:g||"",name:e||f.guid("file_"),lastModifiedDate:h.lastModifiedDate||
    (new Date).toLocaleString()})}return a.prototype=c.prototype,a});n("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/file/File moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),function(f,d,c,a,b,h,e,g,k){function r(b){var r=this,m;if(-1!==f.inArray(f.typeOf(b),["string","node"])&&(b={browse_button:b}),m=c.get(b.browse_button),!m)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);
    m={accept:[{title:h.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:m.parentNode||document.body};b=f.extend({},m,b);"string"==typeof b.required_caps&&(b.required_caps=g.parseCaps(b.required_caps));"string"==typeof b.accept&&(b.accept=d.mimes2extList(b.accept));(m=c.get(b.container))||(m=document.body);"static"===c.getStyle(m,"position")&&(m.style.position="relative");m=m=null;k.call(r);f.extend(r,{uid:f.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){r.convertEventPropsToHandlers(p);
        r.bind("RuntimeInit",function(a,d){r.ruid=d.uid;r.shimid=d.shimid;r.bind("Ready",function(){r.trigger("Refresh")},999);r.bind("Change",function(){var a=d.exec.call(r,"FileInput","getFiles");r.files=[];f.each(a,function(a){return 0===a.size?!0:(r.files.push(new e(r.ruid,a)),void 0)})},999);r.bind("Refresh",function(){var a,e,g,k;g=c.get(b.browse_button);k=c.get(d.shimid);g&&(a=c.getPos(g,c.get(b.container)),e=c.getSize(g),k&&f.extend(k.style,{top:a.y+"px",left:a.x+"px",width:e.w+"px",height:e.h+"px"}))});
            d.exec.call(r,"FileInput","init",b)});r.connectRuntime(f.extend({},b,{required_caps:{select_file:!0}}))},disable:function(a){var b=this.getRuntime();b&&b.exec.call(this,"FileInput","disable","undefined"===f.typeOf(a)?!0:a)},refresh:function(){r.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===f.typeOf(this.files)&&f.each(this.files,function(a){a.destroy()});this.files=null}})}var p="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");
    return r.prototype=b.instance,r});n("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),function(f,d,c,a,b,h,e,g){function k(c){var e=this,k;"string"==typeof c&&(c={drop_zone:c});k={accept:[{title:f.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};c="object"==typeof c?a.extend({},k,c):k;c.container=d.get(c.drop_zone)||document.body;
    "static"===d.getStyle(c.container,"position")&&(c.container.style.position="relative");"string"==typeof c.accept&&(c.accept=g.mimes2extList(c.accept));h.call(e);a.extend(e,{uid:a.guid("uid_"),ruid:null,files:null,init:function(){e.convertEventPropsToHandlers(r);e.bind("RuntimeInit",function(d,f){e.ruid=f.uid;e.bind("Drop",function(){var c=f.exec.call(e,"FileDrop","getFiles");e.files=[];a.each(c,function(a){e.files.push(new b(e.ruid,a))})},999);f.exec.call(e,"FileDrop","init",c);e.dispatchEvent("ready")});
        e.connectRuntime(c)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());this.files=null}})}var r=["ready","dragenter","dragleave","drop","error"];return k.prototype=e.instance,k});n("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,d,c){function a(){this.uid=f.guid("uid_");d.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}return a.prototype=
    c.instance,a});n("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/runtime/RuntimeTarget".split(" "),function(f,d,c,a,b,h,e){function g(){function a(f,r){function l(a){h.readyState=g.DONE;h.error=a;h.trigger("error");t()}function t(){q.destroy();q=null;h.trigger("loadend")}function v(a){q.bind("Error",function(a,b){l(b)});q.bind("Progress",function(b){h.result=a.exec.call(q,"FileReader","getResult");
    h.trigger(b)});q.bind("Load",function(b){h.readyState=g.DONE;h.result=a.exec.call(q,"FileReader","getResult");h.trigger(b);t()});a.exec.call(q,"FileReader","read",f,r)}if(q=new e,this.convertEventPropsToHandlers(k),this.readyState===g.LOADING)return l(new c.DOMException(c.DOMException.INVALID_STATE_ERR));if(this.readyState=g.LOADING,this.trigger("loadstart"),r instanceof b)if(r.isDetached()){var n=r.getSource();switch(f){case "readAsText":case "readAsBinaryString":this.result=n;break;case "readAsDataURL":this.result=
    "data:"+r.type+";base64,"+d.btoa(n)}this.readyState=g.DONE;this.trigger("load");t()}else v(q.connectRuntime(r.ruid));else l(new c.DOMException(c.DOMException.NOT_FOUND_ERR))}var h=this,q;f.extend(this,{uid:f.guid("uid_"),readyState:g.EMPTY,result:null,error:null,readAsBinaryString:function(b){a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){a.call(this,"readAsDataURL",b)},readAsText:function(b){a.call(this,"readAsText",b)},abort:function(){this.result=null;-1===f.inArray(this.readyState,
    [g.EMPTY,g.DONE])&&(this.readyState===g.LOADING&&(this.readyState=g.DONE),q&&q.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();q&&(q.getRuntime().exec.call(this,"FileReader","destroy"),q.disconnectRuntime());h=q=null}})}var k="loadstart progress load abort error loadend".split(" ");return g.EMPTY=0,g.LOADING=1,g.DONE=2,g.prototype=a.instance,g});n("moxie/core/utils/Url",[],function(){var f=function(d,c){for(var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     b=a.length,h={http:80,https:443},e={},g=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(d||"");b--;)g[b]&&(e[a[b]]=g[b]);e.scheme||(c&&"string"!=typeof c||(c=f(c||document.location.href)),e.scheme=c.scheme,e.host=c.host,e.port=c.port,a="",/^[^\/]/.test(e.path)&&(a=c.path,/(\/|\/[^\.]+)$/.test(a)?a+="/":a=a.replace(/\/[^\/]+$/,"/")),e.path=a+(e.path||""));return e.port||(e.port=h[e.scheme]||
    80),e.port=parseInt(e.port,10),e.path||(e.path="/"),delete e.source,e};return{parseUrl:f,resolveUrl:function(d){d=f(d);return d.scheme+"://"+d.host+(d.port!=={http:80,https:443}[d.scheme]?":"+d.port:"")+d.path+(d.query?d.query:"")},hasSameOrigin:function(d){function c(a){return[a.scheme,a.host,a.port].join("/")}return"string"==typeof d&&(d=f(d)),c(f())===c(d)}}});n("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(f,d,c){return function(){function a(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                d){if(!d.isDetached()){var e=this.connectRuntime(d.ruid).exec.call(this,"FileReaderSync","read",a,d);return this.disconnectRuntime(),e}e=d.getSource();switch(a){case "readAsBinaryString":return e;case "readAsDataURL":return"data:"+d.type+";base64,"+c.btoa(e);case "readAsText":for(var f="",k=0,r=e.length;r>k;k++)f+=String.fromCharCode(e[k]);return f}}d.call(this);f.extend(this,{uid:f.guid("uid_"),readAsBinaryString:function(b){return a.call(this,"readAsBinaryString",b)},readAsDataURL:function(b){return a.call(this,
    "readAsDataURL",b)},readAsText:function(b){return a.call(this,"readAsText",b)}})}});n("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(f,d,c){return function(){var a,b=[];d.extend(this,{append:function(f,e){var g=this,k=d.typeOf(e);e instanceof c?a={name:f,value:e}:"array"===k?(f+="[]",d.each(e,function(a){g.append(f,a)})):"object"===k?d.each(e,function(a,b){g.append(f+"["+b+"]",a)}):"null"===k||"undefined"===k||"number"===k&&isNaN(e)?g.append(f,"false"):
    b.push({name:f,value:e.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return a&&a.value||null},getBlobName:function(){return a&&a.name||null},each:function(c){d.each(b,function(a){c(a.value,a.name)});a&&c(a.value,a.name)},destroy:function(){a=null;b=[]}})}});n("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),
    function(f,d,c,a,b,h,e,g,k,r,p,q){function l(){this.uid=f.guid("uid_")}function m(){function c(a,b){return C.hasOwnProperty(a)?1===arguments.length?p.can("define_property")?C[a]:M[a]:(p.can("define_property")?C[a]=b:M[a]=b,void 0):void 0}function k(a){function b(){F.destroy();F=null;g.dispatchEvent("loadend");g=null}function d(e){F.bind("LoadStart",function(a){c("readyState",m.LOADING);g.dispatchEvent("readystatechange");g.dispatchEvent(a);L&&g.upload.dispatchEvent(a)});F.bind("Progress",function(a){c("readyState")!==
    m.LOADING&&(c("readyState",m.LOADING),g.dispatchEvent("readystatechange"));g.dispatchEvent(a)});F.bind("UploadProgress",function(a){L&&g.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});F.bind("Load",function(a){c("readyState",m.DONE);c("status",Number(e.exec.call(F,"XMLHttpRequest","getStatus")||0));c("statusText",n[c("status")]||"");c("response",e.exec.call(F,"XMLHttpRequest","getResponse",c("responseType")));~f.inArray(c("responseType"),["text",""])?c("responseText",
        c("response")):"document"===c("responseType")&&c("responseXML",c("response"));P=e.exec.call(F,"XMLHttpRequest","getAllResponseHeaders");g.dispatchEvent("readystatechange");0<c("status")?(L&&g.upload.dispatchEvent(a),g.dispatchEvent(a)):(Q=!0,g.dispatchEvent("error"));b()});F.bind("Abort",function(a){g.dispatchEvent(a);b()});F.bind("Error",function(a){Q=!0;c("readyState",m.DONE);g.dispatchEvent("readystatechange");R=!0;g.dispatchEvent(a);b()});e.exec.call(F,"XMLHttpRequest","send",{url:z,method:D,
        async:H,user:u,password:w,headers:I,mimeType:E,encoding:A,responseType:g.responseType,withCredentials:g.withCredentials,options:G},a)}var g=this;(new Date).getTime();F=new e;"string"==typeof G.required_caps&&(G.required_caps=h.parseCaps(G.required_caps));G.required_caps=f.extend({},G.required_caps,{return_response_type:g.responseType});a instanceof r&&(G.required_caps.send_multipart=!0);S||(G.required_caps.do_cors=!0);G.ruid?d(F.connectRuntime(G)):(F.bind("RuntimeInit",function(a,b){d(b)}),F.bind("RuntimeError",
        function(a,b){g.dispatchEvent("RuntimeError",b)}),F.connectRuntime(G))}var M=this,C={timeout:0,readyState:m.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},H=!0,z,D,I={},u,w,A=null,E=null,N=!1,B=!1,L=!1,R=!1,Q=!1,S=!1,G={},F,P="",O;f.extend(this,C,{uid:f.guid("uid_"),upload:new l,open:function(e,g,k,h,p){var q;if(!e||!g)throw new d.DOMException(d.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(e)||a.utf8_encode(e)!==e)throw new d.DOMException(d.DOMException.SYNTAX_ERR);
        if(~f.inArray(e.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(D=e.toUpperCase()),~f.inArray(D,["CONNECT","TRACE","TRACK"]))throw new d.DOMException(d.DOMException.SECURITY_ERR);if(g=a.utf8_encode(g),q=b.parseUrl(g),S=b.hasSameOrigin(q),z=b.resolveUrl(g),(h||p)&&!S)throw new d.DOMException(d.DOMException.INVALID_ACCESS_ERR);if(u=h||q.user,w=p||q.pass,H=k||!0,!1===H&&(c("timeout")||c("withCredentials")||""!==c("responseType")))throw new d.DOMException(d.DOMException.INVALID_ACCESS_ERR);
        N=!H;B=!1;I={};c("responseText","");c("responseXML",null);c("response",null);c("status",0);c("statusText","");c("readyState",m.OPENED);this.convertEventPropsToHandlers(["readystatechange"]);this.dispatchEvent("readystatechange")},setRequestHeader:function(b,e){if(c("readyState")!==m.OPENED||B)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(b)||a.utf8_encode(b)!==b)throw new d.DOMException(d.DOMException.SYNTAX_ERR);return b=f.trim(b).toLowerCase(),~f.inArray(b,
        "accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(b)?!1:(I[b]?I[b]+=", "+e:I[b]=e,!0)},getAllResponseHeaders:function(){return P||""},getResponseHeader:function(a){return a=a.toLowerCase(),Q||~f.inArray(a,["set-cookie","set-cookie2"])?null:P&&""!==P&&(O||(O=
    {},f.each(P.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=f.trim(a[0]),O[a[0].toLowerCase()]={header:a[0],value:f.trim(a[1])})})),O.hasOwnProperty(a))?O[a].header+": "+O[a].value:null},overrideMimeType:function(a){var b;if(~f.inArray(c("readyState"),[m.LOADING,m.DONE]))throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(a=f.trim(a.toLowerCase()),/;/.test(a)&&(b=a.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(a=b[1]),!q.mimes[a])throw new d.DOMException(d.DOMException.SYNTAX_ERR);
    },send:function(b,c){if(G="string"===f.typeOf(c)?{ruid:c}:c?c:{},this.convertEventPropsToHandlers(t),this.upload.convertEventPropsToHandlers(t),this.readyState!==m.OPENED||B)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);if(b instanceof g)G.ruid=b.ruid,E=b.type||"application/octet-stream";else if(b instanceof r){if(b.hasBlob()){var e=b.getBlob();G.ruid=e.ruid;E=e.type||"application/octet-stream"}}else"string"==typeof b&&(A="UTF-8",E="text/plain;charset=UTF-8",b=a.utf8_encode(b));this.withCredentials||
    (this.withCredentials=G.required_caps&&G.required_caps.send_browser_cookies&&!S);L=!N&&this.upload.hasEventListener();Q=!1;R=!b;N||(B=!0);k.call(this,b)},abort:function(){if(Q=!0,N=!1,~f.inArray(c("readyState"),[m.UNSENT,m.OPENED,m.DONE]))c("readyState",m.UNSENT);else{if(c("readyState",m.DONE),B=!1,!F)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);F.getRuntime().exec.call(F,"XMLHttpRequest","abort",R);R=!0}},destroy:function(){F&&("function"===f.typeOf(F.destroy)&&F.destroy(),F=null);
        this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var n={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",
        403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",
        503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};l.prototype=c.instance;var t="loadstart progress abort error load timeout loadend".split(" ");return m.UNSENT=0,m.OPENED=1,m.HEADERS_RECEIVED=2,m.LOADING=3,m.DONE=4,m.prototype=c.instance,m});n("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(f,d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         c,a){function b(){function a(c,d){var g=this;k=d;g.bind("TransportingProgress",function(a){q=a.loaded;p>q&&-1===f.inArray(g.state,[b.IDLE,b.DONE])&&e.call(g)},999);g.bind("TransportingComplete",function(){q=p;g.state=b.DONE;r=null;g.result=k.exec.call(g,"Transporter","getAsBlob",c||"")},999);g.state=b.BUSY;g.trigger("TransportingStarted");e.call(g)}function e(){var a;a=p-q;l>a&&(l=a);a=d.btoa(r.substr(q,l));k.exec.call(this,"Transporter","receive",a,p)}var g,k,r,p,q,l;c.call(this);f.extend(this,{uid:f.guid("uid_"),
    state:b.IDLE,result:null,transport:function(b,c,e){var d=this;e=f.extend({chunk_size:204798},e);(g=e.chunk_size%3)&&(e.chunk_size+=3-g);l=e.chunk_size;p=q=0;r=this.result=null;if(r=b,p=b.length,"string"===f.typeOf(e)||e.ruid)a.call(d,c,this.connectRuntime(e));else{var k=function(b,e){d.unbind("RuntimeInit",k);a.call(d,c,e)};this.bind("RuntimeInit",k);this.connectRuntime(e)}},abort:function(){this.state=b.IDLE;k&&(k.exec.call(this,"Transporter","clear"),this.trigger("TransportingAborted"));p=q=0;r=
        this.result=null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();p=q=0;r=this.result=null}})}return b.IDLE=0,b.BUSY=1,b.DONE=2,b.prototype=a.instance,b});n("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
    function(f,d,c,a,b,h,e,g,k,r,p,q,l){function m(){function a(b){var e=f.typeOf(b);try{if(b instanceof m){if(!b.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);r.apply(this,arguments)}else if(b instanceof p){if(!~f.inArray(b.type,["image/jpeg","image/png"]))throw new c.ImageError(c.ImageError.WRONG_FORMAT);x.apply(this,arguments)}else if(-1!==f.inArray(e,["blob","file"]))a.call(this,new q(null,b),arguments[1]);else if("string"===e)/^data:[^;]*;base64,/.test(b)?a.call(this,new p(null,
        {data:b}),arguments[1]):M.apply(this,arguments);else{if("node"!==e||"img"!==b.nodeName.toLowerCase())throw new c.DOMException(c.DOMException.TYPE_MISMATCH_ERR);a.call(this,b.src,arguments[1])}}catch(d){this.trigger("error",d)}}function r(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===f.typeOf(b)?!0:b)}function x(a,b){function c(b){e.ruid=b.uid;b.exec.call(e,"Image","loadFromBlob",a)}var e=this;e.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
        function(a,b){c(b)}),b&&"string"==typeof b.required_caps&&(b.required_caps=h.parseCaps(b.required_caps)),this.connectRuntime(f.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function M(a,c){var e=this,d;d=new b;d.open("get",a);d.responseType="blob";d.onprogress=function(a){e.trigger(a)};d.onload=function(){x.call(e,d.response,!0)};d.onerror=function(a){e.trigger(a)};d.onloadend=function(){d.destroy()};d.bind("RuntimeError",function(a,b){e.trigger("RuntimeError",
        b)});d.send(null,c)}e.call(this);f.extend(this,{uid:f.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){var a=void 0,a=this.getRuntime().exec.call(this,"Image","getInfo");this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name)},999);this.convertEventPropsToHandlers(n);a.apply(this,arguments)},downsize:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                b,e,d){try{if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);(a||b)&&"undefined"!==f.typeOf(e)||(e=!1);a=a||this.width;b=b||this.height;d="undefined"===f.typeOf(d)?!0:!!d;this.getRuntime().exec.call(this,"Image","downsize",a,b,e,d)}catch(g){this.trigger("error",g)}},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!k.can("create_canvas"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
        return this.connectRuntime(this.ruid).exec.call(this,"Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return a||(a="image/jpeg"),"image/jpeg"!==a||b||(b=90),this.getRuntime().exec.call(this,"Image","getAsBlob",a,b)},getAsDataURL:function(a,b){if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",a,b)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,
        b);return l.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,b){function e(){if(k.can("create_canvas")){var b=p.getAsCanvas();if(b)return a.appendChild(b),b=null,p.destroy(),h.trigger("embedded"),void 0}b=p.getAsDataURL(q,r);if(!b)throw new c.ImageError(c.ImageError.WRONG_FORMAT);if(k.can("use_data_uri_of",b.length))a.innerHTML='<img src="'+b+'" width="'+p.width+'" height="'+p.height+'" />',p.destroy(),h.trigger("embedded");else{var d=new g;d.bind("TransportingComplete",function(){L=h.connectRuntime(this.result.ruid);
        h.bind("Embedded",function(){f.extend(L.getShimContainer().style,{top:"0px",left:"0px",width:p.width+"px",height:p.height+"px"});L=null},999);L.exec.call(h,"ImageView","display",this.result.uid,v,x);p.destroy()});d.transport(l.atob(b.substring(b.indexOf("base64,")+7)),q,f.extend({},t,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a}))}}var h=this,p,q,r,n,t=b||{},v=this.width,x=this.height,L;try{if(!(a=d.get(a)))throw new c.DOMException(c.DOMException.INVALID_NODE_TYPE_ERR);
        if(!this.size)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(this.width>m.MAX_RESIZE_WIDTH||this.height>m.MAX_RESIZE_HEIGHT)throw new c.ImageError(c.ImageError.MAX_RESOLUTION_ERR);if(q=t.type||this.type||"image/jpeg",r=t.quality||90,n="undefined"!==f.typeOf(t.crop)?t.crop:!1,t.width)v=t.width,x=t.height||v;else{var K=d.getSize(a);K.w&&K.h&&(v=K.w,x=K.h)}return p=new m,p.bind("Resize",function(){e.call(h)}),p.bind("Load",function(){p.downsize(v,x,n,!1)}),p.clone(this,!1),p}catch(M){this.trigger("error",
        M)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.unbindAll()}})}var n=["progress","load","error","resize","embedded"];return m.MAX_RESIZE_WIDTH=6500,m.MAX_RESIZE_HEIGHT=6500,m.prototype=r.instance,m});n("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,d,c,a){var b={};return c.addConstructor("html5",function(d,e,g){var k=this,r=c.capTest,p=
    c.capTrue;g=f.extend({access_binary:r(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return k.can("access_binary")&&!!b.Image},display_media:r(a.can("create_canvas")||a.can("use_data_uri_over32kb")),do_cors:r(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:r(function(){var b=document.createElement("div");return("draggable"in b||"ondragstart"in b&&"ondrop"in b)&&("IE"!==a.browser||9<a.version)}()),filter_by_extension:r("Chrome"===
    a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),return_response_headers:p,return_response_type:function(b){return"json"===b&&window.JSON?!0:a.can("return_response_type",b)},return_status_code:p,report_upload_progress:r(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return k.can("access_binary")&&a.can("create_canvas")},select_file:function(){return a.can("use_fileinput")&&window.File},select_folder:function(){return k.can("select_file")&&"Chrome"===a.browser&&
    21<=a.version},select_multiple:function(){return!(!k.can("select_file")||"Safari"===a.browser&&"Windows"===a.os||"iOS"===a.os&&a.verComp(a.osVersion,"7.0.4","<"))},send_binary_string:r(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:r(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||k.can("send_binary_string")},slice_blob:r(window.File&&(File.prototype.mozSlice||
    File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return k.can("slice_blob")&&k.can("send_multipart")},summon_file_dialog:r("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||"IE"===a.browser&&10<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:p},g);c.call(this,d,e||"html5",g);f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(k);a=k=null}}(this.destroy)});f.extend(this.getShim(),
    b)}),b});n("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(f,d){return f.Blob=function(){function c(a,b,c){var e;if(!window.File.prototype.slice)return(e=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?e.call(a,b,c):null;try{return a.slice(),a.slice(b,c)}catch(d){return a.slice(b,c-b)}}this.slice=function(){return new d(this.getRuntime().uid,c.apply(this,arguments))}}});n("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(f){function d(){this.returnValue=
    !1}function c(){this.cancelBubble=!0}var a={},b="moxie_"+f.guid(),h=function(c,d,k){var h;if(d=d.toLowerCase(),c[b]&&a[c[b]]&&a[c[b]][d]){h=a[c[b]][d];for(var p=h.length-1;0<=p&&(h[p].orig!==k&&h[p].key!==k||(c.removeEventListener?c.removeEventListener(d,h[p].func,!1):c.detachEvent&&c.detachEvent("on"+d,h[p].func),h[p].orig=null,h[p].func=null,h.splice(p,1),void 0===k));p--);if(h.length||delete a[c[b]][d],f.isEmptyObj(a[c[b]])){delete a[c[b]];try{delete c[b]}catch(q){c[b]=void 0}}}};return{addEvent:function(e,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     g,k,h){var p;g=g.toLowerCase();e.addEventListener?(p=k,e.addEventListener(g,p,!1)):e.attachEvent&&(p=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=d;a.stopPropagation=c;k(a)},e.attachEvent("on"+g,p));e[b]||(e[b]=f.guid());a.hasOwnProperty(e[b])||(a[e[b]]={});e=a[e[b]];e.hasOwnProperty(g)||(e[g]=[]);e[g].push({func:p,orig:k,key:h})},removeEvent:h,removeAllEvents:function(c,d){c&&c[b]&&f.each(a[c[b]],function(a,b){h(c,b,d)})}}});n("moxie/runtime/html5/file/FileInput",
    "moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h){return f.FileInput=function(){var e=[],f;d.extend(this,{init:function(k){var r=this,p=r.getRuntime(),q,l,m;f=k;e=[];k=f.accept.mimes||b.extList2mimes(f.accept,p.can("filter_by_extension"));q=p.getShimContainer();q.innerHTML='<input id="'+p.uid+'" type="file" style="font-size:999px;opacity:0;"'+(f.multiple&&p.can("select_multiple")?
        "multiple":"")+(f.directory&&p.can("select_folder")?"webkitdirectory directory":"")+(k?' accept="'+k.join(",")+'"':"")+" />";k=c.get(p.uid);d.extend(k.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});l=c.get(f.browse_button);p.can("summon_file_dialog")&&("static"===c.getStyle(l,"position")&&(l.style.position="relative"),m=parseInt(c.getStyle(l,"z-index"),10)||1,l.style.zIndex=m,q.style.zIndex=m-1,a.addEvent(l,"click",function(a){var b=c.get(p.uid);b&&!b.disabled&&b.click();a.preventDefault()},
        r.uid));m=p.can("summon_file_dialog")?l:q;a.addEvent(m,"mouseover",function(){r.trigger("mouseenter")},r.uid);a.addEvent(m,"mouseout",function(){r.trigger("mouseleave")},r.uid);a.addEvent(m,"mousedown",function(){r.trigger("mousedown")},r.uid);a.addEvent(c.get(f.container),"mouseup",function(){r.trigger("mouseup")},r.uid);k.onchange=function t(){if(e=[],f.directory?d.each(this.files,function(a){"."!==a.name&&e.push(a)}):e=[].slice.call(this.files),"IE"!==h.browser)this.value="";else{var a=this.cloneNode(!0);
        this.parentNode.replaceChild(a,this);a.onchange=t}r.trigger("change")};r.trigger({type:"ready",async:!0});q=null},getFiles:function(){return e},disable:function(a){var b=this.getRuntime(),d;(d=c.get(b.uid))&&(d.disabled=!!a)},destroy:function(){var b=this.getRuntime(),d=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(f&&c.get(f.container),this.uid);a.removeAllEvents(f&&c.get(f.browse_button),this.uid);b&&(b.innerHTML="");d.removeInstance(this.uid);e=f=null}})}});
    n("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(f,d,c,a,b){return f.FileDrop=function(){function f(a){for(var b=[],c=0;c<a.length;c++)[].push.apply(b,a[c].extensions.split(/\s*,\s*/));return-1===d.inArray("*",b)?b:[]}function e(a){a=b.getFileExtension(a.name);return!a||!l.length||-1!==d.inArray(a,l)}function g(a,b){var c=[];d.each(a,function(a){var b=a.webkitGetAsEntry();
        b&&(b.isFile?(a=a.getAsFile(),e(a)&&q.push(a)):c.push(b))});c.length?k(c,b):b()}function k(a,b){var c=[];d.each(a,function(a){c.push(function(b){r(a,b)})});d.inSeries(c,function(){b()})}function r(a,b){a.isFile?a.file(function(a){e(a)&&q.push(a);b()},function(){b()}):a.isDirectory?p(a,b):b()}function p(a,b){function c(a){e.readEntries(function(b){b.length?([].push.apply(d,b),c(a)):a()},a)}var d=[],e=a.createReader();c(function(){k(d,b)})}var q=[],l=[],m;d.extend(this,{init:function(b){var c=this;
        m=b;l=f(m.accept);b=m.container;a.addEvent(b,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},c.uid);a.addEvent(b,"drop",function(a){a.preventDefault();a.stopPropagation();q=[];a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?g(a.dataTransfer.items,function(){c.trigger("drop")}):(d.each(a.dataTransfer.files,function(a){e(a)&&q.push(a)}),c.trigger("drop"))},c.uid);a.addEvent(b,"dragenter",function(a){a.preventDefault();a.stopPropagation();
            c.trigger("dragenter")},c.uid);a.addEvent(b,"dragleave",function(a){a.preventDefault();a.stopPropagation();c.trigger("dragleave")},c.uid)},getFiles:function(){return q},destroy:function(){a.removeAllEvents(m&&c.get(m.container),this.uid);q=l=m=null}})}});n("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(f,d,c){return f.FileReader=function(){var a,b=!1;c.extend(this,{read:function(d,e){var f=this;a=new window.FileReader;
        a.addEventListener("progress",function(a){f.trigger(a)});a.addEventListener("load",function(a){f.trigger(a)});a.addEventListener("error",function(b){f.trigger(b,a.error)});a.addEventListener("loadend",function(){a=null});"function"===c.typeOf(a[d])?(b=!1,a[d](e.getSource())):"readAsBinaryString"===d&&(b=!0,a.readAsDataURL(e.getSource()))},getResult:function(){var c;a&&a.result?b?(c=a.result,c=d.atob(c.substring(c.indexOf("base64,")+7))):c=a.result:c=null;return c},abort:function(){a&&a.abort()},destroy:function(){a=
        null}})}});n("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h,e,g,k){return f.XMLHttpRequest=function(){function f(a,b){var c=this,d,e;d=b.getBlob().getSource();e=new window.FileReader;e.onload=function(){b.append(b.getBlobName(),new h(null,{type:d.type,data:e.result}));l.send.call(c,a,
        b)};e.readAsBinaryString(d)}function p(){var a;if(!window.XMLHttpRequest||"IE"===k.browser&&8>k.version)a:{for(var b=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],c=0;c<b.length;c++)try{a=new ActiveXObject(b[c]);break a}catch(d){}a=void 0}else a=new window.XMLHttpRequest;return a}function q(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new g.RuntimeError(g.RuntimeError.NOT_SUPPORTED_ERR);return m.setRequestHeader("Content-Type","multipart/form-data; boundary="+
        b),a.each(function(a,d){c+=a instanceof h?"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n":"--"+b+'\r\nContent-Disposition: form-data; name="'+d+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n"}),c+="--"+b+"--\r\n"}var l=this,m,n;d.extend(this,{send:function(b,c){var g=this,l="Mozilla"===k.browser&&4<=k.version&&7>k.version,y="Android Browser"===
        k.browser,u=!1;if(n=b.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),m=p(),m.open(b.method,b.url,b.async,b.user,b.password),c instanceof h)c.isDetached()&&(u=!0),c=c.getSource();else if(c instanceof e){if(c.hasBlob())if(c.getBlob().isDetached())c=q.call(g,c),u=!0;else if((l||y)&&"blob"===d.typeOf(c.getBlob().getSource())&&window.FileReader)return f.call(g,b,c),void 0;if(c instanceof e){var z=new window.FormData;c.each(function(a,b){a instanceof h?z.append(b,a.getSource()):z.append(b,a)});c=
        z}}m.upload?(b.withCredentials&&(m.withCredentials=!0),m.addEventListener("load",function(a){g.trigger(a)}),m.addEventListener("error",function(a){g.trigger(a)}),m.addEventListener("progress",function(a){g.trigger(a)}),m.upload.addEventListener("progress",function(a){g.trigger({type:"UploadProgress",loaded:a.loaded,total:a.total})})):m.onreadystatechange=function(){switch(m.readyState){case 3:var c,d;try{a.hasSameOrigin(b.url)&&(c=m.getResponseHeader("Content-Length")||0),m.responseText&&(d=m.responseText.length)}catch(e){c=
        d=0}g.trigger({type:"progress",lengthComputable:!!c,total:parseInt(c,10),loaded:d});break;case 4:m.onreadystatechange=function(){},0===m.status?g.trigger("error"):g.trigger("load")}};d.isEmptyObj(b.headers)||d.each(b.headers,function(a,b){m.setRequestHeader(b,a)});""!==b.responseType&&"responseType"in m&&(m.responseType="json"!==b.responseType||k.can("return_response_type","json")?b.responseType:"text");u?m.sendAsBinary?m.sendAsBinary(c):function(){for(var a=new Uint8Array(c.length),b=0;b<c.length;b++)a[b]=
        255&c.charCodeAt(b);m.send(a.buffer)}():m.send(c);g.trigger("loadstart")},getStatus:function(){try{if(m)return m.status}catch(a){}return 0},getResponse:function(a){var d=this.getRuntime();try{switch(a){case "blob":var e=new b(d.uid,m.response),f=m.getResponseHeader("Content-Disposition");if(f){var g=f.match(/filename=([\'\"'])([^\1]+)\1/);g&&(n=g[2])}return e.name=n,e.type||(e.type=c.getFileMime(n)),e;case "json":return k.can("return_response_type","json")?m.response:200===m.status&&window.JSON?JSON.parse(m.responseText):
        null;case "document":var h=m.responseXML,p=m.responseText;return"IE"===k.browser&&p&&h&&!h.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(m.getResponseHeader("Content-Type"))&&(h=new window.ActiveXObject("Microsoft.XMLDOM"),h.async=!1,h.validateOnParse=!1,h.loadXML(p)),h&&("IE"===k.browser&&0!==h.parseError||!h.documentElement||"parsererror"===h.documentElement.tagName)?null:h;default:return""!==m.responseText?m.responseText:null}}catch(q){return null}},getAllResponseHeaders:function(){try{return m.getAllResponseHeaders()}catch(a){}return""},
        abort:function(){m&&m.abort()},destroy:function(){l=n=null}})}});n("moxie/runtime/html5/utils/BinaryReader",[],function(){return function(){function f(b,d){var e=c?0:-8*(d-1),f=0,k;for(k=0;d>k;k++)f|=a.charCodeAt(b+k)<<Math.abs(e+8*k);return f}function d(b,c,d){d=3===arguments.length?d:a.length-c-1;a=a.substr(0,c)+b+a.substr(d+c)}var c=!1,a;return{II:function(a){return a===l?c:(c=a,void 0)},init:function(b){c=!1;a=b},SEGMENT:function(b,c,e){switch(arguments.length){case 1:return a.substr(b,a.length-
        b-1);case 2:return a.substr(b,c);case 3:d(e,b,c);break;default:return a}},BYTE:function(a){return f(a,1)},SHORT:function(a){return f(a,2)},LONG:function(a,h){var e;if(h===l)e=f(a,4);else{e="";var g=c?0:-24,k;for(k=0;4>k;k++)e+=String.fromCharCode(255&h>>Math.abs(g+8*k));d(e,a,4);e=void 0}return e},SLONG:function(a){a=f(a,4);return 2147483647<a?a-4294967296:a},STRING:function(a,c){var d="";for(c+=a;c>a;a++)d+=String.fromCharCode(f(a,1));return d}}}});n("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader"],
        function(f){return function c(a){var b=[],h,e,g,k=0;if(h=new f,h.init(a),65496===h.SHORT(0)){for(e=2;e<=a.length;)if(g=h.SHORT(e),65488<=g&&65495>=g)e+=2;else{if(65498===g||65497===g)break;k=h.SHORT(e+2)+2;65505<=g&&65519>=g&&b.push({hex:g,name:"APP"+(15&g),start:e,length:k,segment:h.SEGMENT(e,k)});e+=k}return h.init(null),{headers:b,restore:function(a){var c,f;h.init(a);e=65504==h.SHORT(2)?4+h.SHORT(4):2;f=0;for(c=b.length;c>f;f++)h.SEGMENT(e,0,b[f].segment),e+=b[f].length;return a=h.SEGMENT(),h.init(null),
            a},strip:function(a){var b,e;e=new c(a);b=e.headers;e.purge();h.init(a);for(e=b.length;e--;)h.SEGMENT(b[e].start,b[e].length,"");return a=h.SEGMENT(),h.init(null),a},get:function(a){for(var c=[],e=0,f=b.length;f>e;e++)b[e].name===a.toUpperCase()&&c.push(b[e].segment);return c},set:function(a,c){var e=[],f,g,k;"string"==typeof c?e.push(c):e=c;f=g=0;for(k=b.length;k>f&&(b[f].name===a.toUpperCase()&&(b[f].segment=e[g],b[f].length=e[g].length,g++),!(g>=e.length));f++);},purge:function(){b=[];h.init(null);
            h=null}}}}});n("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,d){return function(){function c(b,c){var d=a.SHORT(b),f,h,m,n,t,v,x=[],u={};for(f=0;d>f;f++)if(v=b+12*f+2,m=c[a.SHORT(v)],m!==l){switch(n=a.SHORT(v+=2),t=a.LONG(v+=2),v+=4,x=[],n){case 1:case 7:4<t&&(v=a.LONG(v)+e.tiffHeader);for(h=0;t>h;h++)x[h]=a.BYTE(v+h);break;case 2:4<t&&(v=a.LONG(v)+e.tiffHeader);u[m]=a.STRING(v,t-1);continue;case 3:2<t&&(v=a.LONG(v)+e.tiffHeader);
        for(h=0;t>h;h++)x[h]=a.SHORT(v+2*h);break;case 4:1<t&&(v=a.LONG(v)+e.tiffHeader);for(h=0;t>h;h++)x[h]=a.LONG(v+4*h);break;case 5:v=a.LONG(v)+e.tiffHeader;for(h=0;t>h;h++)x[h]=a.LONG(v+4*h)/a.LONG(v+4*h+4);break;case 9:v=a.LONG(v)+e.tiffHeader;for(h=0;t>h;h++)x[h]=a.SLONG(v+4*h);break;case 10:v=a.LONG(v)+e.tiffHeader;for(h=0;t>h;h++)x[h]=a.SLONG(v+4*h)/a.SLONG(v+4*h+4);break;default:continue}h=1==t?x[0]:x;u[m]=g.hasOwnProperty(m)&&"object"!=typeof h?g[m][h]:h}return u}var a,b,h,e={},g;return a=new d,
        b={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",
            41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},g={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",
        14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",
        16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
        79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},
        Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(d){e={tiffHeader:10};if(d!==l&&d.length)if(a.init(d),65505===a.SHORT(0)&&"EXIF\x00"===a.STRING(4,5).toUpperCase()){var f=e.tiffHeader;d=(a.II(18761==a.SHORT(f)),42!==a.SHORT(f+=2)?!1:(e.IFD0=e.tiffHeader+a.LONG(f+2),h=c(e.IFD0,b.tiff),
        "ExifIFDPointer"in h&&(e.exifIFD=e.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(e.gpsIFD=e.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),!0))}else d=!1;else d=!1;return d},TIFF:function(){return h},EXIF:function(){var a;if(a=c(e.exifIFD,b.exif),a.ExifVersion&&"array"===f.typeOf(a.ExifVersion)){for(var d=0,g="";d<a.ExifVersion.length;d++)g+=String.fromCharCode(a.ExifVersion[d]);a.ExifVersion=g}return a},GPS:function(){var a;return a=c(e.gpsIFD,b.gps),
        a.GPSVersionID&&"array"===f.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join(".")),a},setExif:function(c,d){var f;if("PixelXDimension"!==c&&"PixelYDimension"!==c)f=!1;else{f=c;var g,h,l,n=0;if("string"==typeof f)for(h in g=b.exif,g)if(g[h]===f){f=h;break}g=e.exifIFD;h=a.SHORT(g);for(var t=0;h>t;t++)if(l=g+12*t+2,a.SHORT(l)==f){n=l+8;break}f=n?(a.LONG(n,d),!0):!1}return f},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null);a=h=null;e={}}}}});n("moxie/runtime/html5/image/JPEG",
        ["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(f,d,c,a,b){return function(h){var e,g,k,l,p,q;if(e=h,g=new a,g.init(e),65496!==g.SHORT(0))throw new d.ImageError(d.ImageError.WRONG_FORMAT);k=new c(h);l=new b;q=!!l.init(k.get("app1")[0]);p=function(){for(var a=0,b,c;a<=e.length;){if(b=g.SHORT(a+=2),65472<=b&&65475>=b)return a+=5,{height:g.SHORT(a),width:g.SHORT(a+2)};c=
            g.SHORT(a+=2);a+=c-2}return null}.call(this);f.extend(this,{type:"image/jpeg",size:e.length,width:p&&p.width||0,height:p&&p.height||0,setExif:function(a,b){return q?("object"===f.typeOf(a)?f.each(a,function(a,b){l.setExif(b,a)}):l.setExif(a,b),k.set("app1",l.getBinary()),void 0):!1},writeHeaders:function(){return arguments.length?k.restore(arguments[0]):e=k.restore(e)},stripHeaders:function(a){return k.strip(a)},purge:function(){l&&k&&g&&(l.purge(),k.purge(),g.init(null),e=p=k=l=g=null)}});q&&(this.meta=
        {tiff:l.TIFF(),exif:l.EXIF(),gps:l.GPS()})}});n("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(f,d,c){return function(a){function b(){e&&(e.init(null),h=g=e=null)}var h,e,g;h=a;e=new c;e.init(h);(function(){for(var a=0,b=0,c=[35152,20039,3338,6666],b=0;b<c.length;b++,a+=2)if(c[b]!=e.SHORT(a))throw new f.ImageError(f.ImageError.WRONG_FORMAT);})();g=function(){var a,b,c=8,d,f,g,h;return a=(d=e.LONG(c),f=e.STRING(c+=
        4,4),g=c+=4,h=e.LONG(c+d),{length:d,type:f,start:g,CRC:h}),"IHDR"==a.type?(b=a.start,{width:e.LONG(b),height:e.LONG(b+4)}):null}.call(this);d.extend(this,{type:"image/png",size:h.length,width:g.width,height:g.height,purge:function(){b.call(this)}});b.call(this)}});n("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(f,d,c,a){return function(b){var h=[c,a],e;e=function(){for(var a=0;a<h.length;a++)try{return new h[a](b)}catch(c){}throw new d.ImageError(d.ImageError.WRONG_FORMAT);
    }();f.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){}});f.extend(this,e);this.purge=function(){e.purge();e=null}}});n("moxie/runtime/html5/image/MegaPixel",[],function(){function f(d){var c=d.naturalWidth;if(1048576<c*d.naturalHeight){var a=document.createElement("canvas");a.width=a.height=1;a=a.getContext("2d");return a.drawImage(d,-c+1,0),0===a.getImageData(0,0,1,1).data[3]}return!1}return{isSubsampled:f,
        renderTo:function(d,c,a){var b=d.naturalWidth,h=d.naturalHeight,e=a.width,g=a.height,k=a.x||0;a=a.y||0;c=c.getContext("2d");f(d)&&(b/=2,h/=2);var l=document.createElement("canvas");l.width=l.height=1024;var p=l.getContext("2d"),q;q=h;var n=document.createElement("canvas");n.width=1;n.height=q;n=n.getContext("2d");n.drawImage(d,0,0);for(var n=n.getImageData(0,0,1,q).data,m=0,u=q,t=q;t>m;)0===n[4*(t-1)+3]?u=t:m=t,t=u+m>>1;q=t/q;q=0===q?1:q;for(n=0;h>n;){m=n+1024>h?h-n:1024;for(u=0;b>u;){t=u+1024>b?
            b-u:1024;p.clearRect(0,0,1024,1024);p.drawImage(d,-u,-n);var v=u*e/b+k<<0,x=Math.ceil(t*e/b),w=n*g/h/q+a<<0,C=Math.ceil(m*g/h/q);c.drawImage(l,0,0,t,m,v,w,x,C);u+=1024}n+=1024}}}});n("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/MegaPixel moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h,e,g,k){return f.Image=
        function(){function f(){if(!w&&!v)throw new c.ImageError(c.DOMException.INVALID_STATE_ERR);return w||v}function p(b){return a.atob(b.substring(b.indexOf("base64,")+7))}function l(b){var d=this;v=new Image;v.onerror=function(){u.call(this);d.trigger("error",new c.ImageError(c.ImageError.WRONG_FORMAT))};v.onload=function(){d.trigger("load")};v.src=/^data:[^;]*;base64,/.test(b)?b:"data:"+(A.type||"")+";base64,"+a.btoa(b)}function n(a,b){var d=this,e;return window.FileReader?(e=new FileReader,e.onload=
            function(){b(this.result)},e.onerror=function(){d.trigger("error",new c.FileException(c.FileException.NOT_READABLE_ERR))},e.readAsDataURL(a),void 0):b(a.getAsDataURL())}function m(a,b,c,g){var h,p=0,l=0,q,m;if(D=g,m=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==d.inArray(m,[5,6,7,8]))q=a,a=b,b=q;q=f();h=(c?Math.max:Math.min)(a/q.width,b/q.height);if(1<h&&(!c||g))l=(this.trigger("Resize"),void 0);else{w||(w=document.createElement("canvas"));g=Math.round(q.width*h);h=Math.round(q.height*
            h);c?(w.width=a,w.height=b,g>a&&(p=Math.round((g-a)/2)),h>b&&(l=Math.round((h-b)/2))):(w.width=g,w.height=h);if(!D){a=w.width;b=w.height;switch(m){case 5:case 6:case 7:case 8:w.width=b;w.height=a;break;default:w.width=a,w.height=b}c=w.getContext("2d");switch(m){case 2:c.translate(a,0);c.scale(-1,1);break;case 3:c.translate(a,b);c.rotate(Math.PI);break;case 4:c.translate(0,b);c.scale(1,-1);break;case 5:c.rotate(.5*Math.PI);c.scale(1,-1);break;case 6:c.rotate(.5*Math.PI);c.translate(0,-b);break;case 7:c.rotate(.5*
            Math.PI);c.translate(a,-b);c.scale(-1,1);break;case 8:c.rotate(-.5*Math.PI),c.translate(-a,0)}}m=w;p=-p;l=-l;"iOS"===k.OS?e.renderTo(q,m,{width:g,height:h,x:p,y:l}):m.getContext("2d").drawImage(q,p,l,g,h);l=(this.width=w.width,this.height=w.height,z=!0,this.trigger("Resize"),void 0)}return l}function u(){x&&(x.purge(),x=null);C=v=w=A=null;z=!1}var t=this,v,x,w,C,A,z=!1,D=!0;d.extend(this,{loadFromBlob:function(a){var b=this,d=b.getRuntime(),e=1<arguments.length?arguments[1]:!0;if(!d.can("access_binary"))throw new c.RuntimeError(c.RuntimeError.NOT_SUPPORTED_ERR);
            return A=a,a.isDetached()?(C=a.getSource(),l.call(this,C),void 0):(n.call(this,a.getSource(),function(a){e&&(C=p(a));l.call(b,a)}),void 0)},loadFromImage:function(a,c){this.meta=a.meta;A=new b(null,{name:a.name,size:a.size,type:a.type});l.call(this,c?C=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var a=this.getRuntime();return!x&&C&&a.can("access_image_binary")&&(x=new h(C)),{width:f().width||0,height:f().height||0,type:A.type||g.getFileMime(A.name),size:C&&C.length||A.size||0,name:A.name||
            "",meta:x&&x.meta||this.meta||{}}},downsize:function(){m.apply(this,arguments)},getAsCanvas:function(){return w&&(w.id=this.uid+"_canvas"),w},getAsBlob:function(a,c){return a!==this.type&&m.call(this,this.width,this.height,!1),new b(null,{name:A.name||"",type:a,data:t.getAsBinaryString.call(this,a,c)})},getAsDataURL:function(a,b){var c=b||90;if(!z)return v.src;if("image/jpeg"!==a)return w.toDataURL("image/png");try{return w.toDataURL("image/jpeg",c/100)}catch(d){return w.toDataURL("image/jpeg")}},
            getAsBinaryString:function(a,b){if(!z)return C||(C=p(t.getAsDataURL(a,b))),C;if("image/jpeg"!==a)C=p(t.getAsDataURL(a,b));else{var c;b||(b=90);try{c=w.toDataURL("image/jpeg",b/100)}catch(d){c=w.toDataURL("image/jpeg")}C=p(c);x&&(C=x.stripHeaders(C),D&&(x.meta&&x.meta.exif&&x.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),C=x.writeHeaders(C)),x.purge(),x=null)}return z=!1,C},destroy:function(){t=null;u.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});n("moxie/runtime/flash/Runtime",
        ["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,d,c,a,b){function h(){var a;try{a=navigator.plugins["Shockwave Flash"],a=a.description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(c){a="0.0"}}return a=a.match(/\d+/g),parseFloat(a[0]+"."+a[1])}var e={};return b.addConstructor("flash",function(g){var k=this,l;g=f.extend({swf_url:d.swf_url},g);b.call(this,g,"flash",
            {access_binary:function(a){return a&&"browser"===k.mode},access_image_binary:function(a){return a&&"browser"===k.mode},display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===k.mode},resize_image:b.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!f.arrayDiff(a,["","text","document"])||"browser"===k.mode},return_status_code:function(a){return"browser"===k.mode||!f.arrayDiff(a,[200,404])},select_file:b.capTrue,
                select_multiple:b.capTrue,send_binary_string:function(a){return a&&"browser"===k.mode},send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"browser"===k.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:function(a){return a&&"browser"===k.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=f.parseSizeStr(a)||"client"===k.mode},use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?
                "browser":"client"},access_image_binary:function(a){return a?"browser":"client"},report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return f.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return f.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
                "browser":"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=f.parseSizeStr(a)?"client":"browser"}},"client");10>h()&&(this.mode=!1);f.extend(this,{getShim:function(){return c.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){var b,c,e;e=this.getShimContainer();f.extend(e.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});
            b='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+g.swf_url+'" ';"IE"===d.browser&&(b+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');b+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+g.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+d.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';"IE"===d.browser?(c=document.createElement("div"),
                e.appendChild(c),c.outerHTML=b,c=e=null):e.innerHTML=b;l=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(l);g=l=a=k=null}}(this.destroy)},e)}),e});n("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,d){return f.Blob={slice:function(c,a,b,f){var e=this.getRuntime();return 0>a?a=Math.max(c.size+a,0):0<a&&(a=Math.min(a,c.size)),0>b?
        b=Math.max(c.size+b,0):0<b&&(b=Math.min(b,c.size)),c=e.shimExec.call(this,"Blob","slice",a,b,f||""),c&&(c=new d(e.uid,c)),c}}});n("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime"],function(f){return f.FileInput={init:function(d){this.getRuntime().shimExec.call(this,"FileInput","init",{name:d.name,accept:d.accept,multiple:d.multiple});this.trigger("ready")}}});n("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(f,d){function c(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                c){switch(c){case "readAsText":return d.atob(a,"utf8");case "readAsBinaryString":return d.atob(a);case "readAsDataURL":return a}return null}var a="";return f.FileReader={read:function(b,d){var e=this.getRuntime();return"readAsDataURL"===b&&(a="data:"+(d.type||"")+";base64,"),this.bind("Progress",function(d,e){e&&(a+=c(e,b))}),e.shimExec.call(this,"FileReader","readAsBase64",d.uid)},getResult:function(){return a},destroy:function(){a=null}}});n("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime",
        "moxie/core/utils/Encode"],function(f,d){function c(a,b){switch(b){case "readAsText":return d.atob(a,"utf8");case "readAsBinaryString":return d.atob(a);case "readAsDataURL":return a}return null}return f.FileReaderSync={read:function(a,b){var d;return(d=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",b.uid))?("readAsDataURL"===a&&(d="data:"+(b.type||"")+";base64,"+d),c(d,a,b.type)):null}}});n("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter".split(" "),
        function(f,d,c,a,b,h,e){return f.XMLHttpRequest={send:function(a,b){function f(){a.transport=m.mode;m.shimExec.call(n,"XMLHttpRequest","send",a,b)}function l(a,c){m.shimExec.call(n,"XMLHttpRequest","appendBlob",a,c.uid);b=null;f()}function q(a,b){var c=new e;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:m.uid})}var n=this,m=n.getRuntime();if(d.isEmptyObj(a.headers)||d.each(a.headers,function(a,b){m.shimExec.call(n,"XMLHttpRequest","setRequestHeader",
            b,a.toString())}),b instanceof h){var u;if(b.each(function(a,b){a instanceof c?u=b:m.shimExec.call(n,"XMLHttpRequest","append",b,a)}),b.hasBlob()){var t=b.getBlob();t.isDetached()?q(t,function(a){t.destroy();l(u,a)}):l(u,t)}else b=null,f()}else b instanceof c?b.isDetached()?q(b,function(a){b.destroy();b=a.uid;f()}):(b=b.uid,f()):f()},getResponse:function(c){var e,f,h=this.getRuntime();if(f=h.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(f=new a(h.uid,f),"blob"===c)return f;try{if(e=
            new b,~d.inArray(c,["","text"]))return e.readAsText(f);if("json"===c&&window.JSON)return JSON.parse(e.readAsText(f))}finally{f.destroy()}}return null},abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});n("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(f,d){return f.Transporter={getAsBlob:function(c){var a=this.getRuntime();return(c=a.shimExec.call(this,
        "Transporter","getAsBlob",c))?new d(a.uid,c):null}}});n("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(f,d,c,a,b){return f.Image={loadFromBlob:function(a){function b(a){f.shimExec.call(d,"Image","loadFromBlob",a.uid);d=f=null}var d=this,f=d.getRuntime();if(a.isDetached()){var l=new c;l.bind("TransportingComplete",function(){b(l.result.getSource())});l.transport(a.getSource(),
        a.type,{ruid:f.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getAsBlob:function(b,c){var d=this.getRuntime(),f=d.shimExec.call(this,"Image","getAsBlob",b,c);return f?new a(d.uid,f):null},getAsDataURL:function(){var a=this.getRuntime().Image.getAsBlob.apply(this,arguments),c;return a?(c=new b,c.readAsDataURL(a)):null}}});n("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom",
        "moxie/core/Exceptions","moxie/runtime/Runtime"],function(f,d,c,a,b){function h(a){var b=!1,c=null,d,e,f,h,l,n=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=!0)}catch(v){var x=navigator.plugins["Silverlight Plug-In"];if(x){d=x.description;"1.0.30226.2"===d&&(d="2.0.30226.2");for(e=d.split(".");3<e.length;)e.pop();for(;4>e.length;)e.push(0);for(f=a.split(".");4<f.length;)f.pop();do h=parseInt(f[n],10),l=parseInt(e[n],10),n++;while(n<f.length&&h===l);l>=h&&!isNaN(h)&&
    (b=!0)}}}catch(u){b=!1}return b}var e={};return b.addConstructor("silverlight",function(g){var k=this,l;g=f.extend({xap_url:d.xap_url},g);b.call(this,g,"silverlight",{access_binary:b.capTrue,access_image_binary:b.capTrue,display_media:b.capTrue,do_cors:b.capTrue,drag_and_drop:!1,report_upload_progress:b.capTrue,resize_image:b.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===
        k.mode||!f.arrayDiff(a,[200,404])},select_file:b.capTrue,select_multiple:b.capTrue,send_binary_string:b.capTrue,send_browser_cookies:function(a){return a&&"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:b.capTrue,slice_blob:b.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:b.capTrue,use_http_method:function(a){return"client"===k.mode||!f.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return f.arrayDiff(a,
        [200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"client":"browser"},use_http_method:function(a){return f.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});h("2.0.31005.0")&&"Opera"!==d.browser||(this.mode=!1);f.extend(this,{getShim:function(){return c.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML=
        '<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+g.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+d.global_event_dispatcher+'"/></object>';l=setTimeout(function(){k&&!k.initialized&&k.trigger("Error",new a.RuntimeError(a.RuntimeError.NOT_INIT_ERR))},
            "Windows"!==d.OS?1E4:5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(l);g=l=a=k=null}}(this.destroy)},e)}),e});n("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(f,d,c){return f.Blob=d.extend({},c)});n("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime"],function(f){return f.FileInput={init:function(d){this.getRuntime().shimExec.call(this,"FileInput","init",function(c){for(var a=
        "",b=0;b<c.length;b++)a+=(""!==a?"|":"")+c[b].title+" | *."+c[b].extensions.replace(/,/g,";*.");return a}(d.accept),d.name,d.multiple);this.trigger("ready")}}});n("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(f,d,c){return f.FileDrop={init:function(){var a=this.getRuntime(),b;return b=a.getShimContainer(),c.addEvent(b,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect="copy"},
        this.uid),c.addEvent(b,"dragenter",function(b){b.preventDefault();d.get(a.uid).dragEnter(b)&&b.stopPropagation()},this.uid),c.addEvent(b,"drop",function(b){b.preventDefault();d.get(a.uid).dragDrop(b)&&b.stopPropagation()},this.uid),a.shimExec.call(this,"FileDrop","init")}}});n("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(f,d,c){return f.FileReader=d.extend({},c)});n("moxie/runtime/silverlight/file/FileReaderSync",
        ["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(f,d,c){return f.FileReaderSync=d.extend({},c)});n("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest"],function(f,d,c){return f.XMLHttpRequest=d.extend({},c)});n("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],
        function(f,d,c){return f.Transporter=d.extend({},c)});n("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/image/Image"],function(f,d,c){return f.Image=d.extend({},c,{getInfo:function(){var a=["tiff","exif","gps"],b={meta:{}},c=this.getRuntime().shimExec.call(this,"Image","getInfo");return c.meta&&d.each(a,function(a){var d=c.meta[a],f,l,p,q;if(d&&d.keys)for(b.meta[a]={},l=0,p=d.keys.length;p>l;l++)f=d.keys[l],(q=d[f])&&(/^(\d|[1-9]\d+)$/.test(q)?
        q=parseInt(q,10):/^\d*\.\d+$/.test(q)&&(q=parseFloat(q)),b.meta[a][f]=q)}),b.width=parseInt(c.width,10),b.height=parseInt(c.height,10),b.size=parseInt(c.size,10),b.type=c.type,b.name=c.name,b}})});n("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(f,d,c,a){var b={};return c.addConstructor("html4",function(d){var e=this,g=c.capTest,k=c.capTrue;c.call(this,d,"html4",{access_binary:g(window.FileReader||window.File&&
        File.getAsDataURL),access_image_binary:!1,display_media:g(b.Image&&(a.can("create_canvas")||a.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:g("Chrome"===a.browser&&28<=a.version||"IE"===a.browser&&10<=a.version),resize_image:function(){return b.Image&&e.can("access_binary")&&a.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~f.inArray(a,["text","document",""])},return_status_code:function(a){return!f.arrayDiff(a,
        [200,404])},select_file:function(){return a.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can("select_file")},summon_file_dialog:g("Firefox"===a.browser&&4<=a.version||"Opera"===a.browser&&12<=a.version||!!~f.inArray(a.browser,["Chrome","Safari"])),upload_filesize:k,use_http_method:function(a){return!f.arrayDiff(a,["GET","POST"])}});f.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e);
        a=e=null}}(this.destroy)});f.extend(this.getShim(),b)}),b});n("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(f,d,c,a,b,h){return f.FileInput=function(){function e(){var b=this,n=b.getRuntime(),m,u,t,v,x,w;w=d.guid("uid_");m=n.getShimContainer();f&&(t=c.get(f+"_form"),t&&d.extend(t.style,{top:"100%"}));v=document.createElement("form");v.setAttribute("id",
            w+"_form");v.setAttribute("method","post");v.setAttribute("enctype","multipart/form-data");v.setAttribute("encoding","multipart/form-data");d.extend(v.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});x=document.createElement("input");x.setAttribute("id",w);x.setAttribute("type","file");x.setAttribute("name",p.name||"Filedata");x.setAttribute("accept",l.join(","));d.extend(x.style,{fontSize:"999px",opacity:0});v.appendChild(x);m.appendChild(v);d.extend(x.style,
        {position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===h.browser&&10>h.version&&d.extend(x.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});x.onchange=function(){var a;this.value&&(a=this.files?this.files[0]:{name:this.value},k=[a],this.onchange=function(){},e.call(b),b.bind("change",function z(){var a=c.get(w),d=c.get(w+"_form"),e;b.unbind("change",z);b.files.length&&a&&d&&(e=b.files[0],a.setAttribute("id",e.uid),d.setAttribute("id",e.uid+"_form"),d.setAttribute("target",
            e.uid+"_iframe"))},998),x=v=null,b.trigger("change"))};n.can("summon_file_dialog")&&(u=c.get(p.browse_button),a.removeEvent(u,"click",b.uid),a.addEvent(u,"click",function(a){x&&!x.disabled&&x.click();a.preventDefault()},b.uid));f=w;m=t=u=null}var f,k=[],l=[],p;d.extend(this,{init:function(d){var f=this,g=f.getRuntime(),h;p=d;l=d.accept.mimes||b.extList2mimes(d.accept,g.can("filter_by_extension"));h=g.getShimContainer();(function(){var b,e;b=c.get(d.browse_button);g.can("summon_file_dialog")&&("static"===
        c.getStyle(b,"position")&&(b.style.position="relative"),e=parseInt(c.getStyle(b,"z-index"),10)||1,b.style.zIndex=e,h.style.zIndex=e-1);b=g.can("summon_file_dialog")?b:h;a.addEvent(b,"mouseover",function(){f.trigger("mouseenter")},f.uid);a.addEvent(b,"mouseout",function(){f.trigger("mouseleave")},f.uid);a.addEvent(b,"mousedown",function(){f.trigger("mousedown")},f.uid);a.addEvent(c.get(d.container),"mouseup",function(){f.trigger("mouseup")},f.uid);b=null})();e.call(this);h=null;f.trigger({type:"ready",
        async:!0})},getFiles:function(){return k},disable:function(a){var b;(b=c.get(f))&&(b.disabled=!!a)},destroy:function(){var b=this.getRuntime(),d=b.getShim(),b=b.getShimContainer();a.removeAllEvents(b,this.uid);a.removeAllEvents(p&&c.get(p.container),this.uid);a.removeAllEvents(p&&c.get(p.browse_button),this.uid);b&&(b.innerHTML="");d.removeInstance(this.uid);f=k=l=p=null}})}});n("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(f,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           d){return f.FileReader=d});n("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),function(f,d,c,a,b,h,e,g){return f.XMLHttpRequest=function(){function f(a){var b=this,d,e,g,k=!1;if(q){if(d=q.id.replace(/_iframe$/,""),e=c.get(d+"_form")){d=e.getElementsByTagName("input");for(g=d.length;g--;)switch(d[g].getAttribute("type")){case "hidden":d[g].parentNode.removeChild(d[g]);
        break;case "file":k=!0}d=[];k||e.parentNode.removeChild(e);e=null}setTimeout(function(){h.removeEvent(q,"load",b.uid);q.parentNode&&q.parentNode.removeChild(q);var c=b.getRuntime().getShimContainer();c.children.length||c.parentNode.removeChild(c);q=null;a()},1)}}var l,p,q;d.extend(this,{send:function(n,m){var u=this,t=u.getRuntime(),v,x,w,A;if(l=p=null,m instanceof g&&m.hasBlob()){if(A=m.getBlob(),v=A.uid,w=c.get(v),x=c.get(v+"_form"),!x)throw new b.DOMException(b.DOMException.NOT_FOUND_ERR);}else v=
        d.guid("uid_"),x=document.createElement("form"),x.setAttribute("id",v+"_form"),x.setAttribute("method",n.method),x.setAttribute("enctype","multipart/form-data"),x.setAttribute("encoding","multipart/form-data"),x.setAttribute("target",v+"_iframe"),t.getShimContainer().appendChild(x);m instanceof g&&m.each(function(a,b){if(a instanceof e)w&&w.setAttribute("name",b);else{var c=document.createElement("input");d.extend(c,{type:"hidden",name:b,value:a});w?x.insertBefore(c,w):x.appendChild(c)}});x.setAttribute("action",
        n.url);(function(){var b=t.getShimContainer()||document.body,c=document.createElement("div");c.innerHTML='<iframe id="'+v+'_iframe" name="'+v+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';q=c.firstChild;b.appendChild(q);h.addEvent(q,"load",function(){var b;try{b=q.contentWindow.document||q.contentDocument||window.frames[q.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(b.title)?l=b.title.replace(/^(\d+).*$/,"$1"):(l=200,p=d.trim(b.body.innerHTML),u.trigger({type:"progress",
        loaded:p.length,total:p.length}),A&&u.trigger({type:"uploadprogress",loaded:A.size||1025,total:A.size||1025}))}catch(c){if(!a.hasSameOrigin(n.url))return f.call(u,function(){u.trigger("error")}),void 0;l=404}f.call(u,function(){u.trigger("load")})},u.uid)})();x.submit();u.trigger("loadstart")},getStatus:function(){return l},getResponse:function(a){if("json"===a&&"string"===d.typeOf(p)&&window.JSON)try{return JSON.parse(p.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(b){return null}return p},
        abort:function(){var a=this;q&&q.contentWindow&&(q.contentWindow.stop?q.contentWindow.stop():q.contentWindow.document.execCommand?q.contentWindow.document.execCommand("Stop"):q.src="about:blank");f.call(this,function(){a.dispatchEvent("abort")})}})}});n("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(f,d){return f.Image=d});(function(f){for(var d=0;d<f.length;d++){for(var c=A,a=f[d],b=a.split(/[.\/]/),h=0;h<b.length-1;++h)c[b[h]]===l&&(c[b[h]]=
    {}),c=c[b[h]];c[b[b.length-1]]=u[a]}})("moxie/core/utils/Basic moxie/core/I18n moxie/core/utils/Mime moxie/core/utils/Env moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/file/File moxie/file/FileInput moxie/file/FileDrop moxie/runtime/RuntimeTarget moxie/file/FileReader moxie/core/utils/Url moxie/file/FileReaderSync moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/runtime/Transporter moxie/image/Image moxie/core/utils/Events".split(" "))}(this);
(function(){var A={},l=moxie.core.utils.Basic.inArray;return function n(u){var f,d;for(f in u)d=typeof u[f],"object"!==d||~l(f,["Exceptions","Env","Mime"])?"function"===d&&(A[f]=u[f]):n(u[f])}(window.moxie),A.Env=window.moxie.core.utils.Env,A.Mime=window.moxie.core.utils.Mime,A.Exceptions=window.moxie.core.Exceptions,window.mOxie=A,window.o||(window.o=A),A})();
(function(A,l,w){function n(c){function a(a,b,c){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};d[a]?f[d[a]]=b:c||(f[a]=b)}var b=c.required_features,f={};return"string"==typeof b?d.each(b.split(/\s*,\s*/),function(b){a(b,!0)}):"object"==typeof b?
    d.each(b,function(b,c){a(c,b)}):!0===b&&(c.multipart||(f.send_binary_string=!0),0<c.chunk_size&&(f.slice_blob=!0),c.resize.enabled&&(f.send_binary_string=!0),d.each(c,function(b,c){a(c,!!b,!0)})),f}var u=A.setTimeout,f={},d={VERSION:"2.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,
    IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:l.mimes,ua:l.ua,typeOf:l.typeOf,extend:l.extend,guid:l.guid,get:function(c){var a=[],b;"array"!==l.typeOf(c)&&(c=[c]);for(var d=c.length;d--;)(b=l.get(c[d]))&&a.push(b);return a.length?a:null},each:l.each,getPos:l.getPos,getSize:l.getSize,xmlEncode:function(c){var a={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},b=/[<>&\"\']/g;return c?(""+c).replace(b,function(b){return a[b]?"&"+a[b]+";":b}):c},toArray:l.toArray,inArray:l.inArray,addI18n:l.addI18n,translate:l.translate,
    isEmptyObj:l.isEmptyObj,hasClass:l.hasClass,addClass:l.addClass,removeClass:l.removeClass,getStyle:l.getStyle,addEvent:l.addEvent,removeEvent:l.removeEvent,removeAllEvents:l.removeAllEvents,cleanName:function(c){var a,b;b=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(a=0;a<b.length;a+=2)c=c.replace(b[a],
        b[a+1]);return c=c.replace(/\s+/g,"_"),c=c.replace(/[^a-z0-9_\-\.]+/gi,""),c},buildUrl:function(c,a){var b="";return d.each(a,function(a,c){b+=(b?"&":"")+encodeURIComponent(c)+"="+encodeURIComponent(a)}),b&&(c+=(0<c.indexOf("?")?"&":"?")+b),c},formatSize:function(c){function a(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}if(c===w||/\D/.test(c))return d.translate("N/A");var b=Math.pow(1024,4);return c>b?a(c/b,1)+" "+d.translate("tb"):c>(b/=1024)?a(c/b,1)+" "+d.translate("gb"):c>(b/=1024)?
        a(c/b,1)+" "+d.translate("mb"):1024<c?Math.round(c/1024)+" "+d.translate("kb"):c+" "+d.translate("b")},parseSize:l.parseSizeStr,predictRuntime:function(c,a){var b,f;return b=new d.Uploader(c),f=l.Runtime.thatCan(b.getOption().required_features,a||c.runtimes),b.destroy(),f},addFileFilter:function(c,a){f[c]=a}};d.addFileFilter("mime_types",function(c,a,b){c.length&&!c.regexp.test(a.name)?(this.trigger("Error",{code:d.FILE_EXTENSION_ERROR,message:d.translate("File extension error."),file:a}),b(!1)):
    b(!0)});d.addFileFilter("max_file_size",function(c,a,b){c=d.parseSize(c);void 0!==a.size&&c&&a.size>c?(this.trigger("Error",{code:d.FILE_SIZE_ERROR,message:d.translate("File size error."),file:a}),b(!1)):b(!0)});d.addFileFilter("prevent_duplicates",function(c,a,b){if(c)for(c=this.files.length;c--;)if(a.name===this.files[c].name&&a.size===this.files[c].size){this.trigger("Error",{code:d.FILE_DUPLICATE_ERROR,message:d.translate("Duplicate file error."),file:a});b(!1);return}b(!0)});d.Uploader=function(c){function a(){var a,
    b=0,c;if(this.state==d.STARTED){for(c=0;c<D.length;c++)a||D[c].status!=d.QUEUED?b++:(a=D[c],this.trigger("BeforeUpload",a)&&(a.status=d.UPLOADING,this.trigger("UploadFile",a)));b==D.length&&(this.state!==d.STOPPED&&(this.state=d.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",D))}}function b(a){a.percent=0<a.size?Math.ceil(a.loaded/a.size*100):100;h()}function h(){var a,b;E.reset();for(a=0;a<D.length;a++)b=D[a],b.size!==w?(E.size+=b.origSize,E.loaded+=b.loaded*b.origSize/b.size):
    E.size=w,b.status==d.DONE?E.uploaded++:b.status==d.FAILED?E.failed++:E.queued++;E.size===w?E.percent=0<D.length?Math.ceil(E.uploaded/D.length*100):0:(E.bytesPerSec=Math.ceil(E.loaded/((+new Date-T||1)/1E3)),E.percent=0<E.size?Math.ceil(E.loaded/E.size*100):0)}function e(){var a=J[0]||U[0];return a?a.getRuntime().uid:!1}function g(a,b){if(a.ruid){var c=l.Runtime.getInfo(a.ruid);if(c)return c.can(b)}return!1}function k(a,b){var c=this,e=0,f=[],g={accept:a.filters.mime_types,runtime_order:a.runtimes,
    required_caps:a.required_features,preferred_caps:I,swf_url:a.flash_swf_url,xap_url:a.silverlight_xap_url};d.each(a.runtimes.split(/\s*,\s*/),function(b){a[b]&&(g[b]=a[b])});a.browse_button&&d.each(a.browse_button,function(b){f.push(function(f){var h=new l.FileInput(d.extend({},g,{name:a.file_data_name,multiple:a.multi_selection,container:a.container,browse_button:b}));h.onready=function(){var a=l.Runtime.getInfo(this.ruid);l.extend(c.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),
    multi_selection:a.can("select_multiple")});e++;J.push(this);f()};h.onchange=function(){c.addFile(this.files)};h.bind("mouseenter mouseleave mousedown mouseup",function(c){N||(a.browse_button_hover&&("mouseenter"===c.type?l.addClass(b,a.browse_button_hover):"mouseleave"===c.type&&l.removeClass(b,a.browse_button_hover)),a.browse_button_active&&("mousedown"===c.type?l.addClass(b,a.browse_button_active):"mouseup"===c.type&&l.removeClass(b,a.browse_button_active)))});h.bind("error runtimeerror",function(){h=
    null;f()});h.init()})});a.drop_element&&d.each(a.drop_element,function(a){f.push(function(b){var f=new l.FileDrop(d.extend({},g,{drop_zone:a}));f.onready=function(){var a=l.Runtime.getInfo(this.ruid);c.features.dragdrop=a.can("drag_and_drop");e++;U.push(this);b()};f.ondrop=function(){c.addFile(this.files)};f.bind("error runtimeerror",function(){f=null;b()});f.init()})});l.inSeries(f,function(){"function"==typeof b&&b(e)})}function r(a,b,c){var d=new l.Image;try{d.onload=function(){d.downsize(b.width,
    b.height,b.crop,b.preserve_headers)},d.onresize=function(){c(this.getAsBlob(a.type,b.quality));this.destroy()},d.onerror=function(){c(a)},d.load(a)}catch(e){c(a)}}function p(a,b,c){function f(a,b,c){var e=z[a];switch(a){case "max_file_size":"max_file_size"===a&&(z.max_file_size=z.filters.max_file_size=b);break;case "chunk_size":if(b=d.parseSize(b))z[a]=b;break;case "filters":"array"===d.typeOf(b)&&(b={mime_types:b});c?d.extend(z.filters,b):z.filters=b;b.mime_types&&(z.filters.mime_types.regexp=function(a){var b=
    [];return d.each(a,function(a){d.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+b.join("|")+")$","i")}(z.filters.mime_types));break;case "resize":c?d.extend(z.resize,b,{enabled:!0}):z.resize=b;break;case "prevent_duplicates":z.prevent_duplicates=z.filters.prevent_duplicates=!!b;break;case "browse_button":case "drop_element":b=d.get(b);case "container":case "runtimes":case "multi_selection":case "flash_swf_url":case "silverlight_xap_url":z[a]=
    b;c||(h=!0);break;default:z[a]=b}c||g.trigger("OptionChanged",a,b,e)}var g=this,h=!1;"object"==typeof a?d.each(a,function(a,b){f(b,a,c)}):f(a,b,c);c?(z.required_features=n(d.extend({},z)),I=n(d.extend({},z,{required_features:!0}))):h&&(g.trigger("Destroy"),k.call(g,z,function(a){a?(g.runtime=l.Runtime.getInfo(e()).type,g.trigger("Init",{runtime:g.runtime}),g.trigger("PostInit")):g.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})}))}function q(a,b){[].push.apply(D,b);a.trigger("QueueChanged");
    a.refresh()}function y(a,b){if(z.unique_names){var c=b.name.match(/\.([^.]+)$/),d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function m(a,b){function c(){0<k--?u(e,1E3):(b.loaded=m,a.trigger("Error",{code:d.HTTP_ERROR,message:d.translate("HTTP Error."),file:b,response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()}))}function e(){var g,n,r,t;b.status!=d.DONE&&b.status!=d.FAILED&&a.state!=d.STOPPED&&(r={name:b.target_name||b.name},h&&p.chunks&&q.size>h?(t=Math.min(h,q.size-
    m),g=q.slice(m,m+t)):(t=q.size,g=q),h&&p.chunks&&(a.settings.send_chunk_number?(r.chunk=Math.ceil(m/h),r.chunks=Math.ceil(q.size/h)):(r.offset=m,r.total=q.size)),B=new l.XMLHttpRequest,B.upload&&(B.upload.onprogress=function(c){b.loaded=Math.min(b.size,m+c.loaded);a.trigger("UploadProgress",b)}),B.onload=function(){400<=B.status?c():(k=a.settings.max_retries,t<q.size?(g.destroy(),m+=t,b.loaded=Math.min(m,q.size),a.trigger("ChunkUploaded",b,{offset:b.loaded,total:q.size,response:B.responseText,status:B.status,
    responseHeaders:B.getAllResponseHeaders()}),"Android Browser"===l.Env.browser&&a.trigger("UploadProgress",b)):b.loaded=b.size,g=n=null,!m||m>=q.size?(b.size!=b.origSize&&(q.destroy(),q=null),a.trigger("UploadProgress",b),b.status=d.DONE,a.trigger("FileUploaded",b,{response:B.responseText,status:B.status,responseHeaders:B.getAllResponseHeaders()})):u(e,1))},B.onerror=function(){c()},B.onloadend=function(){this.destroy();B=null},a.settings.multipart&&p.multipart?(r.name=b.target_name||b.name,B.open("post",
    f,!0),d.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),n=new l.FormData,d.each(d.extend(r,a.settings.multipart_params),function(a,b){n.append(b,a)}),n.append(a.settings.file_data_name,g),B.send(n,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:I,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})):(f=d.buildUrl(a.settings.url,d.extend(r,a.settings.multipart_params)),B.open("post",f,!0),B.setRequestHeader("Content-Type",
    "application/octet-stream"),d.each(a.settings.headers,function(a,b){B.setRequestHeader(b,a)}),B.send(g,{runtime_order:a.settings.runtimes,required_caps:a.settings.required_features,preferred_caps:I,swf_url:a.settings.flash_swf_url,xap_url:a.settings.silverlight_xap_url})))}var f=a.settings.url,h=a.settings.chunk_size,k=a.settings.max_retries,p=a.features,m=0,q;b.loaded&&(m=b.loaded=h*Math.floor(b.loaded/h));q=b.getSource();a.settings.resize.enabled&&g(q,"send_binary_string")&&~l.inArray(q.type,["image/jpeg",
    "image/png"])?r.call(this,q,a.settings.resize,function(a){q=a;b.size=a.size;e()}):e()}function A(a,c){b(c)}function t(a){if(a.state==d.STARTED)T=+new Date;else if(a.state==d.STOPPED)for(var b=a.files.length-1;0<=b;b--)a.files[b].status==d.UPLOADING&&(a.files[b].status=d.QUEUED,h())}function v(){B&&B.abort()}function x(b){h();u(function(){a.call(b)},1)}function M(c,e){e.file&&(e.file.status=d.FAILED,b(e.file),c.state==d.STARTED&&(c.trigger("CancelUpload"),u(function(){a.call(c)},1)))}function C(a){a.stop();
    d.each(D,function(a){a.destroy()});D=[];J.length&&(d.each(J,function(a){a.destroy()}),J=[]);U.length&&(d.each(U,function(a){a.destroy()}),U=[]);I={};N=!1;T=B=null;E.reset()}var H=d.guid(),z,D=[],I={},J=[],U=[],T,E,N=!1,B;z={runtimes:l.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},
    send_chunk_number:!0};p.call(this,c,null,!0);E=new d.QueueProgress;d.extend(this,{id:H,uid:H,state:d.STOPPED,features:{},runtime:null,files:D,settings:z,total:E,init:function(){var a=this;"function"==typeof z.preinit?z.preinit(a):d.each(z.preinit,function(b,c){a.bind(c,b)});z.browse_button&&z.url?(this.bind("FilesAdded",q),this.bind("CancelUpload",v),this.bind("BeforeUpload",y),this.bind("UploadFile",m),this.bind("UploadProgress",A),this.bind("StateChanged",t),this.bind("QueueChanged",h),this.bind("Error",
    M),this.bind("FileUploaded",x),this.bind("Destroy",C),k.call(this,z,function(b){"function"==typeof z.init?z.init(a):d.each(z.init,function(b,c){a.bind(c,b)});b?(a.runtime=l.Runtime.getInfo(e()).type,a.trigger("Init",{runtime:a.runtime}),a.trigger("PostInit")):a.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})})):this.trigger("Error",{code:d.INIT_ERROR,message:d.translate("Init error.")})},setOption:function(a,b){p.call(this,a,b,!this.runtime)},getOption:function(a){return a?
    z[a]:z},refresh:function(){J.length&&d.each(J,function(a){a.trigger("Refresh")});this.trigger("Refresh")},start:function(){this.state!=d.STARTED&&(this.state=d.STARTED,this.trigger("StateChanged"),a.call(this))},stop:function(){this.state!=d.STOPPED&&(this.state=d.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(a){N=a!==w?a:!0;J.length&&d.each(J,function(a){a.disable(N)});this.trigger("DisableBrowse",N)},getFile:function(a){var b;for(b=D.length-1;0<=b;b--)if(D[b].id===
    a)return D[b]},addFile:function(a,b){function c(a,b){var d=[];l.each(h.settings.filters,function(b,c){f[c]&&d.push(function(d){f[c].call(h,b,a,function(a){d(!a)})})});l.inSeries(d,b)}function g(a){var e=l.typeOf(a);if(a instanceof l.File){if(!a.ruid&&!a.isDetached()){if(!m)return!1;a.ruid=m;a.connectRuntime(m)}g(new d.File(a))}else a instanceof l.Blob?(g(a.getSource()),a.destroy()):a instanceof d.File?(b&&(a.name=b),k.push(function(b){c(a,function(c){c||(p.push(a),h.trigger("FileFiltered",a));u(b,
    1)})})):-1!==l.inArray(e,["file","blob"])?g(new l.File(null,a)):"node"===e&&"filelist"===l.typeOf(a.files)?l.each(a.files,g):"array"===e&&(b=null,l.each(a,g))}var h=this,k=[],p=[],m;m=e();g(a);k.length&&l.inSeries(k,function(){p.length&&h.trigger("FilesAdded",p)})},removeFile:function(a){a="string"==typeof a?a:a.id;for(var b=D.length-1;0<=b;b--)if(D[b].id===a)return this.splice(b,1)[0]},splice:function(a,b){var c=D.splice(a===w?0:a,b===w?D.length:b),e=!1;return this.state==d.STARTED&&(e=!0,this.stop()),
    this.trigger("FilesRemoved",c),d.each(c,function(a){a.destroy()}),this.trigger("QueueChanged"),this.refresh(),e&&this.start(),c},bind:function(a,b,c){var e=this;d.Uploader.prototype.bind.call(this,a,function(){var a=[].slice.call(arguments);return a.splice(0,1,e),b.apply(this,a)},0,c)},destroy:function(){this.trigger("Destroy");z=E=null;this.unbindAll()}})};d.Uploader.prototype=l.EventTarget.instance;d.File=function(){var c={};return function(a){d.extend(this,{id:d.guid(),name:a.name||a.fileName,
    type:a.type||"",size:a.size||a.fileSize,origSize:a.size||a.fileSize,loaded:0,percent:0,status:d.QUEUED,lastModifiedDate:a.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var a=this.getSource().getSource();return-1!==l.inArray(l.typeOf(a),["blob","file"])?a:null},getSource:function(){return c[this.id]?c[this.id]:null},destroy:function(){var a=this.getSource();a&&(a.destroy(),delete c[this.id])}});c[this.id]=a}}();d.QueueProgress=function(){var c=this;c.size=0;c.loaded=0;c.uploaded=
    0;c.failed=0;c.queued=0;c.percent=0;c.bytesPerSec=0;c.reset=function(){c.size=c.loaded=c.uploaded=c.failed=c.queued=c.percent=c.bytesPerSec=0}};A.plupload=d})(window,mOxie);
function QiniuJsSDK(){this.detectIEVersion=function(){for(var l=4,w=document.createElement("div"),n=w.getElementsByTagName("i");w.innerHTML="\x3c!--[if gt IE "+l+"]><i></i><![endif]--\x3e",n[0];)l++;return 4<l?l:!1};this.isImage=function(l){var w="",n=["png","jpg","jpeg","gif","bmp"],w=/\.([a-zA-Z0-9]+)(\?|\@|$)/;if(!l||!w.test(l))return!1;w=w.exec(l)[1].toLowerCase();l=0;for(var u=n.length;u>l;l++)if(w===n[l])return!0;return!1};this.getFileExtension=function(l){l=l.split(".");return 1===l.length||
    ""===l[0]&&2===l.length?"":l.pop().toLowerCase()};this.utf8_encode=function(l){if(null===l||"undefined"==typeof l)return"";var w,n=l+"",u="",f=0;l=w=0;for(var f=n.length,d=0;f>d;d++){var c=n.charCodeAt(d),a=null;if(128>c)w++;else if(127<c&&2048>c)a=String.fromCharCode(c>>6|192,63&c|128);else if(63488&c^1)a=String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128);else{if(64512&c^1)throw new RangeError("Unmatched trail surrogate at "+d);a=n.charCodeAt(++d);if(64512&a^1)throw new RangeError("Unmatched lead surrogate at "+
    (d-1));c=((1023&c)<<10)+(1023&a)+65536;a=String.fromCharCode(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}null!==a&&(w>l&&(u+=n.slice(l,w)),u+=a,l=w=d+1)}return w>l&&(u+=n.slice(l,f)),u};this.base64_encode=function(l){var w,n,u,f,d=0,c=0,a="",a=[];if(!l)return l;l=this.utf8_encode(l+"");do w=l.charCodeAt(d++),n=l.charCodeAt(d++),u=l.charCodeAt(d++),f=w<<16|n<<8|u,w=f>>18&63,n=f>>12&63,u=f>>6&63,f&=63,a[c++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(w)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f);while(d<l.length);switch(a=a.join(""),l.length%3){case 1:a=a.slice(0,-2)+"==";break;case 2:a=a.slice(0,-1)+"="}return a};this.URLSafeBase64Encode=function(l){return l=this.base64_encode(l),l.replace(/\//g,"_").replace(/\+/g,"-")};this.createAjax=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")};
    this.parseJSON=function(l){return window.JSON&&window.JSON.parse?window.JSON.parse(l):null===l?l:"string"==typeof l&&(l=this.trim(l),l&&/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,"@").replace(/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))?l:void 0};this.trim=function(l){return null===l?"":this.trim.call(l)};var A=this;this.uploader=function(l){if(!l.domain)throw"uptoken_url or domain is required!";if(!l.browse_button)throw"browse_button is required!";
        var w={},n=l.init&&l.init.Error,u=l.init&&l.init.FileUploaded;l.init.Error=function(){};l.init.FileUploaded=function(){};A.uptoken_url=l.uptoken_url;A.token="";A.key_handler="function"==typeof l.init.Key?l.init.Key:"";this.domain=l.domain;var f="",d=!1,c=0,a="",b="";(function(){var a,b=A.detectIEVersion(),c="Safari"===mOxie.Env.browser&&5>=mOxie.Env.version&&"Windows"===mOxie.Env.os&&"7"===mOxie.Env.osVersion||"Safari"===mOxie.Env.browser&&"iOS"===mOxie.Env.os&&"7"===mOxie.Env.osVersion;b&&9>=b&&
        l.chunk_size&&0<=l.runtimes.indexOf("flash")?l.chunk_size=0:c?l.chunk_size=0:(a=plupload.parseSize(l.chunk_size),4194304<a&&(l.chunk_size=4194304))})();var h=function(){if(l.uptoken)A.token=l.uptoken;else{var a=A.createAjax();a.open("GET",A.uptoken_url,!0);a.setRequestHeader("If-Modified-Since","0");a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var b=A.parseJSON(a.responseText);A.token=b.uptoken}};a.send()}},e=function(a,b,c){var d="",e=!1;l.save_key||(d=(e=a.getOption&&a.getOption("unique_names"),
            e||a.settings&&a.settings.unique_names)?(a=A.getFileExtension(b.name))?b.id+"."+a:b.id:"function"==typeof c?c(a,b):b.name);return d};plupload.extend(w,l,{url:"http://upload.qiniu.com",multipart_params:{token:""}});var g=new plupload.Uploader(w);return g.bind("Init",function(){h()}),g.init(),g.bind("FilesAdded",function(a,b){var c=a.getOption&&a.getOption("auto_start");(c=c||a.settings&&a.settings.auto_start)&&plupload.each(b,function(){a.start()});a.refresh()}),g.bind("BeforeUpload",function(b,h){h.speed=
            h.speed||0;f="";var p=function(b,c,d){a=(new Date).getTime();d=l.save_key?{token:A.token}:{key:e(b,c,d),token:A.token};var f=l.x_vars;if(void 0!==f&&"object"==typeof f)for(var g in f)f.hasOwnProperty(g)&&("function"==typeof f[g]?d["x:"+g]=f[g](b,c):"object"!=typeof f[g]&&(d["x:"+g]=f[g]));b.setOption({url:"http://upload.qiniu.com/",multipart:!0,chunk_size:void 0,multipart_params:d})},q=b.getOption&&b.getOption("chunk_size");if(q=q||b.settings&&b.settings.chunk_size,"html5"===g.runtime&&q)if(h.size<
            q)p(b,h,A.key_handler);else{var p=localStorage.getItem(h.name),n=q;p&&(p=JSON.parse(p),864E5>(new Date).getTime()-(p.time||0)&&100!==p.percent&&h.size===p.total?(h.percent=p.percent,h.loaded=p.offset,f=p.ctx,d=!0,c=p.offset,p.offset+n>h.size&&(n=h.size-p.offset)):localStorage.removeItem(h.name));a=(new Date).getTime();b.setOption({url:"http://upload.qiniu.com/mkblk/"+n,multipart:!1,chunk_size:q,required_features:"chunks",headers:{Authorization:"UpToken "+A.token},multipart_params:{}})}else p(b,h,
            A.key_handler)}),g.bind("UploadProgress",function(e,f){b=(new Date).getTime();var g=b-a,h=f.loaded||0;d&&(h=f.loaded-c);f.speed=(h/g*1E3).toFixed(0)||0}),g.bind("ChunkUploaded",function(a,b,c){var d=A.parseJSON(c.response);f=f?f+","+d.ctx:d.ctx;var d=c.total-c.offset,e=a.getOption&&a.getOption("chunk_size"),e=e||a.settings&&a.settings.chunk_size;e>d&&a.setOption({url:"http://upload.qiniu.com/mkblk/"+d});localStorage.setItem(b.name,JSON.stringify({ctx:f,percent:b.percent,total:c.total,offset:c.offset,
            time:(new Date).getTime()}))}),g.bind("Error",function(a){return function(b,c){var d="";if(c.file){switch(c.code){case plupload.FAILED:d="\u4e0a\u4f20\u5931\u8d25\u3002\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002";break;case plupload.FILE_SIZE_ERROR:d=(d=b.getOption&&b.getOption("max_file_size"))||b.settings&&b.settings.max_file_size;d="\u6d4f\u89c8\u5668\u6700\u5927\u53ef\u4e0a\u4f20"+d+"\u3002\u66f4\u5927\u6587\u4ef6\u8bf7\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177\u3002";break;case plupload.FILE_EXTENSION_ERROR:d=
            "\u6587\u4ef6\u9a8c\u8bc1\u5931\u8d25\u3002\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002";break;case plupload.HTTP_ERROR:var e=A.parseJSON(c.response),f=e.error;switch(c.status){case 400:d="\u8bf7\u6c42\u62a5\u6587\u683c\u5f0f\u9519\u8bef\u3002";break;case 401:d="\u5ba2\u6237\u7aef\u8ba4\u8bc1\u6388\u6743\u5931\u8d25\u3002\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988\u3002";break;case 405:d="\u5ba2\u6237\u7aef\u8bf7\u6c42\u9519\u8bef\u3002\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988\u3002";break;case 579:d=
            "\u8d44\u6e90\u4e0a\u4f20\u6210\u529f\uff0c\u4f46\u56de\u8c03\u5931\u8d25\u3002";break;case 599:d="\u7f51\u7edc\u8fde\u63a5\u5f02\u5e38\u3002\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988\u3002";break;case 614:d="\u6587\u4ef6\u5df2\u5b58\u5728\u3002";try{e=A.parseJSON(e.error),f=e.error||"file exists"}catch(h){f=e.error||"file exists"}break;case 631:d="\u6307\u5b9a\u7a7a\u95f4\u4e0d\u5b58\u5728\u3002";break;case 701:d="\u4e0a\u4f20\u6570\u636e\u5757\u6821\u9a8c\u51fa\u9519\u3002\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988\u3002";
            break;default:d="\u672a\u77e5\u9519\u8bef\u3002"}d=d+"("+c.status+"\uff1a"+f+")";break;case plupload.SECURITY_ERROR:d="\u5b89\u5168\u914d\u7f6e\u9519\u8bef\u3002\u8bf7\u8054\u7cfb\u7f51\u7ad9\u7ba1\u7406\u5458\u3002";break;case plupload.GENERIC_ERROR:d="\u4e0a\u4f20\u5931\u8d25\u3002\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002";break;case plupload.IO_ERROR:d="\u4e0a\u4f20\u5931\u8d25\u3002\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002";break;case plupload.INIT_ERROR:d="\u7f51\u7ad9\u914d\u7f6e\u9519\u8bef\u3002\u8bf7\u8054\u7cfb\u7f51\u7ad9\u7ba1\u7406\u5458\u3002";
            g.destroy();break;default:d=c.message+c.details}a&&a(b,c,d)}b.refresh()}}(n)),g.bind("FileUploaded",function(a){return function(b,c,d){var h=function(b,c,d){if(l.downtoken_url){var e=A.createAjax();e.open("POST",l.downtoken_url,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){var f;try{f=A.parseJSON(e.responseText)}catch(h){throw"invalid json format";}var l={};plupload.extend(l,A.parseJSON(d),f);a&&a(b,
            c,JSON.stringify(l))}else g.trigger("Error",{status:e.status,response:e.responseText,file:c,code:plupload.HTTP_ERROR})};e.send("key="+A.parseJSON(d).key+"&domain="+l.domain)}else a&&a(b,c,d)},m=A.parseJSON(d.response);if(f=f?f:m.ctx){d="";l.save_key||(d=e(b,c,A.key_handler),d=d?"/key/"+A.URLSafeBase64Encode(d):"");var m=l.x_vars,n="",t="";if(void 0!==m&&"object"==typeof m)for(var v in m)m.hasOwnProperty(v)&&("function"==typeof m[v]?n=A.URLSafeBase64Encode(m[v](b,c)):"object"!=typeof m[v]&&(n=A.URLSafeBase64Encode(m[v])),
            t+="/x:"+v+"/"+n);v="http://upload.qiniu.com/mkfile/"+c.size+d+t;var u=A.createAjax();u.open("POST",v,!0);u.setRequestHeader("Content-Type","text/plain;charset=UTF-8");u.setRequestHeader("Authorization","UpToken "+A.token);u.onreadystatechange=function(){4===u.readyState&&((localStorage.removeItem(c.name),200===u.status)?h(b,c,u.responseText):g.trigger("Error",{status:u.status,response:u.responseText,file:c,code:-200}))};u.send(f)}else h(b,c,d.response)}}(u)),g};this.getUrl=function(l){if(!l)return!1;
        l=encodeURI(l);var w=this.domain;return"/"!==w.slice(w.length-1)&&(w+="/"),w+l};this.imageView2=function(l,w){var n=l.mode||"",u=l.w||"",f=l.h||"",d=l.q||"",c=l.format||"";if(!n||!u&&!f)return!1;n="imageView2/"+n;return n+=u?"/w/"+u:"",n+=f?"/h/"+f:"",n+=d?"/q/"+d:"",n+=c?"/format/"+c:"",w&&(n=this.getUrl(w)+"?"+n),n};this.imageMogr2=function(l,w){var n=l.thumbnail||"",u=l.strip||"",f=l.gravity||"",d=l.crop||"",c=l.quality||"",a=l.rotate||"",b=l.format||"",h=l.blur||"",e="imageMogr2";return e+=l["auto-orient"]?
        "/auto-orient":"",e+=n?"/thumbnail/"+n:"",e+=u?"/strip":"",e+=f?"/gravity/"+f:"",e+=c?"/quality/"+c:"",e+=d?"/crop/"+d:"",e+=a?"/rotate/"+a:"",e+=b?"/format/"+b:"",e+=h?"/blur/"+h:"",w&&(e=this.getUrl(w)+"?"+e),e};this.watermark=function(l,w){var n=l.mode;if(!n)return!1;var u="watermark/"+n;if(1===n){n=l.image||"";if(!n)return!1;u+=n?"/image/"+this.URLSafeBase64Encode(n):""}else{if(2!==n)return!1;var n=l.text?l.text:"",f=l.font?l.font:"",d=l.fontsize?l.fontsize:"",c=l.fill?l.fill:"";if(!n)return!1;
        u+=n?"/text/"+this.URLSafeBase64Encode(n):"";u+=f?"/font/"+this.URLSafeBase64Encode(f):"";u=u+(d?"/fontsize/"+d:"")+(c?"/fill/"+this.URLSafeBase64Encode(c):"")}n=l.dissolve||"";f=l.gravity||"";d=l.dx||"";c=l.dy||"";return u+=n?"/dissolve/"+n:"",u+=f?"/gravity/"+f:"",u+=d?"/dx/"+d:"",u+=c?"/dy/"+c:"",w&&(u=this.getUrl(w)+"?"+u),u};this.imageInfo=function(l){if(!l)return!1;var w;l=this.getUrl(l)+"?imageInfo";var n=this.createAjax(),u=this;return n.open("GET",l,!1),n.onreadystatechange=function(){4===
    n.readyState&&200===n.status&&(w=u.parseJSON(n.responseText))},n.send(),w};this.exif=function(l){if(!l)return!1;var w;l=this.getUrl(l)+"?exif";var n=this.createAjax(),u=this;return n.open("GET",l,!1),n.onreadystatechange=function(){4===n.readyState&&200===n.status&&(w=u.parseJSON(n.responseText))},n.send(),w};this.get=function(l,w){return w&&l?"exif"===l?this.exif(w):"imageInfo"===l?this.imageInfo(w):!1:!1};this.pipeline=function(l,w){var n,u="";if("[object Array]"===Object.prototype.toString.call(l)){for(var f=
        l.length;0<f;){if(n=l[0],!n.fop)return!1;switch(n.fop){case "watermark":this.watermark(n);break;case "imageView2":this.imageView2(n);break;case "imageMogr2":this.imageMogr2(n)}return!1}w&&(u=this.getUrl(w)+"?"+u,n=u.length,"|"===u.slice(n-1)&&(u=u.slice(0,n-1)));return u}return!1}}var Qiniu=new QiniuJsSDK;