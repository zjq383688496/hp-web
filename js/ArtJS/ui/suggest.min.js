!function(a){a&&window.ArtJS&&(ArtJS.namespace("ArtJS.ui"),a.extend(ArtJS.ui,{suggest:function(b,c){var d,e=c.url,f=b,g=c.listElm,h=-1,i=c.ajaxType||"dss",j=c.itemTmpl||'<li key="{key}"><em class="name">{name}</em><em class="num">约{num}个物品</em></li>',k=c.itemExec||function(a,b){var c=[];for(var d in b)c.push({key:d,name:d.replace(a,"<strong>"+a+"</strong>"),num:b[d]});return c};"script"==i&&(window[c.ajaxCallback]=function(a){o(a)}),a.fn.extend({selected:function(){this.siblings().removeClass("selected"),this.addClass("selected"),f.val(this.attr("key"))},addGo:function(){var a=this.attr("key");f.val(a),n(),f.closest("form").submit()}});var l=function(){d=g.find("li")},m=function(){g.show()},n=function(){g.hide()},o=function(b){for(var c=k(f.val(),b),e="",i=0;i<c.length;i++)e+=j.substitute(c[i]);g.html(e),l(),d.length>0?m():n(),d.mouseover(function(){a(this).selected(),h=d.index(a(this))}),d.click(function(){a(this).addGo()})};f.keypress(function(a){l(),"block"==g.css("display")&&13==a.keyCode&&-1!=h&&(d.eq(h).addGo(),a.preventDefault())}),f.keyup(function(b){if(l(),38==b.keyCode){if(h-=1,-2==h)h=d.length-1;else if(-1==h)return d.removeClass("selected"),void f.val(f.attr("key")||"");d.eq(h).selected()}else if(40==b.keyCode){if(h+=1,h==d.length)return h=-1,d.removeClass("selected"),void f.val(f.attr("key")||"");d.eq(h).selected()}else if(h=-1,""!==f.val()){f.attr("key",f.val());var c=e+encodeURI(f.val());"dss"==i?a.getDSS(c+"&_="+(new Date).getTime(),o):"script"==i?a.getScript(c):"jsonp"==i&&a.getJSON(c,o)}else""===f.val()&&n()}),a(document).click(function(){n()})}}),ArtJS.debug("suggest.js","初始化成功"))}(jQuery);